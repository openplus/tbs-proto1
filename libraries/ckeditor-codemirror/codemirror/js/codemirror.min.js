(function(b,a){typeof exports==="object"&&typeof module!=="undefined"?module.exports=a():typeof define==="function"&&define.amd?define(a):(b.CodeMirror=a())}(this,(function(){var ez=navigator.userAgent;var eK=navigator.platform;var cM=/gecko\/\d/i.test(ez);var fv=/MSIE \d/.test(ez);var bY=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(ez);var eh=fv||bY;var l=eh&&(fv?document.documentMode||6:bY[1]);var dt=/WebKit\//.test(ez);var ek=dt&&/Qt\/\d+\.\d+/.test(ez);var dH=/Chrome\//.test(ez);var eB=/Opera\//.test(ez);var aJ=/Apple Computer/.test(navigator.vendor);var dA=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(ez);var gk=/PhantomJS/.test(ez);var fO=/AppleWebKit/.test(ez)&&/Mobile\/\w+/.test(ez);var eR=fO||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(ez);var co=fO||/Mac/.test(eK);var gF=/\bCrOS\b/.test(ez);var aW=/win/i.test(eK);var a7=eB&&ez.match(/Version\/(\d*\.\d*)/);if(a7){a7=Number(a7[1])}if(a7&&a7>=15){eB=false;dt=true}var b5=co&&(ek||eB&&(a7==null||a7<12.11));var hd=cM||(eh&&l>=9);function T(i){return new RegExp("(^|\\s)"+i+"(?:$|\\s)\\s*")}var h=function(hq,i){var hr=hq.className;var hp=T(i).exec(hr);if(hp){var hs=hr.slice(hp.index+hp[0].length);hq.className=hr.slice(0,hp.index)+(hs?hp[1]+hs:"")}};function eA(hp){for(var i=hp.childNodes.length;i>0;--i){hp.removeChild(hp.firstChild)}return hp}function b7(i,hp){return eA(i).appendChild(hp)}function g5(hp,ht,hs,hr){var hu=document.createElement(hp);if(hs){hu.className=hs}if(hr){hu.style.cssText=hr}if(typeof ht=="string"){hu.appendChild(document.createTextNode(ht))}else{if(ht){for(var hq=0;hq<ht.length;++hq){hu.appendChild(ht[hq])}}}return hu}var cK;if(document.createRange){cK=function(hr,hs,hp,i){var hq=document.createRange();hq.setEnd(i||hr,hp);hq.setStart(hr,hs);return hq}}else{cK=function(hq,hs,i){var hp=document.body.createTextRange();try{hp.moveToElementText(hq.parentNode)}catch(hr){return hp}hp.collapse(true);hp.moveEnd("character",i);hp.moveStart("character",hs);return hp}}function he(i,hp){if(hp.nodeType==3){hp=hp.parentNode}if(i.contains){return i.contains(hp)}do{if(hp.nodeType==11){hp=hp.host}if(hp==i){return true}}while(hp=hp.parentNode)}function el(){var i;try{i=document.activeElement}catch(hp){i=document.body||null}while(i&&i.root&&i.root.activeElement){i=i.root.activeElement}return i}function gv(hp,i){var hq=hp.className;if(!T(i).test(hq)){hp.className+=(hq?" ":"")+i}}function gV(hr,hp){var hq=hr.split(" ");for(var hs=0;hs<hq.length;hs++){if(hq[hs]&&!T(hq[hs]).test(hp)){hp+=" "+hq[hs]}}return hp}var ei=function(i){i.select()};if(fO){ei=function(i){i.selectionStart=0;i.selectionEnd=i.value.length}}else{if(eh){ei=function(hp){try{hp.select()}catch(i){}}}}function cT(hp){var i=Array.prototype.slice.call(arguments,1);return function(){return hp.apply(null,i)}}function aU(hq,hp,i){if(!hp){hp={}}for(var hr in hq){if(hq.hasOwnProperty(hr)&&(i!==false||!hp.hasOwnProperty(hr))){hp[hr]=hq[hr]}}return hp}function b6(hs,hq,hu,hv,hr){if(hq==null){hq=hs.search(/[^\s\u00a0]/);if(hq==-1){hq=hs.length}}for(var ht=hv||0,hw=hr||0;;){var hp=hs.indexOf("\t",ht);if(hp<0||hp>=hq){return hw+(hq-ht)}hw+=hp-ht;hw+=hu-(hw%hu);ht=hp+1}}function ho(){this.id=null}ho.prototype.set=function(i,hp){clearTimeout(this.id);this.id=setTimeout(hp,i)};function dN(hr,hp){for(var hq=0;hq<hr.length;++hq){if(hr[hq]==hp){return hq}}return -1}var eg=30;var ct={toString:function(){return"CodeMirror.Pass"}};var ab={scroll:false};var N={origin:"*mouse"};var dp={origin:"+move"};function e3(hs,hr,ht){for(var hu=0,hq=0;;){var hp=hs.indexOf("\t",hu);if(hp==-1){hp=hs.length}var i=hp-hu;if(hp==hs.length||hq+i>=hr){return hu+Math.min(i,hr-hq)}hq+=hp-hu;hq+=ht-(hq%ht);hu=hp+1;if(hq>=hr){return hu}}}var a8=[""];function cN(i){while(a8.length<=i){a8.push(gB(a8)+" ")}return a8[i]}function gB(i){return i[i.length-1]}function b8(hs,hr){var hp=[];for(var hq=0;hq<hs.length;hq++){hp[hq]=hr(hs[hq],hq)}return hp}function cr(hs,hp,hq){var hr=0,i=hq(hp);while(hr<hs.length&&hq(hs[hr])<=i){hr++}hs.splice(hr,0,hp)}function gW(){}function cI(hq,i){var hp;if(Object.create){hp=Object.create(hq)}else{gW.prototype=hq;hp=new gW()}if(i){aU(i,hp)}return hp}var bl=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;function gy(i){return/\w/.test(i)||i>"\x80"&&(i.toUpperCase()!=i.toLowerCase()||bl.test(i))}function cZ(i,hp){if(!hp){return gy(i)}if(hp.source.indexOf("\\w")>-1&&gy(i)){return true}return hp.test(i)}function fH(i){for(var hp in i){if(i.hasOwnProperty(hp)&&i[hp]){return false}}return true}var fu=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function gf(i){return i.charCodeAt(0)>=768&&fu.test(i)}function fs(i,hq,hp){var hr=this;this.input=hp;hr.scrollbarFiller=g5("div",null,"CodeMirror-scrollbar-filler");hr.scrollbarFiller.setAttribute("cm-not-content","true");hr.gutterFiller=g5("div",null,"CodeMirror-gutter-filler");hr.gutterFiller.setAttribute("cm-not-content","true");hr.lineDiv=g5("div",null,"CodeMirror-code");hr.selectionDiv=g5("div",null,null,"position: relative; z-index: 1");hr.cursorDiv=g5("div",null,"CodeMirror-cursors");hr.measure=g5("div",null,"CodeMirror-measure");hr.lineMeasure=g5("div",null,"CodeMirror-measure");hr.lineSpace=g5("div",[hr.measure,hr.lineMeasure,hr.selectionDiv,hr.cursorDiv,hr.lineDiv],null,"position: relative; outline: none");hr.mover=g5("div",[g5("div",[hr.lineSpace],"CodeMirror-lines")],null,"position: relative");hr.sizer=g5("div",[hr.mover],"CodeMirror-sizer");hr.sizerWidth=null;hr.heightForcer=g5("div",null,null,"position: absolute; height: "+eg+"px; width: 1px;");hr.gutters=g5("div",null,"CodeMirror-gutters");hr.lineGutter=null;hr.scroller=g5("div",[hr.sizer,hr.heightForcer,hr.gutters],"CodeMirror-scroll");hr.scroller.setAttribute("tabIndex","-1");hr.wrapper=g5("div",[hr.scrollbarFiller,hr.gutterFiller,hr.scroller],"CodeMirror");if(eh&&l<8){hr.gutters.style.zIndex=-1;hr.scroller.style.paddingRight=0}if(!dt&&!(cM&&eR)){hr.scroller.draggable=true}if(i){if(i.appendChild){i.appendChild(hr.wrapper)}else{i(hr.wrapper)}}hr.viewFrom=hr.viewTo=hq.first;hr.reportedViewFrom=hr.reportedViewTo=hq.first;hr.view=[];hr.renderedView=null;hr.externalMeasured=null;hr.viewOffset=0;hr.lastWrapHeight=hr.lastWrapWidth=0;hr.updateLineNumbers=null;hr.nativeBarWidth=hr.barHeight=hr.barWidth=0;hr.scrollbarsClipped=false;hr.lineNumWidth=hr.lineNumInnerWidth=hr.lineNumChars=null;hr.alignWidgets=false;hr.cachedCharWidth=hr.cachedTextHeight=hr.cachedPaddingH=null;hr.maxLine=null;hr.maxLineLength=0;hr.maxLineChanged=false;hr.wheelDX=hr.wheelDY=hr.wheelStartX=hr.wheelStartY=null;hr.shift=false;hr.selForContextMenu=null;hr.activeTouch=null;hp.init(hr)}function f5(hs,hu){hu-=hs.first;if(hu<0||hu>=hs.size){throw new Error("There is no line "+(hu+hs.first)+" in the document.")}var hp=hs;while(!hp.lines){for(var hq=0;;++hq){var ht=hp.children[hq],hr=ht.chunkSize();if(hu<hr){hp=ht;break}hu-=hr}}return hp.lines[hu]}function g6(hq,hs,i){var hp=[],hr=hs.line;hq.iter(hs.line,i.line+1,function(ht){var hu=ht.text;if(hr==i.line){hu=hu.slice(0,i.ch)}if(hr==hs.line){hu=hu.slice(hs.ch)}hp.push(hu);++hr});return hp}function ba(hp,hr,hq){var i=[];hp.iter(hr,hq,function(hs){i.push(hs.text)});return i}function g9(hp,i){var hq=i-hp.height;if(hq){for(var hr=hp;hr;hr=hr.parent){hr.height+=hq}}}function b2(hp){if(hp.parent==null){return null}var ht=hp.parent,hs=dN(ht.lines,hp);for(var hq=ht.parent;hq;ht=hq,hq=hq.parent){for(var hr=0;;++hr){if(hq.children[hr]==ht){break}hs+=hq.children[hr].chunkSize()}}return hs+ht.first}function bW(hv,hu){var hs=hv.first;outer:do{for(var hr=0;hr<hv.children.length;++hr){var hq=hv.children[hr],hp=hq.height;if(hu<hp){hv=hq;continue outer}hu-=hp;hs+=hq.chunkSize()}return hs}while(!hv.lines);var ht=0;for(;ht<hv.lines.length;++ht){var hx=hv.lines[ht],hw=hx.height;if(hu<hw){break}hu-=hw}return hs+ht}function cq(hp,i){return i>=hp.first&&i<hp.first+hp.size}function e7(hp,hq){return String(hp.lineNumberFormatter(hq+hp.firstLineNumber))}function Y(i,hp){if(!(this instanceof Y)){return new Y(i,hp)}this.line=i;this.ch=hp}function cA(hp,i){return hp.line-i.line||hp.ch-i.ch}function cE(i){return Y(i.line,i.ch)}function bM(hp,i){return cA(hp,i)<0?i:hp}function ay(hp,i){return cA(hp,i)<0?hp:i}function dy(i,hp){return Math.max(i.first,Math.min(hp,i.first+i.size-1))}function gH(hp,hq){if(hq.line<hp.first){return Y(hp.first,0)}var i=hp.first+hp.size-1;if(hq.line>i){return Y(i,f5(hp,i).text.length)}return gi(hq,f5(hp,hq.line).text.length)}function gi(hq,hp){var i=hq.ch;if(i==null||i>hp){return Y(hq.line,hp)}else{if(i<0){return Y(hq.line,0)}else{return hq}}}function ey(hr,hs){var hp=[];for(var hq=0;hq<hs.length;hq++){hp[hq]=gH(hr,hs[hq])}return hp}var hh=false;var bf=false;function gt(){hh=true}function bL(){bf=true}function eU(i,hq,hp){this.marker=i;this.from=hq;this.to=hp}function f0(hr,hp){if(hr){for(var hq=0;hq<hr.length;++hq){var hs=hr[hq];if(hs.marker==hp){return hs}}}}function fr(hq,hr){var hs;for(var hp=0;hp<hq.length;++hp){if(hq[hp]!=hr){(hs||(hs=[])).push(hq[hp])}}return hs}function cy(i,hp){i.markedSpans=i.markedSpans?i.markedSpans.concat([hp]):[hp];hp.marker.attachLine(i)}function aX(hq,hr,hv){var hw;if(hq){for(var ht=0;ht<hq.length;++ht){var hx=hq[ht],hu=hx.marker;var hp=hx.from==null||(hu.inclusiveLeft?hx.from<=hr:hx.from<hr);if(hp||hx.from==hr&&hu.type=="bookmark"&&(!hv||!hx.marker.insertLeft)){var hs=hx.to==null||(hu.inclusiveRight?hx.to>=hr:hx.to>hr);(hw||(hw=[])).push(new eU(hu,hx.from,hs?null:hx.to))}}}return hw}function aI(hq,hs,hv){var hw;if(hq){for(var ht=0;ht<hq.length;++ht){var hx=hq[ht],hu=hx.marker;var hr=hx.to==null||(hu.inclusiveRight?hx.to>=hs:hx.to>hs);if(hr||hx.from==hs&&hu.type=="bookmark"&&(!hv||hx.marker.insertLeft)){var hp=hx.from==null||(hu.inclusiveLeft?hx.from<=hs:hx.from<hs);(hw||(hw=[])).push(new eU(hu,hp?null:hx.from-hs,hx.to==null?null:hx.to-hs))}}}return hw}function eV(hK,hA){if(hA.full){return null}var hr=cq(hK,hA.from.line)&&f5(hK,hA.from.line).markedSpans;var hy=cq(hK,hA.to.line)&&f5(hK,hA.to.line).markedSpans;if(!hr&&!hy){return null}var hx=hA.from.ch,hF=hA.to.ch,hC=cA(hA.from,hA.to)==0;var hw=aX(hr,hx,hC);var hz=aI(hy,hF,hC);var hD=hA.text.length==1,hu=gB(hA.text).length+(hD?hx:0);if(hw){for(var hI=0;hI<hw.length;++hI){var hH=hw[hI];if(hH.to==null){var hB=f0(hz,hH.marker);if(!hB){hH.to=hx}else{if(hD){hH.to=hB.to==null?null:hB.to+hu}}}}}if(hz){for(var hv=0;hv<hz.length;++hv){var hG=hz[hv];if(hG.to!=null){hG.to+=hu}if(hG.from==null){var hq=f0(hw,hG.marker);if(!hq){hG.from=hu;if(hD){(hw||(hw=[])).push(hG)}}}else{hG.from+=hu;if(hD){(hw||(hw=[])).push(hG)}}}}if(hw){hw=s(hw)}if(hz&&hz!=hw){hz=s(hz)}var hJ=[hw];if(!hD){var hE=hA.text.length-2,hp;if(hE>0&&hw){for(var ht=0;ht<hw.length;++ht){if(hw[ht].to==null){(hp||(hp=[])).push(new eU(hw[ht].marker,null,null))}}}for(var hs=0;hs<hE;++hs){hJ.push(hp)}hJ.push(hz)}return hJ}function s(hq){for(var hp=0;hp<hq.length;++hp){var hr=hq[hp];if(hr.from!=null&&hr.from==hr.to&&hr.marker.clearWhenEmpty!==false){hq.splice(hp--,1)}}if(!hq.length){return null}return hq}function c9(hB,hz,hA){var ht=null;hB.iter(hz.line,hA.line+1,function(hC){if(hC.markedSpans){for(var hD=0;hD<hC.markedSpans.length;++hD){var hE=hC.markedSpans[hD].marker;if(hE.readOnly&&(!ht||dN(ht,hE)==-1)){(ht||(ht=[])).push(hE)}}}});if(!ht){return null}var hu=[{from:hz,to:hA}];for(var hv=0;hv<ht.length;++hv){var hw=ht[hv],hr=hw.find(0);for(var hs=0;hs<hu.length;++hs){var hq=hu[hs];if(cA(hq.to,hr.from)<0||cA(hq.from,hr.to)>0){continue}var hy=[hs,1],hp=cA(hq.from,hr.from),hx=cA(hq.to,hr.to);if(hp<0||!hw.inclusiveLeft&&!hp){hy.push({from:hq.from,to:hr.from})}if(hx>0||!hw.inclusiveRight&&!hx){hy.push({from:hr.to,to:hq.to})}hu.splice.apply(hu,hy);hs+=hy.length-1}}return hu}function hc(hp){var hr=hp.markedSpans;if(!hr){return}for(var hq=0;hq<hr.length;++hq){hr[hq].marker.detachLine(hp)}hp.markedSpans=null}function dw(hp,hr){if(!hr){return}for(var hq=0;hq<hr.length;++hq){hr[hq].marker.attachLine(hp)}hp.markedSpans=hr}function w(i){return i.inclusiveLeft?-1:0}function cc(i){return i.inclusiveRight?1:0}function ep(hr,hp){var ht=hr.lines.length-hp.lines.length;if(ht!=0){return ht}var hq=hr.find(),hu=hp.find();var i=cA(hq.from,hu.from)||w(hr)-w(hp);if(i){return -i}var hs=cA(hq.to,hu.to)||cc(hr)-cc(hp);if(hs){return hs}return hp.id-hr.id}function be(hq,hu){var hp=bf&&hq.markedSpans,ht;if(hp){for(var hs=void 0,hr=0;hr<hp.length;++hr){hs=hp[hr];if(hs.marker.collapsed&&(hu?hs.from:hs.to)==null&&(!ht||ep(ht,hs.marker)<0)){ht=hs.marker}}}return ht}function fB(i){return be(i,true)}function fb(i){return be(i,false)}function A(hx,hp,hv,hw,ht){var hA=f5(hx,hp);var hq=bf&&hA.markedSpans;if(hq){for(var hs=0;hs<hq.length;++hs){var hr=hq[hs];if(!hr.marker.collapsed){continue}var hz=hr.marker.find(0);var hy=cA(hz.from,hv)||w(hr.marker)-w(ht);var hu=cA(hz.to,hw)||cc(hr.marker)-cc(ht);if(hy>=0&&hu<=0||hy<=0&&hu>=0){continue}if(hy<=0&&(hr.marker.inclusiveRight&&ht.inclusiveLeft?cA(hz.to,hv)>=0:cA(hz.to,hv)>0)||hy>=0&&(hr.marker.inclusiveRight&&ht.inclusiveLeft?cA(hz.from,hw)<=0:cA(hz.from,hw)<0)){return true}}}}function z(hp){var i;while(i=fB(hp)){hp=i.find(-1,true).line}return hp}function g(hq){var i,hp;while(i=fb(hq)){hq=i.find(1,true).line;(hp||(hp=[])).push(hq)}return hp}function a3(hr,hp){var i=f5(hr,hp),hq=z(i);if(i==hq){return hp}return b2(hq)}function eC(hr,hq){if(hq>hr.lastLine()){return hq}var hp=f5(hr,hq),i;if(!gm(hr,hp)){return hq}while(i=fb(hp)){hp=i.find(1,true).line}return b2(hp)+1}function gm(ht,hq){var hp=bf&&hq.markedSpans;if(hp){for(var hs=void 0,hr=0;hr<hp.length;++hr){hs=hp[hr];if(!hs.marker.collapsed){continue}if(hs.from==null){return true}if(hs.marker.widgetNode){continue}if(hs.from==0&&hs.marker.inclusiveLeft&&U(ht,hq,hs)){return true}}}}function U(hu,hq,hs){if(hs.to==null){var hp=hs.marker.find(1,true);return U(hu,hp.line,f0(hp.line.markedSpans,hs.marker))}if(hs.marker.inclusiveRight&&hs.to==hq.text.length){return true}for(var ht=void 0,hr=0;hr<hq.markedSpans.length;++hr){ht=hq.markedSpans[hr];if(ht.marker.collapsed&&!ht.marker.widgetNode&&ht.from==hs.to&&(ht.to==null||ht.to!=hs.from)&&(ht.marker.inclusiveLeft||hs.marker.inclusiveRight)&&U(hu,hq,ht)){return true}}}function b1(hr){hr=z(hr);var ht=0,hq=hr.parent;for(var hs=0;hs<hq.lines.length;++hs){var hp=hq.lines[hs];if(hp==hr){break}else{ht+=hp.height}}for(var hu=hq.parent;hu;hq=hu,hu=hq.parent){for(var hw=0;hw<hu.children.length;++hw){var hv=hu.children[hw];if(hv==hq){break}else{ht+=hv.height}}}return ht}function eZ(hq){if(hq.height==0){return 0}var hp=hq.text.length,i,ht=hq;while(i=fB(ht)){var hr=i.find(0,true);ht=hr.from.line;hp+=hr.from.ch-hr.to.ch}ht=hq;while(i=fb(ht)){var hs=i.find(0,true);hp-=ht.text.length-hs.from.ch;ht=hs.to.line;hp+=ht.text.length-hs.to.ch}return hp}function f(i){var hq=i.display,hp=i.doc;hq.maxLine=f5(hp,hp.first);hq.maxLineLength=eZ(hq.maxLine);hq.maxLineChanged=true;hp.iter(function(hs){var hr=eZ(hs);if(hr>hq.maxLineLength){hq.maxLineLength=hr;hq.maxLine=hs}})}function eD(hp,hv,hu,ht){if(!hp){return ht(hv,hu,"ltr")}var hs=false;for(var hr=0;hr<hp.length;++hr){var hq=hp[hr];if(hq.from<hu&&hq.to>hv||hv==hu&&hq.to==hv){ht(Math.max(hq.from,hv),Math.min(hq.to,hu),hq.level==1?"rtl":"ltr");hs=true}}if(!hs){ht(hv,hu,"ltr")}}function d6(i){return i.level%2?i.to:i.from}function hi(i){return i.level%2?i.from:i.to}function c4(hp){var i=a(hp);return i?d6(i[0]):0}function dk(hp){var i=a(hp);if(!i){return hp.text.length}return hi(gB(i))}function au(hp,hq,i){var hr=hp[0].level;if(hq==hr){return true}if(i==hr){return false}return hq<i}var fR=null;function aO(hp,ht){var hr;fR=null;for(var hq=0;hq<hp.length;++hq){var hs=hp[hq];if(hs.from<ht&&hs.to>ht){return hq}if((hs.from==ht||hs.to==ht)){if(hr==null){hr=hq}else{if(au(hp,hs.level,hp[hr].level)){if(hs.from!=hs.to){fR=hr}return hq}else{if(hs.from!=hs.to){fR=hq}return hr}}}}return hr}function f6(i,hr,hp,hq){if(!hq){return hr+hp}do{hr+=hp}while(hr>0&&gf(i.text.charAt(hr)));return hr}function v(i,hv,hq,hr){var hs=a(i);if(!hs){return an(i,hv,hq,hr)}var hu=aO(hs,hv),hp=hs[hu];var ht=f6(i,hv,hp.level%2?-hq:hq,hr);for(;;){if(ht>hp.from&&ht<hp.to){return ht}if(ht==hp.from||ht==hp.to){if(aO(hs,ht)==hu){return ht}hp=hs[hu+=hq];return(hq>0)==hp.level%2?hp.to:hp.from}else{hp=hs[hu+=hq];if(!hp){return null}if((hq>0)==hp.level%2){ht=f6(i,hp.to,-1,hr)}else{ht=f6(i,hp.from,1,hr)}}}}function an(i,hs,hp,hq){var hr=hs+hp;if(hq){while(hr>0&&gf(i.text.charAt(hr))){hr+=hp}}return hr<0||hr>i.text.length?null:hr}var br=(function(){var hu="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN";var hs="nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111";function hr(hy){if(hy<=247){return hu.charAt(hy)}else{if(1424<=hy&&hy<=1524){return"R"}else{if(1536<=hy&&hy<=1785){return hs.charAt(hy-1536)}else{if(1774<=hy&&hy<=2220){return"r"}else{if(8192<=hy&&hy<=8203){return"w"}else{if(hy==8204){return"b"}else{return"L"}}}}}}}var i=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;var hx=/[stwN]/,hq=/[LRr]/,hp=/[Lb1n]/,ht=/[1n]/;var hw="L";function hv(hA,hz,hy){this.level=hA;this.from=hz;this.to=hy}return function(hW){if(!i.test(hW)){return false}var h3=hW.length,hN=[];for(var h1=0;h1<h3;++h1){hN.push(hr(hW.charCodeAt(h1)))}for(var hL=0,hR=hw;hL<h3;++hL){var hC=hN[hL];if(hC=="m"){hN[hL]=hR}else{hR=hC}}for(var hJ=0,hA=hw;hJ<h3;++hJ){var hX=hN[hJ];if(hX=="1"&&hA=="r"){hN[hJ]="n"}else{if(hq.test(hX)){hA=hX;if(hX=="r"){hN[hJ]="R"}}}}for(var hI=1,hS=hN[0];hI<h3-1;++hI){var hU=hN[hI];if(hU=="+"&&hS=="1"&&hN[hI+1]=="1"){hN[hI]="1"}else{if(hU==","&&hS==hN[hI+1]&&(hS=="1"||hS=="n")){hN[hI]=hS}}hS=hU}for(var hH=0;hH<h3;++hH){var hT=hN[hH];if(hT==","){hN[hH]="N"}else{if(hT=="%"){var hD=void 0;for(hD=hH+1;hD<h3&&hN[hD]=="%";++hD){}var h6=(hH&&hN[hH-1]=="!")||(hD<h3&&hN[hD]=="1")?"1":"N";for(var h0=hH;h0<hD;++h0){hN[h0]=h6}hH=hD-1}}}for(var hE=0,h2=hw;hE<h3;++hE){var hQ=hN[hE];if(h2=="L"&&hQ=="1"){hN[hE]="L"}else{if(hq.test(hQ)){h2=hQ}}}for(var hB=0;hB<h3;++hB){if(hx.test(hN[hB])){var hG=void 0;for(hG=hB+1;hG<h3&&hx.test(hN[hG]);++hG){}var hO=(hB?hN[hB-1]:hw)=="L";var hz=(hG<h3?hN[hG]:hw)=="L";var hM=hO||hz?"L":"R";for(var h5=hB;h5<hG;++h5){hN[h5]=hM}hB=hG-1}}var hZ=[],hV;for(var hy=0;hy<h3;){if(hp.test(hN[hy])){var hF=hy;for(++hy;hy<h3&&hp.test(hN[hy]);++hy){}hZ.push(new hv(0,hF,hy))}else{var hK=hy,hP=hZ.length;for(++hy;hy<h3&&hN[hy]!="L";++hy){}for(var h4=hK;h4<hy;){if(ht.test(hN[h4])){if(hK<h4){hZ.splice(hP,0,new hv(1,hK,h4))}var hY=h4;for(++h4;h4<hy&&ht.test(hN[h4]);++h4){}hZ.splice(hP,0,new hv(2,hY,h4));hK=h4}else{++h4}}if(hK<hy){hZ.splice(hP,0,new hv(1,hK,hy))}}}if(hZ[0].level==1&&(hV=hW.match(/^\s+/))){hZ[0].from=hV[0].length;hZ.unshift(new hv(0,0,hV[0].length))}if(gB(hZ).level==1&&(hV=hW.match(/\s+$/))){gB(hZ).to-=hV[0].length;hZ.push(new hv(0,h3-hV[0].length,h3))}if(hZ[0].level==2){hZ.unshift(new hv(1,hZ[0].to,hZ[0].to))}if(hZ[0].level!=gB(hZ).level){hZ.push(new hv(hZ[0].level,h3,h3))}return hZ}})();function a(hp){var i=hp.order;if(i==null){i=hp.order=br(hp.text)}return i}var fV=[];var cd=function(hr,i,hq){if(hr.addEventListener){hr.addEventListener(i,hq,false)}else{if(hr.attachEvent){hr.attachEvent("on"+i,hq)}else{var hp=hr._handlers||(hr._handlers={});hp[i]=(hp[i]||fV).concat(hq)}}};function eX(hp,i){return hp._handlers&&hp._handlers[i]||fV}function eP(ht,hq,hs){if(ht.removeEventListener){ht.removeEventListener(hq,hs,false)}else{if(ht.detachEvent){ht.detachEvent("on"+hq,hs)}else{var hr=ht._handlers,i=hr&&hr[hq];if(i){var hp=dN(i,hs);if(hp>-1){hr[hq]=i.slice(0,hp).concat(i.slice(hp+1))}}}}}function aL(ht,hs){var hp=eX(ht,hs);if(!hp.length){return}var hq=Array.prototype.slice.call(arguments,2);for(var hr=0;hr<hp.length;++hr){hp[hr].apply(null,hq)}}function aY(i,hq,hp){if(typeof hq=="string"){hq={type:hq,preventDefault:function(){this.defaultPrevented=true}}}aL(i,hp||hq.type,i,hq);return b0(hq)||hq.codemirrorIgnore}function X(hq){var hp=hq._handlers&&hq._handlers.cursorActivity;if(!hp){return}var hs=hq.curOp.cursorActivityHandlers||(hq.curOp.cursorActivityHandlers=[]);for(var hr=0;hr<hp.length;++hr){if(dN(hs,hp[hr])==-1){hs.push(hp[hr])}}}function gb(hp,i){return eX(hp,i).length>0}function bO(i){i.prototype.on=function(hp,hq){cd(this,hp,hq)};i.prototype.off=function(hp,hq){eP(this,hp,hq)}}function c7(i){if(i.preventDefault){i.preventDefault()}else{i.returnValue=false}}function dU(i){if(i.stopPropagation){i.stopPropagation()}else{i.cancelBubble=true}}function b0(i){return i.defaultPrevented!=null?i.defaultPrevented:i.returnValue==false}function e4(i){c7(i);dU(i)}function M(i){return i.target||i.srcElement}function gM(hp){var i=hp.which;if(i==null){if(hp.button&1){i=1}else{if(hp.button&2){i=3}else{if(hp.button&4){i=2}}}}if(co&&hp.ctrlKey&&i==1){i=3}return i}var fw=function(){if(eh&&l<9){return false}var i=g5("div");return"draggable" in i||"dragDrop" in i}();var gK;function bA(i){if(gK==null){var hq=g5("span","\u200b");b7(i,g5("span",[hq,document.createTextNode("x")]));if(i.firstChild.offsetHeight!=0){gK=hq.offsetWidth<=1&&hq.offsetHeight>2&&!(eh&&l<8)}}var hp=gK?g5("span","\u200b"):g5("span","\u00a0",null,"display: inline-block; width: 1px; margin-right: -1px");hp.setAttribute("cm-text","");return hp}var gL;function b3(hr){if(gL!=null){return gL}var i=b7(hr,document.createTextNode("A\u062eA"));var hq=cK(i,0,1).getBoundingClientRect();var hp=cK(i,1,2).getBoundingClientRect();eA(hr);if(!hq||hq.left==hq.right){return false}return gL=(hp.right-hq.right<3)}var gR="\n\nb".split(/\n/).length!=3?function(ht){var hu=0,i=[],hs=ht.length;while(hu<=hs){var hr=ht.indexOf("\n",hu);if(hr==-1){hr=ht.length}var hq=ht.slice(hu,ht.charAt(hr-1)=="\r"?hr-1:hr);var hp=hq.indexOf("\r");if(hp!=-1){i.push(hq.slice(0,hp));hu+=hp+1}else{i.push(hq);hu=hr+1}}return i}:function(i){return i.split(/\r\n?|\n/)};var bF=window.getSelection?function(hp){try{return hp.selectionStart!=hp.selectionEnd}catch(i){return false}}:function(hq){var hp;try{hp=hq.ownerDocument.selection.createRange()}catch(i){}if(!hp||hp.parentElement()!=hq){return false}return hp.compareEndPoints("StartToEnd",hp)!=0};var dE=(function(){var i=g5("div");if("oncopy" in i){return true}i.setAttribute("oncopy","return;");return typeof i.oncopy=="function"})();var fX=null;function aS(hp){if(fX!=null){return fX}var hq=b7(hp,g5("span","x"));var hr=hq.getBoundingClientRect();var i=cK(hq,0,1).getBoundingClientRect();return fX=Math.abs(hr.left-i.left)>1}var dW={};var aZ={};function e8(i,hp){if(arguments.length>2){hp.dependencies=Array.prototype.slice.call(arguments,2)}dW[i]=hp}function bx(hp,i){aZ[hp]=i}function hf(i){if(typeof i=="string"&&aZ.hasOwnProperty(i)){i=aZ[i]}else{if(i&&typeof i.name=="string"&&aZ.hasOwnProperty(i.name)){var hp=aZ[i.name];if(typeof hp=="string"){hp={name:hp}}i=cI(hp,i);i.name=hp.name}else{if(typeof i=="string"&&/^[\w\-]+\/[\w\-]+\+xml$/.test(i)){return hf("application/xml")}else{if(typeof i=="string"&&/^[\w\-]+\/[\w\-]+\+json$/.test(i)){return hf("application/json")}}}}if(typeof i=="string"){return{name:i}}else{return i||{name:"null"}}}function gu(hq,hp){hp=hf(hp);var hs=dW[hp.name];if(!hs){return gu(hq,"text/plain")}var ht=hs(hq,hp);if(dT.hasOwnProperty(hp.name)){var hr=dT[hp.name];for(var hu in hr){if(!hr.hasOwnProperty(hu)){continue}if(ht.hasOwnProperty(hu)){ht["_"+hu]=ht[hu]}ht[hu]=hr[hu]}}ht.name=hp.name;if(hp.helperType){ht.helperType=hp.helperType}if(hp.modeProps){for(var i in hp.modeProps){ht[i]=hp.modeProps[i]}}return ht}var dT={};function fm(hq,hp){var i=dT.hasOwnProperty(hq)?dT[hq]:(dT[hq]={});aU(hp,i)}function ck(hr,i){if(i===true){return i}if(hr.copyState){return hr.copyState(i)}var hq={};for(var hs in i){var hp=i[hs];if(hp instanceof Array){hp=hp.concat([])}hq[hs]=hp}return hq}function hb(hq,i){var hp;while(hq.innerMode){hp=hq.innerMode(i);if(!hp||hp.mode==hq){break}i=hp.state;hq=hp.mode}return hp||{mode:hq,state:i}}function ch(hq,hp,i){return hq.startState?hq.startState(hp,i):true}var fG=function(i,hp){this.pos=this.start=0;this.string=i;this.tabSize=hp||8;this.lastColumnPos=this.lastColumnValue=0;this.lineStart=0};fG.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==this.lineStart},peek:function(){return this.string.charAt(this.pos)||undefined},next:function(){if(this.pos<this.string.length){return this.string.charAt(this.pos++)}},eat:function(i){var hq=this.string.charAt(this.pos);var hp;if(typeof i=="string"){hp=hq==i}else{hp=hq&&(i.test?i.test(hq):i(hq))}if(hp){++this.pos;return hq}},eatWhile:function(i){var hp=this.pos;while(this.eat(i)){}return this.pos>hp},eatSpace:function(){var hp=this;var i=this.pos;while(/[\s\u00a0]/.test(this.string.charAt(this.pos))){++hp.pos}return this.pos>i},skipToEnd:function(){this.pos=this.string.length},skipTo:function(i){var hp=this.string.indexOf(i,this.pos);if(hp>-1){this.pos=hp;return true}},backUp:function(i){this.pos-=i},column:function(){if(this.lastColumnPos<this.start){this.lastColumnValue=b6(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue);this.lastColumnPos=this.start}return this.lastColumnValue-(this.lineStart?b6(this.string,this.lineStart,this.tabSize):0)},indentation:function(){return b6(this.string,null,this.tabSize)-(this.lineStart?b6(this.string,this.lineStart,this.tabSize):0)},match:function(hs,hp,i){if(typeof hs=="string"){var ht=function(hu){return i?hu.toLowerCase():hu};var hr=this.string.substr(this.pos,hs.length);if(ht(hr)==ht(hs)){if(hp!==false){this.pos+=hs.length}return true}}else{var hq=this.string.slice(this.pos).match(hs);if(hq&&hq.index>0){return null}if(hq&&hp!==false){this.pos+=hq[0].length}return hq}},current:function(){return this.string.slice(this.start,this.pos)},hideFirstChars:function(hp,i){this.lineStart+=hp;try{return i()}finally{this.lineStart-=hp}}};function gs(i,hq,hu,ht){var hs=[i.state.modeGen],hr={};x(i,hq.text,i.doc.mode,hu,function(hw,hx){return hs.push(hw,hx)},hr,ht);var hp=function(hz){var hx=i.state.overlays[hz],hy=1,hw=0;x(i,hq.text,hx.mode,true,function(hA,hC){var hE=hy;while(hw<hA){var hB=hs[hy];if(hB>hA){hs.splice(hy,1,hA,hs[hy+1],hB)}hy+=2;hw=Math.min(hA,hB)}if(!hC){return}if(hx.opaque){hs.splice(hE,hy-hE,hA,"overlay "+hC);hy=hE+2}else{for(;hE<hy;hE+=2){var hD=hs[hE+1];hs[hE+1]=(hD?hD+" ":"")+"overlay "+hC}}},hr)};for(var hv=0;hv<i.state.overlays.length;++hv){hp(hv)}return{styles:hs,classes:hr.bgClass||hr.textClass?hr:null}}function dB(hp,hq,hs){if(!hq.styles||hq.styles[0]!=hp.state.modeGen){var hr=d9(hp,b2(hq));var i=gs(hp,hq,hq.text.length>hp.options.maxHighlightLength?ck(hp.doc.mode,hr):hr);hq.stateAfter=hr;hq.styles=i.styles;if(i.classes){hq.styleClasses=i.classes}else{if(hq.styleClasses){hq.styleClasses=null}}if(hs===hp.doc.frontier){hp.doc.frontier++}}return hq.styles}function d9(i,hu,hp){var hs=i.doc,hr=i.display;if(!hs.mode.startState){return true}var ht=cX(i,hu,hp),hq=ht>hs.first&&f5(hs,ht-1).stateAfter;if(!hq){hq=ch(hs.mode)}else{hq=ck(hs.mode,hq)}hs.iter(ht,hu,function(hv){d4(i,hv.text,hq);var hw=ht==hu-1||ht%5==0||ht>=hr.viewFrom&&ht<hr.viewTo;hv.stateAfter=hw?ck(hs.mode,hq):null;++ht});if(hp){hs.frontier=ht}return hq}function d4(i,ht,hq,hp){var hs=i.doc.mode;var hr=new fG(ht,i.options.tabSize);hr.start=hr.pos=hp||0;if(ht==""){gg(hs,hq)}while(!hr.eol()){fk(hs,hr,hq);hr.start=hr.pos}}function gg(hq,hp){if(hq.blankLine){return hq.blankLine(hp)}if(!hq.innerMode){return}var i=hb(hq,hp);if(i.mode.blankLine){return i.mode.blankLine(i.state)}}function fk(hu,ht,hs,hp){for(var hq=0;hq<10;hq++){if(hp){hp[0]=hb(hu,hs).mode}var hr=hu.token(ht,hs);if(ht.pos>ht.start){return hr}}throw new Error("Mode "+hu.name+" failed to advance stream.")}function cO(hx,hv,hs,hr){var i=function(hA){return({start:hy.start,end:hy.pos,string:hy.current(),type:hq||null,state:hA?ck(hw.mode,hp):hp})};var hw=hx.doc,ht=hw.mode,hq;hv=gH(hw,hv);var hz=f5(hw,hv.line),hp=d9(hx,hv.line,hs);var hy=new fG(hz.text,hx.options.tabSize),hu;if(hr){hu=[]}while((hr||hy.pos<hv.ch)&&!hy.eol()){hy.start=hy.pos;hq=fk(ht,hy,hp);if(hr){hu.push(i(true))}}return hr?hu:i()}function dO(hq,hp){if(hq){for(;;){var i=hq.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!i){break}hq=hq.slice(0,i.index)+hq.slice(i.index+i[0].length);var hr=i[1]?"bgClass":"textClass";if(hp[hr]==null){hp[hr]=i[2]}else{if(!(new RegExp("(?:^|s)"+i[2]+"(?:$|s)")).test(hp[hr])){hp[hr]+=" "+i[2]}}}}return hq}function x(hy,hA,ht,hp,hu,hr,hs){var hq=ht.flattenSpans;if(hq==null){hq=hy.options.flattenSpans}var hw=0,hv=null;var hz=new fG(hA,hy.options.tabSize),i;var hC=hy.options.addModeClass&&[null];if(hA==""){dO(gg(ht,hp),hr)}while(!hz.eol()){if(hz.pos>hy.options.maxHighlightLength){hq=false;if(hs){d4(hy,hA,hp,hz.pos)}hz.pos=hA.length;i=null}else{i=dO(fk(ht,hz,hp,hC),hr)}if(hC){var hB=hC[0].name;if(hB){i="m-"+(i?hB+" "+i:hB)}}if(!hq||hv!=i){while(hw<hz.start){hw=Math.min(hz.start,hw+5000);hu(hw,hv)}hv=i}hz.start=hz.pos}while(hw<hz.pos){var hx=Math.min(hz.pos,hw+5000);hu(hx,hv);hw=hx}}function cX(hu,i,hr){var hp,hs,ht=hu.doc;var hq=hr?-1:i-(hu.doc.mode.innerMode?1000:100);for(var hx=i;hx>hq;--hx){if(hx<=ht.first){return ht.first}var hw=f5(ht,hx-1);if(hw.stateAfter&&(!hr||hx<=ht.frontier)){return hx}var hv=b6(hw.text,null,hu.options.tabSize);if(hs==null||hp>hv){hs=hx-1;hp=hv}}return hs}function g8(hq,hp,i){this.text=hq;dw(this,hp);this.height=i?i(this):1}bO(g8);g8.prototype.lineNo=function(){return b2(this)};function e0(hp,hs,hq,i){hp.text=hs;if(hp.stateAfter){hp.stateAfter=null}if(hp.styles){hp.styles=null}if(hp.order!=null){hp.order=null}hc(hp);dw(hp,hq);var hr=i?i(hp):1;if(hr!=hp.height){g9(hp,hr)}}function bQ(i){i.parent=null;hc(i)}var eu={};var cj={};function fJ(hq,hp){if(!hq||/^\s*$/.test(hq)){return null}var i=hp.addModeClass?cj:eu;return i[hq]||(i[hq]=hq.replace(/\S+/g,"cm-$&"))}function fE(hv,hu){var ht=g5("span",null,null,dt?"padding-right: .1px":null);var hs={pre:g5("pre",[ht],"CodeMirror-line"),content:ht,col:0,pos:0,cm:hv,trailingSpace:false,splitSpaces:(eh||dt)&&hv.getOption("lineWrapping")};hu.measure={};for(var hr=0;hr<=(hu.rest?hu.rest.length:0);hr++){var hx=hr?hu.rest[hr-1]:hu.line,hq=void 0;hs.pos=0;hs.addToken=u;if(b3(hv.display.measure)&&(hq=a(hx))){hs.addToken=W(hs.addToken,hq)}hs.map=[];var hp=hu!=hv.display.externalMeasured&&b2(hx);bB(hx,hs,dB(hv,hx,hp));if(hx.styleClasses){if(hx.styleClasses.bgClass){hs.bgClass=gV(hx.styleClasses.bgClass,hs.bgClass||"")}if(hx.styleClasses.textClass){hs.textClass=gV(hx.styleClasses.textClass,hs.textClass||"")}}if(hs.map.length==0){hs.map.push(0,0,hs.content.appendChild(bA(hv.display.measure)))}if(hr==0){hu.measure.map=hs.map;hu.measure.cache={}}else{(hu.measure.maps||(hu.measure.maps=[])).push(hs.map);(hu.measure.caches||(hu.measure.caches=[])).push({})}}if(dt){var hw=hs.content.lastChild;if(/\bcm-tab\b/.test(hw.className)||(hw.querySelector&&hw.querySelector(".cm-tab"))){hs.content.className="cm-tab-wrap-hack"}}aL(hv,"renderLine",hv,hu.line,hs.pre);if(hs.pre.className){hs.textClass=gV(hs.pre.className,hs.textClass||"")}return hs}function f4(hp){var i=g5("span","\u2022","cm-invalidchar");i.title="\\u"+hp.charCodeAt(0).toString(16);i.setAttribute("aria-label",i.title);return i}function u(hz,hu,hE,hB,hx,hH,ht){if(!hu){return}var hD=hz.splitSpaces?c6(hu,hz.trailingSpace):hu;var i=hz.cm.state.specialChars,hp=false;var hC;if(!i.test(hu)){hz.col+=hu.length;hC=document.createTextNode(hD);hz.map.push(hz.pos,hz.pos+hu.length,hC);if(eh&&l<9){hp=true}hz.pos+=hu.length}else{hC=document.createDocumentFragment();var hr=0;while(true){i.lastIndex=hr;var hA=i.exec(hu);var hG=hA?hA.index-hr:hu.length-hr;if(hG){var hw=document.createTextNode(hD.slice(hr,hr+hG));if(eh&&l<9){hC.appendChild(g5("span",[hw]))}else{hC.appendChild(hw)}hz.map.push(hz.pos,hz.pos+hG,hw);hz.col+=hG;hz.pos+=hG}if(!hA){break}hr+=hG+1;var hF=void 0;if(hA[0]=="\t"){var hy=hz.cm.options.tabSize,hv=hy-hz.col%hy;hF=hC.appendChild(g5("span",cN(hv),"cm-tab"));hF.setAttribute("role","presentation");hF.setAttribute("cm-text","\t");hz.col+=hv}else{if(hA[0]=="\r"||hA[0]=="\n"){hF=hC.appendChild(g5("span",hA[0]=="\r"?"\u240d":"\u2424","cm-invalidchar"));hF.setAttribute("cm-text",hA[0]);hz.col+=1}else{hF=hz.cm.options.specialCharPlaceholder(hA[0]);hF.setAttribute("cm-text",hA[0]);if(eh&&l<9){hC.appendChild(g5("span",[hF]))}else{hC.appendChild(hF)}hz.col+=1}}hz.map.push(hz.pos,hz.pos+1,hF);hz.pos++}}hz.trailingSpace=hD.charCodeAt(hu.length-1)==32;if(hE||hB||hx||hp||ht){var hq=hE||"";if(hB){hq+=hB}if(hx){hq+=hx}var hs=g5("span",[hC],hq,ht);if(hH){hs.title=hH}return hz.content.appendChild(hs)}hz.content.appendChild(hC)}function c6(hu,ht){if(hu.length>1&&!/  /.test(hu)){return hu}var hq=ht,hp="";for(var hr=0;hr<hu.length;hr++){var hs=hu.charAt(hr);if(hs==" "&&hq&&(hr==hu.length-1||hu.charCodeAt(hr+1)==32)){hs="\u00a0"}hp+=hs;hq=hs==" "}return hp}function W(hp,i){return function(hx,hz,hq,hu,hA,hy,hw){hq=hq?hq+" cm-force-border":"cm-force-border";var hr=hx.pos,ht=hr+hz.length;for(;;){var hs=void 0;for(var hv=0;hv<i.length;hv++){hs=i[hv];if(hs.to>hr&&hs.from<=hr){break}}if(hs.to>=ht){return hp(hx,hz,hq,hu,hA,hy,hw)}hp(hx,hz.slice(0,hs.to-hr),hq,hu,null,hy,hw);hu=null;hz=hz.slice(hs.to-hr);hr=hs.to}}}function ah(hp,hr,i,hq){var hs=!hq&&i.widgetNode;if(hs){hp.map.push(hp.pos,hp.pos+hr,hs)}if(!hq&&hp.cm.display.input.needsContentAttribute){if(!hs){hs=hp.content.appendChild(document.createElement("span"))}hs.setAttribute("cm-marker",i.id)}if(hs){hp.cm.display.input.setUneditable(hs);hp.content.appendChild(hs)}hp.pos+=hr;hp.trailingSpace=false}function bB(hA,hH,hz){var hu=hA.markedSpans,hx=hA.text,hF=0;if(!hu){for(var hv=1;hv<hz.length;hv+=2){hH.addToken(hH,hx.slice(hF,hF=hz[hv]),fJ(hz[hv+1],hH.cm.options))}return}var hL=hx.length,ht=0,hK=1,hD="",hM,hB;var hQ=0,hp,hP,hE,hR,hr;for(;;){if(hQ==ht){hp=hP=hE=hR=hB="";hr=null;hQ=Infinity;var hw=[],hy=void 0;for(var hI=0;hI<hu.length;++hI){var hJ=hu[hI],hG=hJ.marker;if(hG.type=="bookmark"&&hJ.from==ht&&hG.widgetNode){hw.push(hG)}else{if(hJ.from<=ht&&(hJ.to==null||hJ.to>ht||hG.collapsed&&hJ.to==ht&&hJ.from==ht)){if(hJ.to!=null&&hJ.to!=ht&&hQ>hJ.to){hQ=hJ.to;hP=""}if(hG.className){hp+=" "+hG.className}if(hG.css){hB=(hB?hB+";":"")+hG.css}if(hG.startStyle&&hJ.from==ht){hE+=" "+hG.startStyle}if(hG.endStyle&&hJ.to==hQ){(hy||(hy=[])).push(hG.endStyle,hJ.to)}if(hG.title&&!hR){hR=hG.title}if(hG.collapsed&&(!hr||ep(hr.marker,hG)<0)){hr=hJ}}else{if(hJ.from>ht&&hQ>hJ.from){hQ=hJ.from}}}}if(hy){for(var hO=0;hO<hy.length;hO+=2){if(hy[hO+1]==hQ){hP+=" "+hy[hO]}}}if(!hr||hr.from==ht){for(var hN=0;hN<hw.length;++hN){ah(hH,0,hw[hN])}}if(hr&&(hr.from||0)==ht){ah(hH,(hr.to==null?hL+1:hr.to)-ht,hr.marker,hr.from==null);if(hr.to==null){return}if(hr.to==ht){hr=false}}}if(ht>=hL){break}var hC=Math.min(hL,hQ);while(true){if(hD){var hq=ht+hD.length;if(!hr){var hs=hq>hC?hD.slice(0,hC-ht):hD;hH.addToken(hH,hs,hM?hM+hp:hp,hE,ht+hs.length==hQ?hP:"",hR,hB)}if(hq>=hC){hD=hD.slice(hC-ht);ht=hC;break}ht=hq;hE=""}hD=hx.slice(hF,hF=hz[hK++]);hM=fJ(hz[hK++],hH.cm.options)}}}function bI(hq,i,hp){this.line=i;this.rest=g(i);this.size=this.rest?b2(gB(this.rest))-hp+1:1;this.node=this.text=null;this.hidden=gm(hq,i)}function fI(i,hu,ht){var hs=[],hq;for(var hr=hu;hr<ht;hr=hq){var hp=new bI(i.doc,f5(i.doc,hr),hr);hq=hr+hp.size;hs.push(hp)}return hs}var bC=null;function ff(i){if(bC){bC.ops.push(i)}else{i.ownsGroup=bC={ops:[i],delayedCallbacks:[]}}}function dm(hs){var hr=hs.delayedCallbacks,hq=0;do{for(;hq<hr.length;hq++){hr[hq].call(null)}for(var hp=0;hp<hs.ops.length;hp++){var ht=hs.ops[hp];if(ht.cursorActivityHandlers){while(ht.cursorActivityCalled<ht.cursorActivityHandlers.length){ht.cursorActivityHandlers[ht.cursorActivityCalled++].call(null,ht.cm)}}}}while(hq<hr.length)}function ce(hq,hp){var i=hq.ownsGroup;if(!i){return}try{dm(i)}finally{bC=null;hp(i)}}var bN=null;function ai(hv,ht){var hp=eX(hv,ht);if(!hp.length){return}var hr=Array.prototype.slice.call(arguments,2),hu;if(bC){hu=bC.delayedCallbacks}else{if(bN){hu=bN}else{hu=bN=[];setTimeout(aT,0)}}var hq=function(hw){hu.push(function(){return hp[hw].apply(null,hr)})};for(var hs=0;hs<hp.length;++hs){hq(hs)}}function aT(){var hp=bN;bN=null;for(var hq=0;hq<hp.length;++hq){hp[hq]()}}function af(i,hq,hs,ht){for(var hp=0;hp<hq.changes.length;hp++){var hr=hq.changes[hp];if(hr=="text"){gc(i,hq)}else{if(hr=="gutter"){dK(i,hq,hs,ht)}else{if(hr=="class"){ed(hq)}else{if(hr=="widget"){av(i,hq,ht)}}}}}hq.changes=null}function gD(i){if(i.node==i.text){i.node=g5("div",null,null,"position: relative");if(i.text.parentNode){i.text.parentNode.replaceChild(i.node,i.text)}i.node.appendChild(i.text);if(eh&&l<8){i.node.style.zIndex=2}}return i.node}function fa(hp){var i=hp.bgClass?hp.bgClass+" "+(hp.line.bgClass||""):hp.line.bgClass;if(i){i+=" CodeMirror-linebackground"}if(hp.background){if(i){hp.background.className=i}else{hp.background.parentNode.removeChild(hp.background);hp.background=null}}else{if(i){var hq=gD(hp);hp.background=hq.insertBefore(g5("div",null,i),hq.firstChild)}}}function et(i,hp){var hq=i.display.externalMeasured;if(hq&&hq.line==hp.line){i.display.externalMeasured=null;hp.measure=hq.measure;return hq.built}return fE(i,hp)}function gc(i,hr){var hp=hr.text.className;var hq=et(i,hr);if(hr.text==hr.node){hr.node=hq.pre}hr.text.parentNode.replaceChild(hq.pre,hr.text);hr.text=hq.pre;if(hq.bgClass!=hr.bgClass||hq.textClass!=hr.textClass){hr.bgClass=hq.bgClass;hr.textClass=hq.textClass;ed(hr)}else{if(hp){hr.text.className=hp}}}function ed(hp){fa(hp);if(hp.line.wrapClass){gD(hp).className=hp.line.wrapClass}else{if(hp.node!=hp.text){hp.node.className=""}}var i=hp.textClass?hp.textClass+" "+(hp.line.textClass||""):hp.line.textClass;hp.text.className=i||""}function dK(hw,hu,ht,hv){if(hu.gutter){hu.node.removeChild(hu.gutter);hu.gutter=null}if(hu.gutterBackground){hu.node.removeChild(hu.gutterBackground);hu.gutterBackground=null}if(hu.line.gutterClass){var hp=gD(hu);hu.gutterBackground=g5("div",null,"CodeMirror-gutter-background "+hu.line.gutterClass,("left: "+(hw.options.fixedGutter?hv.fixedPos:-hv.gutterTotalWidth)+"px; width: "+(hv.gutterTotalWidth)+"px"));hp.insertBefore(hu.gutterBackground,hu.text)}var hr=hu.line.gutterMarkers;if(hw.options.lineNumbers||hr){var hx=gD(hu);var hs=hu.gutter=g5("div",null,"CodeMirror-gutter-wrapper",("left: "+(hw.options.fixedGutter?hv.fixedPos:-hv.gutterTotalWidth)+"px"));hw.display.input.setUneditable(hs);hx.insertBefore(hs,hu.text);if(hu.line.gutterClass){hs.className+=" "+hu.line.gutterClass}if(hw.options.lineNumbers&&(!hr||!hr["CodeMirror-linenumbers"])){hu.lineNumber=hs.appendChild(g5("div",e7(hw.options,ht),"CodeMirror-linenumber CodeMirror-gutter-elt",("left: "+(hv.gutterLeft["CodeMirror-linenumbers"])+"px; width: "+(hw.display.lineNumInnerWidth)+"px")))}if(hr){for(var hq=0;hq<hw.options.gutters.length;++hq){var i=hw.options.gutters[hq],hy=hr.hasOwnProperty(i)&&hr[i];if(hy){hs.appendChild(g5("div",[hy],"CodeMirror-gutter-elt",("left: "+(hv.gutterLeft[i])+"px; width: "+(hv.gutterWidth[i])+"px")))}}}}}function av(i,hp,hs){if(hp.alignable){hp.alignable=null}for(var hr=hp.node.firstChild,hq=void 0;hr;hr=hq){hq=hr.nextSibling;if(hr.className=="CodeMirror-linewidget"){hp.node.removeChild(hr)}}gj(i,hp,hs)}function aM(i,hq,hr,hs){var hp=et(i,hq);hq.text=hq.node=hp.pre;if(hp.bgClass){hq.bgClass=hp.bgClass}if(hp.textClass){hq.textClass=hp.textClass}ed(hq);dK(i,hq,hr,hs);gj(i,hq,hs);return hq.node}function gj(hp,hr,hs){g7(hp,hr.line,hr,hs,true);if(hr.rest){for(var hq=0;hq<hr.rest.length;hq++){g7(hp,hr.rest[hq],hr,hs,false)}}}function g7(hx,hy,hu,hw,hs){if(!hy.widgets){return}var hp=gD(hu);for(var hr=0,hv=hy.widgets;hr<hv.length;++hr){var ht=hv[hr],hq=g5("div",[ht.node],"CodeMirror-linewidget");if(!ht.handleMouseEvents){hq.setAttribute("cm-ignore-events","true")}bU(ht,hq,hu,hw);hx.display.input.setUneditable(hq);if(hs&&ht.above){hp.insertBefore(hq,hu.gutter||hu.text)}else{hp.appendChild(hq)}ai(ht,"redraw")}}function bU(hr,hq,i,hs){if(hr.noHScroll){(i.alignable||(i.alignable=[])).push(hq);var hp=hs.wrapperWidth;hq.style.left=hs.fixedPos+"px";if(!hr.coverGutter){hp-=hs.gutterTotalWidth;hq.style.paddingLeft=hs.gutterTotalWidth+"px"}hq.style.width=hp+"px"}if(hr.coverGutter){hq.style.zIndex=5;hq.style.position="relative";if(!hr.noHScroll){hq.style.marginLeft=-hs.gutterTotalWidth+"px"}}}function dr(hq){if(hq.height!=null){return hq.height}var i=hq.doc.cm;if(!i){return 0}if(!he(document.body,hq.node)){var hp="position: relative;";if(hq.coverGutter){hp+="margin-left: -"+i.display.gutters.offsetWidth+"px;"}if(hq.noHScroll){hp+="width: "+i.display.wrapper.clientWidth+"px;"}b7(i.display.measure,g5("div",[hq.node],null,hp))}return hq.height=hq.node.parentNode.offsetHeight}function bj(hp,i){for(var hq=M(i);hq!=hp.wrapper;hq=hq.parentNode){if(!hq||(hq.nodeType==1&&hq.getAttribute("cm-ignore-events")=="true")||(hq.parentNode==hp.sizer&&hq!=hp.mover)){return true}}}function fZ(i){return i.lineSpace.offsetTop}function bX(i){return i.mover.offsetHeight-i.lineSpace.offsetHeight}function fU(hr){if(hr.cachedPaddingH){return hr.cachedPaddingH}var hq=b7(hr.measure,g5("pre","x"));var i=window.getComputedStyle?window.getComputedStyle(hq):hq.currentStyle;var hp={left:parseInt(i.paddingLeft),right:parseInt(i.paddingRight)};if(!isNaN(hp.left)&&!isNaN(hp.right)){hr.cachedPaddingH=hp}return hp}function dl(i){return eg-i.display.nativeBarWidth}function dQ(i){return i.display.scroller.clientWidth-dl(i)-i.display.barWidth}function dn(i){return i.display.scroller.clientHeight-dl(i)-i.display.barHeight}function cD(hw,hs,hv){var hr=hw.options.lineWrapping;var ht=hr&&dQ(hw);if(!hs.measure.heights||hr&&hs.measure.width!=ht){var hu=hs.measure.heights=[];if(hr){hs.measure.width=ht;var hy=hs.text.firstChild.getClientRects();for(var hp=0;hp<hy.length-1;hp++){var hx=hy[hp],hq=hy[hp+1];if(Math.abs(hx.bottom-hq.bottom)>2){hu.push((hx.bottom+hq.top)/2-hv.top)}}}hu.push(hv.bottom-hv.top)}}function cR(hr,hp,hs){if(hr.line==hp){return{map:hr.measure.map,cache:hr.measure.cache}}for(var hq=0;hq<hr.rest.length;hq++){if(hr.rest[hq]==hp){return{map:hr.measure.maps[hq],cache:hr.measure.caches[hq]}}}for(var ht=0;ht<hr.rest.length;ht++){if(b2(hr.rest[ht])>hs){return{map:hr.measure.maps[ht],cache:hr.measure.caches[ht],before:true}}}}function dv(i,hq){hq=z(hq);var hs=b2(hq);var hp=i.display.externalMeasured=new bI(i.doc,hq,hs);hp.lineN=hs;var hr=hp.built=fE(i,hp);hp.text=hr.pre;b7(i.display.lineMeasure,hr.pre);return hp}function eS(i,hp,hr,hq){return E(i,bd(i,hp),hr,hq)}function f2(i,hq){if(hq>=i.display.viewFrom&&hq<i.display.viewTo){return i.display.view[dV(i,hq)]}var hp=i.display.externalMeasured;if(hp&&hq>=hp.lineN&&hq<hp.lineN+hp.size){return hp}}function bd(i,hq){var hr=b2(hq);var hp=f2(i,hr);if(hp&&!hp.text){hp=null}else{if(hp&&hp.changes){af(i,hp,hr,f3(i));i.curOp.forceUpdate=true}}if(!hp){hp=dv(i,hq)}var hs=cR(hp,hq,hr);return{line:hq,view:hp,rect:null,map:hs.map,cache:hs.cache,before:hs.before,hasHeights:false}}function E(i,hu,hs,hp,hr){if(hu.before){hs=-1}var hq=hs+(hp||""),ht;if(hu.cache.hasOwnProperty(hq)){ht=hu.cache[hq]}else{if(!hu.rect){hu.rect=hu.view.text.getBoundingClientRect()}if(!hu.hasHeights){cD(i,hu.view,hu.rect);hu.hasHeights=true}ht=k(i,hu,hs,hp);if(!ht.bogus){hu.cache[hq]=ht}}return{left:ht.left,right:ht.right,top:hr?ht.rtop:ht.top,bottom:hr?ht.rbottom:ht.bottom}}var fj={left:0,right:0,top:0,bottom:0};function aR(hy,hp,hv){var hr,hq,ht,hw,hs,hx;for(var hu=0;hu<hy.length;hu+=3){hs=hy[hu];hx=hy[hu+1];if(hp<hs){hq=0;ht=1;hw="left"}else{if(hp<hx){hq=hp-hs;ht=hq+1}else{if(hu==hy.length-3||hp==hx&&hy[hu+3]>hp){ht=hx-hs;hq=ht-1;if(hp>=hx){hw="right"}}}}if(hq!=null){hr=hy[hu+2];if(hs==hx&&hv==(hr.insertLeft?"left":"right")){hw=hv}if(hv=="left"&&hq==0){while(hu&&hy[hu-2]==hy[hu-3]&&hy[hu-1].insertLeft){hr=hy[(hu-=3)+2];hw="left"}}if(hv=="right"&&hq==hx-hs){while(hu<hy.length-3&&hy[hu+3]==hy[hu+4]&&!hy[hu+5].insertLeft){hr=hy[(hu+=3)+2];hw="right"}}break}}return{node:hr,start:hq,end:ht,collapse:hw,coverStart:hs,coverEnd:hx}}function fF(hq,hp){var hs=fj;if(hp=="left"){for(var hr=0;hr<hq.length;hr++){if((hs=hq[hr]).left!=hs.right){break}}}else{for(var ht=hq.length-1;ht>=0;ht--){if((hs=hq[ht]).left!=hs.right){break}}}return hs}function k(hx,hH,hA,hu){var hy=aR(hH.map,hA,hu);var hF=hy.node,ht=hy.start,hs=hy.end,hp=hy.collapse;var hq;if(hF.nodeType==3){for(var hv=0;hv<4;hv++){while(ht&&gf(hH.line.text.charAt(hy.coverStart+ht))){--ht}while(hy.coverStart+hs<hy.coverEnd&&gf(hH.line.text.charAt(hy.coverStart+hs))){++hs}if(eh&&l<9&&ht==0&&hs==hy.coverEnd-hy.coverStart){hq=hF.parentNode.getBoundingClientRect()}else{hq=fF(cK(hF,ht,hs).getClientRects(),hu)}if(hq.left||hq.right||ht==0){break}hs=ht;ht=ht-1;hp="right"}if(eh&&l<11){hq=fy(hx.display.measure,hq)}}else{if(ht>0){hp=hu="right"}var hr;if(hx.options.lineWrapping&&(hr=hF.getClientRects()).length>1){hq=hr[hu=="right"?hr.length-1:0]}else{hq=hF.getBoundingClientRect()}}if(eh&&l<9&&!ht&&(!hq||!hq.left&&!hq.right)){var hw=hF.parentNode.getClientRects()[0];if(hw){hq={left:hw.left,right:hw.left+ea(hx.display),top:hw.top,bottom:hw.bottom}}else{hq=fj}}var hD=hq.top-hH.rect.top,hB=hq.bottom-hH.rect.top;var hJ=(hD+hB)/2;var hI=hH.view.measure.heights;var hG=0;for(;hG<hI.length-1;hG++){if(hJ<hI[hG]){break}}var hE=hG?hI[hG-1]:0,hC=hI[hG];var hz={left:(hp=="right"?hq.right:hq.left)-hH.rect.left,right:(hp=="left"?hq.left:hq.right)-hH.rect.left,top:hE,bottom:hC};if(!hq.left&&!hq.right){hz.bogus=true}if(!hx.options.singleCursorHeightPerLine){hz.rtop=hD;hz.rbottom=hB}return hz}function fy(hq,hr){if(!window.screen||screen.logicalXDPI==null||screen.logicalXDPI==screen.deviceXDPI||!aS(hq)){return hr}var hp=screen.logicalXDPI/screen.deviceXDPI;var i=screen.logicalYDPI/screen.deviceYDPI;return{left:hr.left*hp,right:hr.right*hp,top:hr.top*i,bottom:hr.bottom*i}}function aB(hq){if(hq.measure){hq.measure.cache={};hq.measure.heights=null;if(hq.rest){for(var hp=0;hp<hq.rest.length;hp++){hq.measure.caches[hp]={}}}}}function aV(hp){hp.display.externalMeasure=null;eA(hp.display.lineMeasure);for(var hq=0;hq<hp.display.view.length;hq++){aB(hp.display.view[hq])}}function ao(i){aV(i);i.display.cachedCharWidth=i.display.cachedTextHeight=i.display.cachedPaddingH=null;if(!i.options.lineWrapping){i.display.maxLineChanged=true}i.display.lineNumChars=null}function cS(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function cQ(){return window.pageYOffset||(document.documentElement||document.body).scrollTop}function fC(hw,ht,hv,hq,hs){if(!hs&&ht.widgets){for(var hr=0;hr<ht.widgets.length;++hr){if(ht.widgets[hr].above){var hy=dr(ht.widgets[hr]);hv.top+=hy;hv.bottom+=hy}}}if(hq=="line"){return hv}if(!hq){hq="local"}var hu=b1(ht);if(hq=="local"){hu+=fZ(hw.display)}else{hu-=hw.display.viewOffset}if(hq=="page"||hq=="window"){var hp=hw.display.lineSpace.getBoundingClientRect();hu+=hp.top+(hq=="window"?0:cQ());var hx=hp.left+(hq=="window"?0:cS());hv.left+=hx;hv.right+=hx}hv.top+=hu;hv.bottom+=hu;return hv}function hj(hp,hs,hq){if(hq=="div"){return hs}var hu=hs.left,ht=hs.top;if(hq=="page"){hu-=cS();ht-=cQ()}else{if(hq=="local"||!hq){var hr=hp.display.sizer.getBoundingClientRect();hu+=hr.left;ht+=hr.top}}var i=hp.display.lineSpace.getBoundingClientRect();return{left:hu-i.left,top:ht-i.top}}function db(i,hs,hr,hq,hp){if(!hq){hq=f5(i.doc,hs.line)}return fC(i,hq,eS(i,hq,hs.ch,hp),hr)}function es(hx,hw,hq,hu,hz,hv){hu=hu||f5(hx.doc,hw.line);if(!hz){hz=bd(hx,hu)}function hs(hC,hB){var hA=E(hx,hz,hC,hB?"right":"left",hv);if(hB){hA.left=hA.right}else{hA.right=hA.left}return fC(hx,hu,hA,hq)}function hy(hD,hA){var hB=ht[hA],hC=hB.level%2;if(hD==d6(hB)&&hA&&hB.level<ht[hA-1].level){hB=ht[--hA];hD=hi(hB)-(hB.level%2?0:1);hC=true}else{if(hD==hi(hB)&&hA<ht.length-1&&hB.level<ht[hA+1].level){hB=ht[++hA];hD=d6(hB)-hB.level%2;hC=false}}if(hC&&hD==hB.to&&hD>hB.from){return hs(hD-1)}return hs(hD,hC)}var ht=a(hu),i=hw.ch;if(!ht){return hs(i)}var hp=aO(ht,i);var hr=hy(i,hp);if(fR!=null){hr.other=hy(i,fR)}return hr}function ee(i,hs){var hr=0;hs=gH(i.doc,hs);if(!i.options.lineWrapping){hr=ea(i.display)*hs.ch}var hp=f5(i.doc,hs.line);var hq=b1(hp)+fZ(i.display);return{left:hr,right:hr,top:hq,bottom:hq+hp.height}}function g3(i,hp,hq,hs){var hr=Y(i,hp);hr.xRel=hs;if(hq){hr.outside=true}return hr}function gO(hv,hs,hr){var hu=hv.doc;hr+=hv.display.viewOffset;if(hr<0){return g3(hu.first,0,true,-1)}var hq=bW(hu,hr),hw=hu.first+hu.size-1;if(hq>hw){return g3(hu.first+hu.size-1,f5(hu,hw).text.length,true,1)}if(hs<0){hs=0}var hp=f5(hu,hq);for(;;){var hx=ds(hv,hp,hq,hs,hr);var ht=fb(hp);var i=ht&&ht.find(0,true);if(ht&&(hx.ch>i.from.ch||hx.ch==i.from.ch&&hx.xRel>0)){hq=b2(hp=i.to.line)}else{return hx}}}function ds(hz,hr,hO,hB,hA){var hy=hA-b1(hr);var hv=false,hH=2*hz.display.wrapper.clientWidth;var hE=bd(hz,hr);function hM(i){var hQ=es(hz,Y(hO,i),"line",hr,hE);hv=true;if(hy>hQ.bottom){return hQ.left-hH}else{if(hy<hQ.top){return hQ.left+hH}else{hv=false}}return hQ.left}var hD=a(hr),hG=hr.text.length;var hI=c4(hr),hs=dk(hr);var hF=hM(hI),hp=hv,hq=hM(hs),hu=hv;if(hB>hq){return g3(hO,hs,hu,1)}for(;;){if(hD?hs==hI||hs==v(hr,hI,1):hs-hI<=1){var hC=hB<hF||hB-hF<=hq-hB?hI:hs;var hN=hC==hI?hp:hu;var hL=hB-(hC==hI?hF:hq);if(hu&&!hD&&!/\s/.test(hr.text.charAt(hC))&&hL>0&&hC<hr.text.length&&hE.view.measure.heights.length>1){var hJ=E(hz,hE,hC,"right");if(hy<=hJ.bottom&&hy>=hJ.top&&Math.abs(hB-hJ.right)<hL){hN=false;hC++;hL=hB-hJ.right}}while(gf(hr.text.charAt(hC))){++hC}var hx=g3(hO,hC,hN,hL<-1?-1:hL>1?1:0);return hx}var hw=Math.ceil(hG/2),hP=hI+hw;if(hD){hP=hI;for(var hK=0;hK<hw;++hK){hP=v(hr,hP,1)}}var ht=hM(hP);if(ht>hB){hs=hP;hq=ht;if(hu=hv){hq+=1000}hG=hw}else{hI=hP;hF=ht;hp=hv;hG-=hw}}}var aN;function a6(hr){if(hr.cachedTextHeight!=null){return hr.cachedTextHeight}if(aN==null){aN=g5("pre");for(var hq=0;hq<49;++hq){aN.appendChild(document.createTextNode("x"));aN.appendChild(g5("br"))}aN.appendChild(document.createTextNode("x"))}b7(hr.measure,aN);var hp=aN.offsetHeight/50;if(hp>3){hr.cachedTextHeight=hp}eA(hr.measure);return hp||1}function ea(hs){if(hs.cachedCharWidth!=null){return hs.cachedCharWidth}var i=g5("span","xxxxxxxxxx");var hr=g5("pre",[i]);b7(hs.measure,hr);var hq=i.getBoundingClientRect(),hp=(hq.right-hq.left)/10;if(hp>2){hs.cachedCharWidth=hp}return hp||10}function f3(hp){var hu=hp.display,hs={},hr={};var ht=hu.gutters.clientLeft;for(var hv=hu.gutters.firstChild,hq=0;hv;hv=hv.nextSibling,++hq){hs[hp.options.gutters[hq]]=hv.offsetLeft+hv.clientLeft+ht;hr[hp.options.gutters[hq]]=hv.clientWidth}return{fixedPos:ew(hu),gutterTotalWidth:hu.gutters.offsetWidth,gutterLeft:hs,gutterWidth:hr,wrapperWidth:hu.wrapper.clientWidth}}function ew(i){return i.scroller.getBoundingClientRect().left-i.sizer.getBoundingClientRect().left}function bn(i){var hq=a6(i.display),hp=i.options.lineWrapping;var hr=hp&&Math.max(5,i.display.scroller.clientWidth/ea(i.display)-3);return function(ht){if(gm(i.doc,ht)){return 0}var hs=0;if(ht.widgets){for(var hu=0;hu<ht.widgets.length;hu++){if(ht.widgets[hu].height){hs+=ht.widgets[hu].height}}}if(hp){return hs+(Math.ceil(ht.text.length/hr)||1)*hq}else{return hs+hq}}}function aa(i){var hq=i.doc,hp=bn(i);hq.iter(function(hr){var hs=hp(hr);if(hs!=hr.height){g9(hr,hs)}})}function cL(hx,hs,hp,hq){var ht=hx.display;if(!hp&&M(hs).getAttribute("cm-not-content")=="true"){return null}var hw,hu,i=ht.lineSpace.getBoundingClientRect();try{hw=hs.clientX-i.left;hu=hs.clientY-i.top}catch(hs){return null}var hv=gO(hx,hw,hu),hy;if(hq&&hv.xRel==1&&(hy=f5(hx.doc,hv.line).text).length==hv.ch){var hr=b6(hy,hy.length,hx.options.tabSize)-hy.length;hv=Y(hv.line,Math.max(0,Math.round((hw-fU(hx.display).left)/ea(hx.display))-hr))}return hv}function dV(hp,hs){if(hs>=hp.display.viewTo){return null}hs-=hp.display.viewFrom;if(hs<0){return null}var hq=hp.display.view;for(var hr=0;hr<hq.length;hr++){hs-=hq[hr].size;if(hs<0){return hr}}}function bR(i){i.display.input.showSelection(i.display.input.prepareSelection())}function gE(hv,hp){var hu=hv.doc,hx={};var ht=hx.cursors=document.createDocumentFragment();var hq=hx.selection=document.createDocumentFragment();for(var hs=0;hs<hu.sel.ranges.length;hs++){if(hp===false&&hs==hu.sel.primIndex){continue}var hw=hu.sel.ranges[hs];if(hw.from().line>=hv.display.viewTo||hw.to().line<hv.display.viewFrom){continue}var hr=hw.empty();if(hr||hv.options.showCursorWhenSelecting){B(hv,hw.head,ht)}if(!hr){bS(hv,hw,hq)}}return hx}function B(i,hr,hq){var ht=es(i,hr,"div",null,null,!i.options.singleCursorHeightPerLine);var hs=hq.appendChild(g5("div","\u00a0","CodeMirror-cursor"));hs.style.left=ht.left+"px";hs.style.top=ht.top+"px";hs.style.height=Math.max(0,ht.bottom-ht.top)*i.options.cursorHeight+"px";if(ht.other){var hp=hq.appendChild(g5("div","\u00a0","CodeMirror-cursor CodeMirror-secondarycursor"));hp.style.display="";hp.style.left=ht.other.left+"px";hp.style.top=ht.other.top+"px";hp.style.height=(ht.other.bottom-ht.other.top)*0.85+"px"}}function bS(ht,hs,hu){var hB=ht.display,hF=ht.doc;var i=document.createDocumentFragment();var hy=fU(ht.display),hr=hy.left;var hC=Math.max(hB.sizerWidth,dQ(ht)-hB.sizer.offsetLeft)-hy.right;function hz(hJ,hI,hH,hG){if(hI<0){hI=0}hI=Math.round(hI);hG=Math.round(hG);i.appendChild(g5("div",null,"CodeMirror-selected",("position: absolute; left: "+hJ+"px;\n                             top: "+hI+"px; width: "+(hH==null?hC-hJ:hH)+"px;\n                             height: "+(hG-hI)+"px")))}function hp(hH,hJ,hM){var hI=f5(hF,hH);var hK=hI.text.length;var hN,hG;function hL(hP,hO){return db(ht,Y(hH,hP),"div",hI,hO)}eD(a(hI),hJ||0,hM==null?hK:hM,function(hV,hU,hO){var hR=hL(hV,"left"),hS,hT,hQ;if(hV==hU){hS=hR;hT=hQ=hR.left}else{hS=hL(hU-1,"right");if(hO=="rtl"){var hP=hR;hR=hS;hS=hP}hT=hR.left;hQ=hS.right}if(hJ==null&&hV==0){hT=hr}if(hS.top-hR.top>3){hz(hT,hR.top,null,hR.bottom);hT=hr;if(hR.bottom<hS.top){hz(hT,hR.bottom,null,hS.top)}}if(hM==null&&hU==hK){hQ=hC}if(!hN||hR.top<hN.top||hR.top==hN.top&&hR.left<hN.left){hN=hR}if(!hG||hS.bottom>hG.bottom||hS.bottom==hG.bottom&&hS.right>hG.right){hG=hS}if(hT<hr+1){hT=hr}hz(hT,hS.top,hQ-hT,hS.bottom)});return{start:hN,end:hG}}var hE=hs.from(),hD=hs.to();if(hE.line==hD.line){hp(hE.line,hE.ch,hD.ch)}else{var hq=f5(hF,hE.line),hw=f5(hF,hD.line);var hv=z(hq)==z(hw);var hx=hp(hE.line,hE.ch,hv?hq.text.length+1:null).end;var hA=hp(hD.line,hv?0:null,hD.ch).start;if(hv){if(hx.top<hA.top-2){hz(hx.right,hx.top,null,hx.bottom);hz(hr,hA.top,hA.left,hA.bottom)}else{hz(hx.right,hx.top,hA.left-hx.right,hx.bottom)}}if(hx.bottom<hA.top){hz(hr,hx.bottom,null,hA.top)}}hu.appendChild(i)}function p(i){if(!i.state.focused){return}var hq=i.display;clearInterval(hq.blinker);var hp=true;hq.cursorDiv.style.visibility="";if(i.options.cursorBlinkRate>0){hq.blinker=setInterval(function(){return hq.cursorDiv.style.visibility=(hp=!hp)?"":"hidden"},i.options.cursorBlinkRate)}else{if(i.options.cursorBlinkRate<0){hq.cursorDiv.style.visibility="hidden"}}}function t(i){if(!i.state.focused){i.display.input.focus();c0(i)}}function ap(i){i.state.delayingBlurEvent=true;setTimeout(function(){if(i.state.delayingBlurEvent){i.state.delayingBlurEvent=false;a2(i)}},100)}function c0(i,hp){if(i.state.delayingBlurEvent){i.state.delayingBlurEvent=false}if(i.options.readOnly=="nocursor"){return}if(!i.state.focused){aL(i,"focus",i,hp);i.state.focused=true;gv(i.display.wrapper,"CodeMirror-focused");if(!i.curOp&&i.display.selForContextMenu!=i.doc.sel){i.display.input.reset();if(dt){setTimeout(function(){return i.display.input.reset(true)},20)}}i.display.input.receivedFocus()}p(i)}function a2(i,hp){if(i.state.delayingBlurEvent){return}if(i.state.focused){aL(i,"blur",i,hp);i.state.focused=false;h(i.display.wrapper,"CodeMirror-focused")}clearInterval(i.display.blinker);setTimeout(function(){if(!i.state.focused){i.display.shift=false}},150)}function fn(hx){var hv=hx.display,hw=hv.view;if(!hv.alignWidgets&&(!hv.gutters.firstChild||!hx.options.fixedGutter)){return}var ht=ew(hv)-hv.scroller.scrollLeft+hx.doc.scrollLeft;var hp=hv.gutters.offsetWidth,hq=ht+"px";for(var hs=0;hs<hw.length;hs++){if(!hw[hs].hidden){if(hx.options.fixedGutter){if(hw[hs].gutter){hw[hs].gutter.style.left=hq}if(hw[hs].gutterBackground){hw[hs].gutterBackground.style.left=hq}}var hu=hw[hs].alignable;if(hu){for(var hr=0;hr<hu.length;hr++){hu[hr].style.left=hq}}}}if(hx.options.fixedGutter){hv.gutters.style.left=(ht+hp)+"px"}}function eE(i){if(!i.options.lineNumbers){return false}var ht=i.doc,hp=e7(i.options,ht.first+ht.size-1),hs=i.display;if(hp.length!=hs.lineNumChars){var hu=hs.measure.appendChild(g5("div",[g5("div",hp)],"CodeMirror-linenumber CodeMirror-gutter-elt"));var hq=hu.firstChild.offsetWidth,hr=hu.offsetWidth-hq;hs.lineGutter.style.width="";hs.lineNumInnerWidth=Math.max(hq,hs.lineGutter.offsetWidth-hr)+1;hs.lineNumWidth=hs.lineNumInnerWidth+hr;hs.lineNumChars=hs.lineNumInnerWidth?hp.length:-1;hs.lineGutter.style.width=hs.lineNumWidth+"px";dx(i);return true}return false}function bh(hw){var hu=hw.display;var hq=hu.lineDiv.offsetTop;for(var hr=0;hr<hu.view.length;hr++){var hx=hu.view[hr],hy=void 0;if(hx.hidden){continue}if(eh&&l<8){var ht=hx.node.offsetTop+hx.node.offsetHeight;hy=ht-hq;hq=ht}else{var hs=hx.node.getBoundingClientRect();hy=hs.bottom-hs.top}var hv=hx.line.height-hy;if(hy<2){hy=a6(hu)}if(hv>0.001||hv<-0.001){g9(hx.line,hy);cs(hx.line);if(hx.rest){for(var hp=0;hp<hx.rest.length;hp++){cs(hx.rest[hp])}}}}}function cs(hp){if(hp.widgets){for(var hq=0;hq<hp.widgets.length;++hq){hp.widgets[hq].height=hp.widgets[hq].node.parentNode.offsetHeight}}}function cn(hr,hv,hq){var hs=hq&&hq.top!=null?Math.max(0,hq.top):hr.scroller.scrollTop;hs=Math.floor(hs-fZ(hr));var i=hq&&hq.bottom!=null?hq.bottom:hs+hr.wrapper.clientHeight;var ht=bW(hv,hs),hu=bW(hv,i);if(hq&&hq.ensure){var hp=hq.ensure.from.line,hw=hq.ensure.to.line;if(hp<ht){ht=hp;hu=bW(hv,b1(f5(hv,hp))+hr.wrapper.clientHeight)}else{if(Math.min(hw,hv.lastLine())>=hu){ht=bW(hv,b1(f5(hv,hw))-hr.wrapper.clientHeight);hu=hw}}}return{from:ht,to:Math.max(hu,ht+1)}}function P(i,hp){if(Math.abs(i.doc.scrollTop-hp)<2){return}i.doc.scrollTop=hp;if(!cM){er(i,{top:hp})}if(i.display.scroller.scrollTop!=hp){i.display.scroller.scrollTop=hp}i.display.scrollbars.setScrollTop(hp);if(cM){er(i)}eO(i,100)}function bT(i,hq,hp){if(hp?hq==i.doc.scrollLeft:Math.abs(i.doc.scrollLeft-hq)<2){return}hq=Math.min(hq,i.display.scroller.scrollWidth-i.display.scroller.clientWidth);i.doc.scrollLeft=hq;fn(i);if(i.display.scroller.scrollLeft!=hq){i.display.scroller.scrollLeft=hq}i.display.scrollbars.setScrollLeft(hq)}var gd=0;var cB=null;if(eh){cB=-0.53}else{if(cM){cB=15}else{if(dH){cB=-0.7}else{if(aJ){cB=-1/3}}}}function di(hq){var hp=hq.wheelDeltaX,i=hq.wheelDeltaY;if(hp==null&&hq.detail&&hq.axis==hq.HORIZONTAL_AXIS){hp=hq.detail}if(i==null&&hq.detail&&hq.axis==hq.VERTICAL_AXIS){i=hq.detail}else{if(i==null){i=hq.wheelDelta}}return{x:hp,y:i}}function aG(i){var hp=di(i);hp.x*=cB;hp.y*=cB;return hp}function c(hz,ht){var hB=di(ht),hD=hB.x,hC=hB.y;var hv=hz.display,hy=hv.scroller;var hs=hy.scrollWidth>hy.clientWidth;var hr=hy.scrollHeight>hy.clientHeight;if(!(hD&&hs||hC&&hr)){return}if(hC&&co&&dt){outer:for(var hA=ht.target,hx=hv.view;hA!=hy;hA=hA.parentNode){for(var hq=0;hq<hx.length;hq++){if(hx[hq].node==hA){hz.display.currentWheelTarget=hA;break outer}}}}if(hD&&!cM&&!eB&&cB!=null){if(hC&&hr){P(hz,Math.max(0,Math.min(hy.scrollTop+hC*cB,hy.scrollHeight-hy.clientHeight)))}bT(hz,Math.max(0,Math.min(hy.scrollLeft+hD*cB,hy.scrollWidth-hy.clientWidth)));if(!hC||(hC&&hr)){c7(ht)}hv.wheelStartX=null;return}if(hC&&cB!=null){var hp=hC*cB;var hw=hz.doc.scrollTop,hu=hw+hv.wrapper.clientHeight;if(hp<0){hw=Math.max(0,hw+hp-50)}else{hu=Math.min(hz.doc.height,hu+hp+50)}er(hz,{top:hw,bottom:hu})}if(gd<20){if(hv.wheelStartX==null){hv.wheelStartX=hy.scrollLeft;hv.wheelStartY=hy.scrollTop;hv.wheelDX=hD;hv.wheelDY=hC;setTimeout(function(){if(hv.wheelStartX==null){return}var i=hy.scrollLeft-hv.wheelStartX;var hF=hy.scrollTop-hv.wheelStartY;var hE=(hF&&hv.wheelDY&&hF/hv.wheelDY)||(i&&hv.wheelDX&&i/hv.wheelDX);hv.wheelStartX=hv.wheelStartY=null;if(!hE){return}cB=(cB*gd+hE)/(gd+1);++gd},200)}else{hv.wheelDX+=hD;hv.wheelDY+=hC}}}function d7(i){var hr=i.display,hq=hr.gutters.offsetWidth;var hp=Math.round(i.doc.height+bX(i.display));return{clientHeight:hr.scroller.clientHeight,viewHeight:hr.wrapper.clientHeight,scrollWidth:hr.scroller.scrollWidth,clientWidth:hr.scroller.clientWidth,viewWidth:hr.wrapper.clientWidth,barLeft:i.options.fixedGutter?hq:0,docHeight:hp,scrollHeight:hp+dl(i)+hr.barHeight,nativeBarWidth:hr.nativeBarWidth,gutterWidth:hq}}var dP=function dP(hq,hp,i){this.cm=i;var hr=this.vert=g5("div",[g5("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar");var hs=this.horiz=g5("div",[g5("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");hq(hr);hq(hs);cd(hr,"scroll",function(){if(hr.clientHeight){hp(hr.scrollTop,"vertical")}});cd(hs,"scroll",function(){if(hs.clientWidth){hp(hs.scrollLeft,"horizontal")}});this.checkedZeroWidth=false;if(eh&&l<8){this.horiz.style.minHeight=this.vert.style.minWidth="18px"}};dP.prototype.update=function c5(hr){var hs=hr.scrollWidth>hr.clientWidth+1;var hq=hr.scrollHeight>hr.clientHeight+1;var ht=hr.nativeBarWidth;if(hq){this.vert.style.display="block";this.vert.style.bottom=hs?ht+"px":"0";var hp=hr.viewHeight-(hs?ht:0);this.vert.firstChild.style.height=Math.max(0,hr.scrollHeight-hr.clientHeight+hp)+"px"}else{this.vert.style.display="";this.vert.firstChild.style.height="0"}if(hs){this.horiz.style.display="block";this.horiz.style.right=hq?ht+"px":"0";this.horiz.style.left=hr.barLeft+"px";var i=hr.viewWidth-hr.barLeft-(hq?ht:0);this.horiz.firstChild.style.width=(hr.scrollWidth-hr.clientWidth+i)+"px"}else{this.horiz.style.display="";this.horiz.firstChild.style.width="0"}if(!this.checkedZeroWidth&&hr.clientHeight>0){if(ht==0){this.zeroWidthHack()}this.checkedZeroWidth=true}return{right:hq?ht:0,bottom:hs?ht:0}};dP.prototype.setScrollLeft=function cH(i){if(this.horiz.scrollLeft!=i){this.horiz.scrollLeft=i}if(this.disableHoriz){this.enableZeroWidthBar(this.horiz,this.disableHoriz)}};dP.prototype.setScrollTop=function ae(i){if(this.vert.scrollTop!=i){this.vert.scrollTop=i}if(this.disableVert){this.enableZeroWidthBar(this.vert,this.disableVert)}};dP.prototype.zeroWidthHack=function fh(){var i=co&&!dA?"12px":"18px";this.horiz.style.height=this.vert.style.width=i;this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none";this.disableHoriz=new ho;this.disableVert=new ho};dP.prototype.enableZeroWidthBar=function fP(hp,i){hp.style.pointerEvents="auto";function hq(){var hs=hp.getBoundingClientRect();var hr=document.elementFromPoint(hs.left+1,hs.bottom-1);if(hr!=hp){hp.style.pointerEvents="none"}else{i.set(1000,hq)}}i.set(1000,hq)};dP.prototype.clear=function fe(){var i=this.horiz.parentNode;i.removeChild(this.horiz);i.removeChild(this.vert)};var fS=function fS(){};fS.prototype.update=function c5(){return{bottom:0,right:0}};fS.prototype.setScrollLeft=function cG(){};fS.prototype.setScrollTop=function ad(){};fS.prototype.clear=function fe(){};function fL(hr,ht){if(!ht){ht=d7(hr)}var hq=hr.display.barWidth,hp=hr.display.barHeight;a1(hr,ht);for(var hs=0;hs<4&&hq!=hr.display.barWidth||hp!=hr.display.barHeight;hs++){if(hq!=hr.display.barWidth&&hr.options.lineWrapping){bh(hr)}a1(hr,d7(hr));hq=hr.display.barWidth;hp=hr.display.barHeight}}function a1(i,hp){var hr=i.display;var hq=hr.scrollbars.update(hp);hr.sizer.style.paddingRight=(hr.barWidth=hq.right)+"px";hr.sizer.style.paddingBottom=(hr.barHeight=hq.bottom)+"px";hr.heightForcer.style.borderBottom=hq.bottom+"px solid transparent";if(hq.right&&hq.bottom){hr.scrollbarFiller.style.display="block";hr.scrollbarFiller.style.height=hq.bottom+"px";hr.scrollbarFiller.style.width=hq.right+"px"}else{hr.scrollbarFiller.style.display=""}if(hq.bottom&&i.options.coverGutterNextToScrollbar&&i.options.fixedGutter){hr.gutterFiller.style.display="block";hr.gutterFiller.style.height=hq.bottom+"px";hr.gutterFiller.style.width=hp.gutterWidth+"px"}else{hr.gutterFiller.style.display=""}}var bw={"native":dP,"null":fS};function aK(i){if(i.display.scrollbars){i.display.scrollbars.clear();if(i.display.scrollbars.addClass){h(i.display.wrapper,i.display.scrollbars.addClass)}}i.display.scrollbars=new bw[i.options.scrollbarStyle](function(hp){i.display.wrapper.insertBefore(hp,i.display.scrollbarFiller);cd(hp,"mousedown",function(){if(i.state.focused){setTimeout(function(){return i.display.input.focus()},0)}});hp.setAttribute("cm-not-content","true")},function(hq,hp){if(hp=="horizontal"){bT(i,hq)}else{P(i,hq)}},i);if(i.display.scrollbars.addClass){gv(i.display.wrapper,i.display.scrollbars.addClass)}}function eF(hp,hs){if(aY(hp,"scrollCursorIntoView")){return}var ht=hp.display,hq=ht.sizer.getBoundingClientRect(),i=null;if(hs.top+hq.top<0){i=true}else{if(hs.bottom+hq.top>(window.innerHeight||document.documentElement.clientHeight)){i=false}}if(i!=null&&!gk){var hr=g5("div","\u200b",null,("position: absolute;\n                         top: "+(hs.top-ht.viewOffset-fZ(hp.display))+"px;\n                         height: "+(hs.bottom-hs.top+dl(hp)+ht.barHeight)+"px;\n                         left: "+(hs.left)+"px; width: 2px;"));hp.display.lineSpace.appendChild(hr);hr.scrollIntoView(i);hp.display.lineSpace.removeChild(hr)}}function F(hy,hw,hs,hr){if(hr==null){hr=0}var hx;for(var ht=0;ht<5;ht++){var hu=false;hx=es(hy,hw);var i=!hs||hs==hw?hx:es(hy,hs);var hq=I(hy,Math.min(hx.left,i.left),Math.min(hx.top,i.top)-hr,Math.max(hx.left,i.left),Math.max(hx.bottom,i.bottom)+hr);var hv=hy.doc.scrollTop,hp=hy.doc.scrollLeft;if(hq.scrollTop!=null){P(hy,hq.scrollTop);if(Math.abs(hy.doc.scrollTop-hv)>1){hu=true}}if(hq.scrollLeft!=null){bT(hy,hq.scrollLeft);if(Math.abs(hy.doc.scrollLeft-hp)>1){hu=true}}if(!hu){break}}return hx}function G(i,hq,hs,hp,hr){var ht=I(i,hq,hs,hp,hr);if(ht.scrollTop!=null){P(i,ht.scrollTop)}if(ht.scrollLeft!=null){bT(i,ht.scrollLeft)}}function I(hA,hr,hz,hp,hy){var hw=hA.display,hu=a6(hA.display);if(hz<0){hz=0}var hs=hA.curOp&&hA.curOp.scrollTop!=null?hA.curOp.scrollTop:hw.scroller.scrollTop;var hC=dn(hA),hE={};if(hy-hz>hC){hy=hz+hC}var hq=hA.doc.height+bX(hw);var i=hz<hu,hv=hy>hq-hu;if(hz<hs){hE.scrollTop=i?0:hz}else{if(hy>hs+hC){var hx=Math.min(hz,(hv?hq:hy)-hC);if(hx!=hs){hE.scrollTop=hx}}}var hD=hA.curOp&&hA.curOp.scrollLeft!=null?hA.curOp.scrollLeft:hw.scroller.scrollLeft;var hB=dQ(hA)-(hA.options.fixedGutter?hw.gutters.offsetWidth:0);var ht=hp-hr>hB;if(ht){hp=hr+hB}if(hr<10){hE.scrollLeft=0}else{if(hr<hD){hE.scrollLeft=Math.max(0,hr-(ht?0:10))}else{if(hp>hB+hD-3){hE.scrollLeft=hp+(ht?0:10)-hB}}}return hE}function dd(i,hq,hp){if(hq!=null||hp!=null){gx(i)}if(hq!=null){i.curOp.scrollLeft=(i.curOp.scrollLeft==null?i.doc.scrollLeft:i.curOp.scrollLeft)+hq}if(hp!=null){i.curOp.scrollTop=(i.curOp.scrollTop==null?i.doc.scrollTop:i.curOp.scrollTop)+hp}}function gA(i){gx(i);var hp=i.getCursor(),hr=hp,hq=hp;if(!i.options.lineWrapping){hr=hp.ch?Y(hp.line,hp.ch-1):hp;hq=Y(hp.line,hp.ch+1)}i.curOp.scrollToPos={from:hr,to:hq,margin:i.options.cursorScrollMargin,isCursor:true}}function gx(i){var hq=i.curOp.scrollToPos;if(hq){i.curOp.scrollToPos=null;var hs=ee(i,hq.from),hr=ee(i,hq.to);var hp=I(i,Math.min(hs.left,hr.left),Math.min(hs.top,hr.top)-hq.margin,Math.max(hs.right,hr.right),Math.max(hs.bottom,hr.bottom)+hq.margin);i.scrollTo(hp.scrollLeft,hp.scrollTop)}}var eJ=0;function da(i){i.curOp={cm:i,viewChanged:false,startHeight:i.doc.height,forceUpdate:false,updateInput:null,typing:false,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:false,updateMaxLine:false,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:false,id:++eJ};ff(i.curOp)}function at(i){var hp=i.curOp;ce(hp,function(hr){for(var hq=0;hq<hr.ops.length;hq++){hr.ops[hq].cm.curOp=null}dc(hr)})}function dc(hu){var hq=hu.ops;for(var hp=0;hp<hq.length;hp++){cm(hq[hp])}for(var hv=0;hv<hq.length;hv++){ax(hq[hv])}for(var ht=0;ht<hq.length;ht++){ci(hq[ht])}for(var hs=0;hs<hq.length;hs++){aw(hq[hs])}for(var hr=0;hr<hq.length;hr++){fN(hq[hr])}}function cm(hq){var i=hq.cm,hp=i.display;K(i);if(hq.updateMaxLine){f(i)}hq.mustUpdate=hq.viewChanged||hq.forceUpdate||hq.scrollTop!=null||hq.scrollToPos&&(hq.scrollToPos.from.line<hp.viewFrom||hq.scrollToPos.to.line>=hp.viewTo)||hp.maxLineChanged&&i.options.lineWrapping;hq.update=hq.mustUpdate&&new aQ(i,hq.mustUpdate&&{top:hq.scrollTop,ensure:hq.scrollToPos},hq.forceUpdate)}function ax(i){i.updatedDisplay=i.mustUpdate&&D(i.cm,i.update)}function ci(hq){var i=hq.cm,hp=i.display;if(hq.updatedDisplay){bh(i)}hq.barMeasure=d7(i);if(hp.maxLineChanged&&!i.options.lineWrapping){hq.adjustWidthTo=eS(i,hp.maxLine,hp.maxLine.text.length).left+3;i.display.sizerWidth=hq.adjustWidthTo;hq.barMeasure.scrollWidth=Math.max(hp.scroller.clientWidth,hp.sizer.offsetLeft+hq.adjustWidthTo+dl(i)+i.display.barWidth);hq.maxScrollLeft=Math.max(0,hp.sizer.offsetLeft+hq.adjustWidthTo-dQ(i))}if(hq.updatedDisplay||hq.selectionChanged){hq.preparedSelection=hp.input.prepareSelection(hq.focus)}}function aw(hq){var i=hq.cm;if(hq.adjustWidthTo!=null){i.display.sizer.style.minWidth=hq.adjustWidthTo+"px";if(hq.maxScrollLeft<i.doc.scrollLeft){bT(i,Math.min(i.display.scroller.scrollLeft,hq.maxScrollLeft),true)}i.display.maxLineChanged=false}var hp=hq.focus&&hq.focus==el()&&(!document.hasFocus||document.hasFocus());if(hq.preparedSelection){i.display.input.showSelection(hq.preparedSelection,hp)}if(hq.updatedDisplay||hq.startHeight!=i.doc.height){fL(i,hq.barMeasure)}if(hq.updatedDisplay){d5(i,hq.barMeasure)}if(hq.selectionChanged){p(i)}if(i.state.focused&&hq.updateInput){i.display.input.reset(hq.typing)}if(hp){t(hq.cm)}}function fN(hs){var hx=hs.cm,hu=hx.display,hw=hx.doc;if(hs.updatedDisplay){cF(hx,hs.update)}if(hu.wheelStartX!=null&&(hs.scrollTop!=null||hs.scrollLeft!=null||hs.scrollToPos)){hu.wheelStartX=hu.wheelStartY=null}if(hs.scrollTop!=null&&(hu.scroller.scrollTop!=hs.scrollTop||hs.forceScroll)){hw.scrollTop=Math.max(0,Math.min(hu.scroller.scrollHeight-hu.scroller.clientHeight,hs.scrollTop));hu.scrollbars.setScrollTop(hw.scrollTop);hu.scroller.scrollTop=hw.scrollTop}if(hs.scrollLeft!=null&&(hu.scroller.scrollLeft!=hs.scrollLeft||hs.forceScroll)){hw.scrollLeft=Math.max(0,Math.min(hu.scroller.scrollWidth-hu.scroller.clientWidth,hs.scrollLeft));hu.scrollbars.setScrollLeft(hw.scrollLeft);hu.scroller.scrollLeft=hw.scrollLeft;fn(hx)}if(hs.scrollToPos){var hv=F(hx,gH(hw,hs.scrollToPos.from),gH(hw,hs.scrollToPos.to),hs.scrollToPos.margin);if(hs.scrollToPos.isCursor&&hx.state.focused){eF(hx,hv)}}var ht=hs.maybeHiddenMarkers,hp=hs.maybeUnhiddenMarkers;if(ht){for(var hr=0;hr<ht.length;++hr){if(!ht[hr].lines.length){aL(ht[hr],"hide")}}}if(hp){for(var hq=0;hq<hp.length;++hq){if(hp[hq].lines.length){aL(hp[hq],"unhide")}}}if(hu.wrapper.offsetHeight){hw.scrollTop=hx.display.scroller.scrollTop}if(hs.changeObjs){aL(hx,"changes",hx,hs.changeObjs)}if(hs.update){hs.update.finish()}}function de(i,hp){if(i.curOp){return hp()}da(i);try{return hp()}finally{at(i)}}function du(i,hp){return function(){if(i.curOp){return hp.apply(i,arguments)}da(i);try{return hp.apply(i,arguments)}finally{at(i)}}}function dD(i){return function(){if(this.curOp){return i.apply(this,arguments)}da(this);try{return i.apply(this,arguments)}finally{at(this)}}}function c2(i){return function(){var hp=this.cm;if(!hp||hp.curOp){return i.apply(this,arguments)}da(hp);try{return i.apply(this,arguments)}finally{at(hp)}}}function am(hw,hu,hv,hx){if(hu==null){hu=hw.doc.first}if(hv==null){hv=hw.doc.first+hw.doc.size}if(!hx){hx=0}var hr=hw.display;if(hx&&hv<hr.viewTo&&(hr.updateLineNumbers==null||hr.updateLineNumbers>hu)){hr.updateLineNumbers=hu}hw.curOp.viewChanged=true;if(hu>=hr.viewTo){if(bf&&a3(hw.doc,hu)<hr.viewTo){fc(hw)}}else{if(hv<=hr.viewFrom){if(bf&&eC(hw.doc,hv+hx)>hr.viewFrom){fc(hw)}else{hr.viewFrom+=hx;hr.viewTo+=hx}}else{if(hu<=hr.viewFrom&&hv>=hr.viewTo){fc(hw)}else{if(hu<=hr.viewFrom){var ht=dJ(hw,hv,hv+hx,1);if(ht){hr.view=hr.view.slice(ht.index);hr.viewFrom=ht.lineN;hr.viewTo+=hx}else{fc(hw)}}else{if(hv>=hr.viewTo){var hp=dJ(hw,hu,hu,-1);if(hp){hr.view=hr.view.slice(0,hp.index);hr.viewTo=hp.lineN}else{fc(hw)}}else{var hs=dJ(hw,hu,hu,-1);var hq=dJ(hw,hv,hv+hx,1);if(hs&&hq){hr.view=hr.view.slice(0,hs.index).concat(fI(hw,hs.lineN,hq.lineN)).concat(hr.view.slice(hq.index));hr.viewTo+=hx}else{fc(hw)}}}}}}var i=hr.externalMeasured;if(i){if(hv<i.lineN){i.lineN+=hx}else{if(hu<i.lineN+i.size){hr.externalMeasured=null}}}}function S(hp,hq,ht){hp.curOp.viewChanged=true;var hu=hp.display,hs=hp.display.externalMeasured;if(hs&&hq>=hs.lineN&&hq<hs.lineN+hs.size){hu.externalMeasured=null}if(hq<hu.viewFrom||hq>=hu.viewTo){return}var hr=hu.view[dV(hp,hq)];if(hr.node==null){return}var i=hr.changes||(hr.changes=[]);if(dN(i,ht)==-1){i.push(ht)}}function fc(i){i.display.viewFrom=i.display.viewTo=i.doc.first;i.display.view=[];i.display.viewOffset=0}function dJ(hx,hr,ht,hq){var hu=dV(hx,hr),hw,hv=hx.display.view;if(!bf||ht==hx.doc.first+hx.doc.size){return{index:hu,lineN:ht}}var hp=hx.display.viewFrom;for(var hs=0;hs<hu;hs++){hp+=hv[hs].size}if(hp!=hr){if(hq>0){if(hu==hv.length-1){return null}hw=(hp+hv[hu].size)-hr;hu++}else{hw=hp-hr}hr+=hw;ht+=hw}while(a3(hx.doc,ht)!=ht){if(hu==(hq<0?0:hv.length-1)){return null}ht+=hq*hv[hu-(hq<0?1:0)].size;hu+=hq}return{index:hu,lineN:ht}}function dj(i,hs,hr){var hq=i.display,hp=hq.view;if(hp.length==0||hs>=hq.viewTo||hr<=hq.viewFrom){hq.view=fI(i,hs,hr);hq.viewFrom=hs}else{if(hq.viewFrom>hs){hq.view=fI(i,hs,hq.viewFrom).concat(hq.view)}else{if(hq.viewFrom<hs){hq.view=hq.view.slice(dV(i,hs))}}hq.viewFrom=hs;if(hq.viewTo<hr){hq.view=hq.view.concat(fI(i,hq.viewTo,hr))}else{if(hq.viewTo>hr){hq.view=hq.view.slice(0,dV(i,hr))}}}hq.viewTo=hr}function dG(hp){var hq=hp.display.view,ht=0;for(var hs=0;hs<hq.length;hs++){var hr=hq[hs];if(!hr.hidden&&(!hr.node||hr.changes)){++ht}}return ht}function eO(i,hp){if(i.doc.mode.startState&&i.doc.frontier<i.display.viewTo){i.state.highlight.set(hp,cT(dh,i))}}function dh(i){var hs=i.doc;if(hs.frontier<hs.first){hs.frontier=hs.first}if(hs.frontier>=i.display.viewTo){return}var hq=+new Date+i.options.workTime;var hr=ck(hs.mode,d9(i,hs.frontier));var hp=[];hs.iter(hs.frontier,Math.min(hs.first+hs.size,i.display.viewTo+500),function(ht){if(hs.frontier>=i.display.viewFrom){var hw=ht.styles,hA=ht.text.length>i.options.maxHighlightLength;var hy=gs(i,ht,hA?ck(hs.mode,hr):hr,true);ht.styles=hy.styles;var hv=ht.styleClasses,hx=hy.classes;if(hx){ht.styleClasses=hx}else{if(hv){ht.styleClasses=null}}var hz=!hw||hw.length!=ht.styles.length||hv!=hx&&(!hv||!hx||hv.bgClass!=hx.bgClass||hv.textClass!=hx.textClass);for(var hu=0;!hz&&hu<hw.length;++hu){hz=hw[hu]!=ht.styles[hu]}if(hz){hp.push(hs.frontier)}ht.stateAfter=hA?hr:ck(hs.mode,hr)}else{if(ht.text.length<=i.options.maxHighlightLength){d4(i,ht.text,hr)}ht.stateAfter=hs.frontier%5==0?ck(hs.mode,hr):null}++hs.frontier;if(+new Date>hq){eO(i,i.options.workDelay);return true}});if(hp.length){de(i,function(){for(var ht=0;ht<hp.length;ht++){S(i,hp[ht],"text")}})}}var aQ=function aQ(hp,i,hq){var hr=hp.display;this.viewport=i;this.visible=cn(hr,hp.doc,i);this.editorIsHidden=!hr.wrapper.offsetWidth;this.wrapperHeight=hr.wrapper.clientHeight;this.wrapperWidth=hr.wrapper.clientWidth;this.oldDisplayWidth=dQ(hp);this.force=hq;this.dims=f3(hp);this.events=[]};aQ.prototype.signal=function cC(hp,i){if(gb(hp,i)){this.events.push(arguments)}};aQ.prototype.finish=function e5(){var hq=this;for(var hp=0;hp<this.events.length;hp++){aL.apply(null,hq.events[hp])}};function K(i){var hp=i.display;if(!hp.scrollbarsClipped&&hp.scroller.offsetWidth){hp.nativeBarWidth=hp.scroller.offsetWidth-hp.scroller.clientWidth;hp.heightForcer.style.height=dl(i)+"px";hp.sizer.style.marginBottom=-hp.nativeBarWidth+"px";hp.sizer.style.borderRightWidth=dl(i)+"px";hp.scrollbarsClipped=true}}function D(hx,hr){var hs=hx.display,hw=hx.doc;if(hr.editorIsHidden){fc(hx);return false}if(!hr.force&&hr.visible.from>=hs.viewFrom&&hr.visible.to<=hs.viewTo&&(hs.updateLineNumbers==null||hs.updateLineNumbers>=hs.viewTo)&&hs.renderedView==hs.view&&dG(hx)==0){return false}if(eE(hx)){fc(hx);hr.dims=f3(hx)}var hq=hw.first+hw.size;var hu=Math.max(hr.visible.from-hx.options.viewportMargin,hw.first);var hv=Math.min(hq,hr.visible.to+hx.options.viewportMargin);if(hs.viewFrom<hu&&hu-hs.viewFrom<20){hu=Math.max(hw.first,hs.viewFrom)}if(hs.viewTo>hv&&hs.viewTo-hv<20){hv=Math.min(hq,hs.viewTo)}if(bf){hu=a3(hx.doc,hu);hv=eC(hx.doc,hv)}var hp=hu!=hs.viewFrom||hv!=hs.viewTo||hs.lastWrapHeight!=hr.wrapperHeight||hs.lastWrapWidth!=hr.wrapperWidth;dj(hx,hu,hv);hs.viewOffset=b1(f5(hx.doc,hs.viewFrom));hx.display.mover.style.top=hs.viewOffset+"px";var i=dG(hx);if(!hp&&i==0&&!hr.force&&hs.renderedView==hs.view&&(hs.updateLineNumbers==null||hs.updateLineNumbers>=hs.viewTo)){return false}var ht=el();if(i>4){hs.lineDiv.style.display="none"}cJ(hx,hs.updateLineNumbers,hr.dims);if(i>4){hs.lineDiv.style.display=""}hs.renderedView=hs.view;if(ht&&el()!=ht&&ht.offsetHeight){ht.focus()}eA(hs.cursorDiv);eA(hs.selectionDiv);hs.gutters.style.height=hs.sizer.style.minHeight=0;if(hp){hs.lastWrapHeight=hr.wrapperHeight;hs.lastWrapWidth=hr.wrapperWidth;eO(hx,400)}hs.updateLineNumbers=null;return true}function cF(hp,hs){var i=hs.viewport;for(var hr=true;;hr=false){if(!hr||!hp.options.lineWrapping||hs.oldDisplayWidth==dQ(hp)){if(i&&i.top!=null){i={top:Math.min(hp.doc.height+bX(hp.display)-dn(hp),i.top)}}hs.visible=cn(hp.display,hp.doc,i);if(hs.visible.from>=hp.display.viewFrom&&hs.visible.to<=hp.display.viewTo){break}}if(!D(hp,hs)){break}bh(hp);var hq=d7(hp);bR(hp);fL(hp,hq);d5(hp,hq)}hs.signal(hp,"update",hp);if(hp.display.viewFrom!=hp.display.reportedViewFrom||hp.display.viewTo!=hp.display.reportedViewTo){hs.signal(hp,"viewportChange",hp,hp.display.viewFrom,hp.display.viewTo);hp.display.reportedViewFrom=hp.display.viewFrom;hp.display.reportedViewTo=hp.display.viewTo}}function er(hp,i){var hr=new aQ(hp,i);if(D(hp,hr)){bh(hp);cF(hp,hr);var hq=d7(hp);bR(hp);fL(hp,hq);d5(hp,hq);hr.finish()}}function cJ(hA,hr,hz){var hw=hA.display,hC=hA.options.lineNumbers;var hp=hw.lineDiv,hB=hp.firstChild;function hv(hD){var i=hD.nextSibling;if(dt&&co&&hA.display.currentWheelTarget==hD){hD.style.display="none"}else{hD.parentNode.removeChild(hD)}return i}var hx=hw.view,hu=hw.viewFrom;for(var hs=0;hs<hx.length;hs++){var ht=hx[hs];if(ht.hidden){}else{if(!ht.node||ht.node.parentNode!=hp){var hq=aM(hA,ht,hu,hz);hp.insertBefore(hq,hB)}else{while(hB!=ht.node){hB=hv(hB)}var hy=hC&&hr!=null&&hr<=hu&&ht.lineNumber;if(ht.changes){if(dN(ht.changes,"gutter")>-1){hy=false}af(hA,ht,hu,hz)}if(hy){eA(ht.lineNumber);ht.lineNumber.appendChild(document.createTextNode(e7(hA.options,hu)))}hB=ht.node.nextSibling}}hu+=ht.size}while(hB){hB=hv(hB)}}function dx(i){var hp=i.display.gutters.offsetWidth;i.display.sizer.style.marginLeft=hp+"px"}function d5(i,hp){i.display.sizer.style.minHeight=hp.docHeight+"px";i.display.heightForcer.style.top=hp.docHeight+"px";i.display.gutters.style.height=(hp.docHeight+i.display.barHeight+dl(i))+"px"}function eM(hp){var hq=hp.display.gutters,hu=hp.options.gutters;eA(hq);var hr=0;for(;hr<hu.length;++hr){var hs=hu[hr];var ht=hq.appendChild(g5("div",null,"CodeMirror-gutter "+hs));if(hs=="CodeMirror-linenumbers"){hp.display.lineGutter=ht;ht.style.width=(hp.display.lineNumWidth||1)+"px"}}hq.style.display=hr?"":"none";dx(hp)}function cz(i){var hp=dN(i.gutters,"CodeMirror-linenumbers");if(hp==-1&&i.lineNumbers){i.gutters=i.gutters.concat(["CodeMirror-linenumbers"])}else{if(hp>-1&&!i.lineNumbers){i.gutters=i.gutters.slice(0);i.gutters.splice(hp,1)}}}function g4(i,hp){this.ranges=i;this.primIndex=hp}g4.prototype={primary:function(){return this.ranges[this.primIndex]},equals:function(hp){var ht=this;if(hp==this){return true}if(hp.primIndex!=this.primIndex||hp.ranges.length!=this.ranges.length){return false}for(var hr=0;hr<this.ranges.length;hr++){var hq=ht.ranges[hr],hs=hp.ranges[hr];if(cA(hq.anchor,hs.anchor)!=0||cA(hq.head,hs.head)!=0){return false}}return true},deepCopy:function(){var hr=this;var hp=[];for(var hq=0;hq<this.ranges.length;hq++){hp[hq]=new ev(cE(hr.ranges[hq].anchor),cE(hr.ranges[hq].head))}return new g4(hp,this.primIndex)},somethingSelected:function(){var hq=this;for(var hp=0;hp<this.ranges.length;hp++){if(!hq.ranges[hp].empty()){return true}}return false},contains:function(ht,hp){var hs=this;if(!hp){hp=ht}for(var hr=0;hr<this.ranges.length;hr++){var hq=hs.ranges[hr];if(cA(hp,hq.from())>=0&&cA(ht,hq.to())<=0){return hr}}return -1}};function ev(i,hp){this.anchor=i;this.head=hp}ev.prototype={from:function(){return ay(this.anchor,this.head)},to:function(){return bM(this.anchor,this.head)},empty:function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch}};function cV(hp,hw){var hr=hp[hw];hp.sort(function(hy,i){return cA(hy.from(),i.from())});hw=dN(hp,hr);for(var ht=1;ht<hp.length;ht++){var hx=hp[ht],hq=hp[ht-1];if(cA(hq.to(),hx.from())>=0){var hu=ay(hq.from(),hx.from()),hv=bM(hq.to(),hx.to());var hs=hq.empty()?hx.from()==hx.head:hq.from()==hq.head;if(ht<=hw){--hw}hp.splice(--ht,2,new ev(hs?hv:hu,hs?hu:hv))}}return new g4(hp,hw)}function fD(i,hp){return new g4([new ev(i,hp||i)],0)}function dq(i){if(!i.text){return i.to}return Y(i.from.line+i.text.length-1,gB(i.text).length+(i.text.length==1?i.from.ch:0))}function cg(hr,hq){if(cA(hr,hq.from)<0){return hr}if(cA(hr,hq.to)<=0){return dq(hq)}var i=hr.line+hq.text.length-(hq.to.line-hq.from.line)-1,hp=hr.ch;if(hr.line==hq.to.line){hp+=dq(hq).ch-hq.to.ch}return Y(i,hp)}function ga(hs,ht){var hq=[];for(var hr=0;hr<hs.sel.ranges.length;hr++){var hp=hs.sel.ranges[hr];hq.push(new ev(cg(hp.anchor,ht),cg(hp.head,ht)))}return cV(hq,hs.sel.primIndex)}function bH(hq,hp,i){if(hq.line==hp.line){return Y(i.line,hq.ch-hp.ch+i.ch)}else{return Y(i.line+(hq.line-hp.line),hq.ch)}}function aj(hz,hw,hq){var hr=[];var hp=Y(hz.first,0),hA=hp;for(var ht=0;ht<hw.length;ht++){var hv=hw[ht];var hy=bH(hv.from,hp,hA);var hx=bH(dq(hv),hp,hA);hp=hv.to;hA=hx;if(hq=="around"){var hu=hz.sel.ranges[ht],hs=cA(hu.head,hu.anchor)<0;hr[ht]=new ev(hs?hx:hy,hs?hy:hx)}else{hr[ht]=new ev(hy,hy)}}return new g4(hr,hz.sel.primIndex)}function bE(i){i.doc.mode=gu(i.options,i.doc.modeOption);eY(i)}function eY(i){i.doc.iter(function(hp){if(hp.stateAfter){hp.stateAfter=null}if(hp.styles){hp.styles=null}});i.doc.frontier=i.doc.first;eO(i,100);i.state.modeGen++;if(i.curOp){am(i)}}function eq(i,hp){return hp.from.ch==0&&hp.to.ch==0&&gB(hp.text)==""&&(!i.cm||i.cm.options.wholeLineUpdateBefore)}function gr(hF,hy,hs,hx){function hr(hG){return hs?hs[hG]:null}function hw(hG,hI,hH){e0(hG,hI,hH,hx);ai(hG,"change",hG,hy)}function hC(hJ,hH){var hG=[];for(var hI=hJ;hI<hH;++hI){hG.push(new g8(hA[hI],hr(hI),hx))}return hG}var hD=hy.from,hp=hy.to,hA=hy.text;var hz=f5(hF,hD.line),i=f5(hF,hp.line);var hq=gB(hA),hE=hr(hA.length-1),hB=hp.line-hD.line;if(hy.full){hF.insert(0,hC(0,hA.length));hF.remove(hA.length,hF.size-hA.length)}else{if(eq(hF,hy)){var hv=hC(0,hA.length-1);hw(i,i.text,hE);if(hB){hF.remove(hD.line,hB)}if(hv.length){hF.insert(hD.line,hv)}}else{if(hz==i){if(hA.length==1){hw(hz,hz.text.slice(0,hD.ch)+hq+hz.text.slice(hp.ch),hE)}else{var hu=hC(1,hA.length-1);hu.push(new g8(hq+hz.text.slice(hp.ch),hE,hx));hw(hz,hz.text.slice(0,hD.ch)+hA[0],hr(0));hF.insert(hD.line+1,hu)}}else{if(hA.length==1){hw(hz,hz.text.slice(0,hD.ch)+hA[0]+i.text.slice(hp.ch),hr(0));hF.remove(hD.line+1,hB)}else{hw(hz,hz.text.slice(0,hD.ch)+hA[0],hr(0));hw(i,hq+i.text.slice(hp.ch),hE);var ht=hC(1,hA.length-1);if(hB>1){hF.remove(hD.line+1,hB-1)}hF.insert(hD.line+1,ht)}}}}ai(hF,"change",hF,hy)}function eG(hr,hq,hp){function i(hx,hv,ht){if(hx.linked){for(var hu=0;hu<hx.linked.length;++hu){var hs=hx.linked[hu];if(hs.doc==hv){continue}var hw=ht&&hs.sharedHist;if(hp&&!hw){continue}hq(hs.doc,hw);i(hs.doc,hx,hw)}}}i(hr,null,true)}function eL(i,hp){if(hp.cm){throw new Error("This document is already in use.")}i.doc=hp;hp.cm=i;aa(i);bE(i);if(!i.options.lineWrapping){f(i)}i.options.mode=hp.modeOption;am(i)}function gU(i){this.done=[];this.undone=[];this.undoDepth=Infinity;this.lastModTime=this.lastSelTime=0;this.lastOp=this.lastSelOp=null;this.lastOrigin=this.lastSelOrigin=null;this.generation=this.maxGeneration=i||1}function d1(i,hq){var hp={from:cE(hq.from),to:dq(hq),text:g6(i,hq.from,hq.to)};cf(i,hp,hq.from.line,hq.to.line+1);eG(i,function(hr){return cf(hr,hp,hq.from.line,hq.to.line+1)},true);return hp}function gw(hp){while(hp.length){var i=gB(hp);if(i.ranges){hp.pop()}else{break}}}function fx(hp,i){if(i){gw(hp.done);return gB(hp.done)}else{if(hp.done.length&&!gB(hp.done).ranges){return gB(hp.done)}else{if(hp.done.length>1&&!hp.done[hp.done.length-2].ranges){hp.done.pop();return gB(hp.done)}}}}function gJ(hu,hs,i,hr){var hq=hu.history;hq.undone.length=0;var hp=+new Date,hv;var hw;if((hq.lastOp==hr||hq.lastOrigin==hs.origin&&hs.origin&&((hs.origin.charAt(0)=="+"&&hu.cm&&hq.lastModTime>hp-hu.cm.options.historyEventDelay)||hs.origin.charAt(0)=="*"))&&(hv=fx(hq,hq.lastOp==hr))){hw=gB(hv.changes);if(cA(hs.from,hs.to)==0&&cA(hs.from,hw.to)==0){hw.to=dq(hs)}else{hv.changes.push(d1(hu,hs))}}else{var ht=gB(hq.done);if(!ht||!ht.ranges){dg(hu.sel,hq.done)}hv={changes:[d1(hu,hs)],generation:hq.generation};hq.done.push(hv);while(hq.done.length>hq.undoDepth){hq.done.shift();if(!hq.done[0].ranges){hq.done.shift()}}}hq.done.push(i);hq.generation=++hq.maxGeneration;hq.lastModTime=hq.lastSelTime=hp;hq.lastOp=hq.lastSelOp=hr;hq.lastOrigin=hq.lastSelOrigin=hs.origin;if(!hw){aL(hu,"historyAdded")}}function bP(hs,i,hq,hr){var hp=i.charAt(0);return hp=="*"||hp=="+"&&hq.ranges.length==hr.ranges.length&&hq.somethingSelected()==hr.somethingSelected()&&new Date-hs.history.lastSelTime<=(hs.cm?hs.cm.options.historyEventDelay:500)}function hg(ht,hr,i,hq){var hs=ht.history,hp=hq&&hq.origin;if(i==hs.lastSelOp||(hp&&hs.lastSelOrigin==hp&&(hs.lastModTime==hs.lastSelTime&&hs.lastOrigin==hp||bP(ht,hp,gB(hs.done),hr)))){hs.done[hs.done.length-1]=hr}else{dg(hr,hs.done)}hs.lastSelTime=+new Date;hs.lastSelOrigin=hp;hs.lastSelOp=i;if(hq&&hq.clearRedo!==false){gw(hs.undone)}}function dg(hp,i){var hq=gB(i);if(!(hq&&hq.ranges&&hq.equals(hp))){i.push(hp)}}function cf(hp,ht,hs,hr){var i=ht["spans_"+hp.id],hq=0;hp.iter(Math.max(hp.first,hs),Math.min(hp.first+hp.size,hr),function(hu){if(hu.markedSpans){(i||(i=ht["spans_"+hp.id]={}))[hq]=hu.markedSpans}++hq})}function bu(hr){if(!hr){return null}var hp;for(var hq=0;hq<hr.length;++hq){if(hr[hq].marker.explicitlyCleared){if(!hp){hp=hr.slice(0,hq)}}else{if(hp){hp.push(hr[hq])}}}return !hp?hr:hp.length?hp:null}function cl(hs,ht){var hr=ht["spans_"+hs.id];if(!hr){return null}var hp=[];for(var hq=0;hq<ht.text.length;++hq){hp.push(bu(hr[hq]))}return hp}function eI(hx,hv){var hp=cl(hx,hv);var hy=eV(hx,hv);if(!hp){return hy}if(!hy){return hp}for(var hs=0;hs<hp.length;++hs){var ht=hp[hs],hu=hy[hs];if(ht&&hu){spans:for(var hr=0;hr<hu.length;++hr){var hw=hu[hr];for(var hq=0;hq<ht.length;++hq){if(ht[hq].marker==hw.marker){continue spans}}ht.push(hw)}}else{if(hu){hp[hs]=hu}}}return hp}function b4(hA,hs,hz){var hq=[];for(var hv=0;hv<hA.length;++hv){var hr=hA[hv];if(hr.ranges){hq.push(hz?g4.prototype.deepCopy.call(hr):hr);continue}var hx=hr.changes,hy=[];hq.push({changes:hy});for(var hu=0;hu<hx.length;++hu){var hw=hx[hu],ht=void 0;hy.push({from:hw.from,to:hw.to,text:hw.text});if(hs){for(var hp in hw){if(ht=hp.match(/^spans_(\d+)$/)){if(dN(hs,Number(ht[1]))>-1){gB(hy)[hp]=hw[hp];delete hw[hp]}}}}}}return hq}function gl(ht,hp,hs,i){if(ht.cm&&ht.cm.display.shift||ht.extend){var hr=hp.anchor;if(i){var hq=cA(hs,hr)<0;if(hq!=(cA(i,hr)<0)){hr=hs;hs=i}else{if(hq!=(cA(hs,i)<0)){hs=i}}}return new ev(hr,hs)}else{return new ev(i||hs,hs)}}function gZ(hr,hq,i,hp){b9(hr,new g4([gl(hr,hr.sel.primary(),hq,i)],0),hp)}function aC(hu,ht,hr){var hq=[];for(var hs=0;hs<hu.sel.ranges.length;hs++){hq[hs]=gl(hu,hu.sel.ranges[hs],ht[hs],null)}var hp=cV(hq,hu.sel.primIndex);b9(hu,hp,hr)}function e(ht,hs,hq,hr){var hp=ht.sel.ranges.slice(0);hp[hs]=hq;b9(ht,cV(hp,ht.sel.primIndex),hr)}function H(hr,hp,hq,i){b9(hr,fD(hp,hq),i)}function b(hr,hp,i){var hq={ranges:hp.ranges,update:function(hs){var hu=this;this.ranges=[];for(var ht=0;ht<hs.length;ht++){hu.ranges[ht]=new ev(gH(hr,hs[ht].anchor),gH(hr,hs[ht].head))}},origin:i&&i.origin};aL(hr,"beforeSelectionChange",hr,hq);if(hr.cm){aL(hr.cm,"beforeSelectionChange",hr.cm,hq)}if(hq.ranges!=hp.ranges){return cV(hq.ranges,hq.ranges.length-1)}else{return hp}}function fY(hs,hr,hp){var i=hs.history.done,hq=gB(i);if(hq&&hq.ranges){i[i.length-1]=hr;e2(hs,hr,hp)}else{b9(hs,hr,hp)}}function b9(hq,hp,i){e2(hq,hp,i);hg(hq,hq.sel,hq.cm?hq.cm.curOp.id:NaN,i)}function e2(hr,hq,hp){if(gb(hr,"beforeSelectionChange")||hr.cm&&gb(hr.cm,"beforeSelectionChange")){hq=b(hr,hq,hp)}var i=hp&&hp.bias||(cA(hq.primary().head,hr.sel.primary().head)<0?-1:1);dC(hr,o(hr,hq,i,true));if(!(hp&&hp.scroll===false)&&hr.cm){gA(hr.cm)}}function dC(hp,i){if(i.equals(hp.sel)){return}hp.sel=i;if(hp.cm){hp.cm.curOp.updateInput=hp.cm.curOp.selectionChanged=true;X(hp.cm)}ai(hp,"cursorActivity",hp)}function fd(i){dC(i,o(i,i.sel,null,false),ab)}function o(hy,hp,hv,hw){var hs;for(var ht=0;ht<hp.ranges.length;ht++){var hu=hp.ranges[ht];var hq=hp.ranges.length==hy.sel.ranges.length&&hy.sel.ranges[ht];var hx=cb(hy,hu.anchor,hq&&hq.anchor,hv,hw);var hr=cb(hy,hu.head,hq&&hq.head,hv,hw);if(hs||hx!=hu.anchor||hr!=hu.head){if(!hs){hs=hp.ranges.slice(0,ht)}hs[ht]=new ev(hx,hr)}}return hs?cV(hs,hp.primIndex):hp}function ft(hz,hx,hs,hr,hv){var hA=f5(hz,hx.line);if(hA.markedSpans){for(var ht=0;ht<hA.markedSpans.length;++ht){var hp=hA.markedSpans[ht],hq=hp.marker;if((hp.from==null||(hq.inclusiveLeft?hp.from<=hx.ch:hp.from<hx.ch))&&(hp.to==null||(hq.inclusiveRight?hp.to>=hx.ch:hp.to>hx.ch))){if(hv){aL(hq,"beforeCursorEnter");if(hq.explicitlyCleared){if(!hA.markedSpans){break}else{--ht;continue}}}if(!hq.atomic){continue}if(hs){var hw=hq.find(hr<0?1:-1),hy=void 0;if(hr<0?hq.inclusiveRight:hq.inclusiveLeft){hw=hk(hz,hw,-hr,hw&&hw.line==hx.line?hA:null)}if(hw&&hw.line==hx.line&&(hy=cA(hw,hs))&&(hr<0?hy<0:hy>0)){return ft(hz,hw,hx,hr,hv)}}var hu=hq.find(hr<0?-1:1);if(hr<0?hq.inclusiveLeft:hq.inclusiveRight){hu=hk(hz,hu,hr,hu.line==hx.line?hA:null)}return hu?ft(hz,hu,hx,hr,hv):null}}}return hx}function cb(ht,hu,hr,hp,i){var hq=hp||1;var hs=ft(ht,hu,hr,hq,i)||(!i&&ft(ht,hu,hr,hq,true))||ft(ht,hu,hr,-hq,i)||(!i&&ft(ht,hu,hr,-hq,true));if(!hs){ht.cantEdit=true;return Y(ht.first,0)}return hs}function hk(hq,hr,hp,i){if(hp<0&&hr.ch==0){if(hr.line>hq.first){return gH(hq,Y(hr.line-1))}else{return null}}else{if(hp>0&&hr.ch==(i||f5(hq,hr.line)).text.length){if(hr.line<hq.first+hq.size-1){return Y(hr.line+1,0)}else{return null}}else{return new Y(hr.line,hr.ch+hp)}}}function aq(i){i.setSelection(Y(i.firstLine(),0),Y(i.lastLine()),ab)}function eo(hp,hr,hq){var i={canceled:false,from:hr.from,to:hr.to,text:hr.text,origin:hr.origin,cancel:function(){return i.canceled=true}};if(hq){i.update=function(hv,hu,ht,hs){if(hv){i.from=gH(hp,hv)}if(hu){i.to=gH(hp,hu)}if(ht){i.text=ht}if(hs!==undefined){i.origin=hs}}}aL(hp,"beforeChange",hp,i);if(hp.cm){aL(hp.cm,"beforeChange",hp.cm,i)}if(i.canceled){return null}return{from:i.from,to:i.to,text:i.text,origin:i.origin}}function bp(hs,ht,hr){if(hs.cm){if(!hs.cm.curOp){return du(hs.cm,bp)(hs,ht,hr)}if(hs.cm.state.suppressEdits){return}}if(gb(hs,"beforeChange")||hs.cm&&gb(hs.cm,"beforeChange")){ht=eo(hs,ht,true);if(!ht){return}}var hq=hh&&!hr&&c9(hs,ht.from,ht.to);if(hq){for(var hp=hq.length-1;hp>=0;--hp){L(hs,{from:hq[hp].from,to:hq[hp].to,text:hp?[""]:ht.text})}}else{L(hs,ht)}}function L(hq,hr){if(hr.text.length==1&&hr.text[0]==""&&cA(hr.from,hr.to)==0){return}var hp=ga(hq,hr);gJ(hq,hr,hp,hq.cm?hq.cm.curOp.id:NaN);eN(hq,hr,hp,eV(hq,hr));var i=[];eG(hq,function(ht,hs){if(!hs&&dN(i,ht.history)==-1){eb(ht.history,hr);i.push(ht.history)}eN(ht,hr,null,eV(ht,hr))})}function cp(hA,hz,hC){if(hA.cm&&hA.cm.state.suppressEdits&&!hC){return}var hy=hA.history,hq,hs=hA.sel;var hp=hz=="undo"?hy.done:hy.undone,hB=hz=="undo"?hy.undone:hy.done;var hv=0;for(;hv<hp.length;hv++){hq=hp[hv];if(hC?hq.ranges&&!hq.equals(hA.sel):!hq.ranges){break}}if(hv==hp.length){return}hy.lastOrigin=hy.lastSelOrigin=null;for(;;){hq=hp.pop();if(hq.ranges){dg(hq,hB);if(hC&&!hq.equals(hA.sel)){b9(hA,hq,{clearRedo:false});return}hs=hq}else{break}}var hx=[];dg(hs,hB);hB.push({changes:hx,generation:hy.generation});hy.generation=hq.generation||++hy.maxGeneration;var hr=gb(hA,"beforeChange")||hA.cm&&gb(hA.cm,"beforeChange");var hw=function(hD){var hG=hq.changes[hD];hG.origin=hz;if(hr&&!eo(hA,hG,false)){hp.length=0;return{}}hx.push(d1(hA,hG));var hF=hD?ga(hA,hG):gB(hp);eN(hA,hG,hF,eI(hA,hG));if(!hD&&hA.cm){hA.cm.scrollIntoView({from:hG.from,to:dq(hG)})}var hE=[];eG(hA,function(hH,i){if(!i&&dN(hE,hH.history)==-1){eb(hH.history,hG);hE.push(hH.history)}eN(hH,hG,null,eI(hH,hG))})};for(var ht=hq.changes.length-1;ht>=0;--ht){var hu=hw(ht);if(hu){return hu.v}}}function ge(hp,hr){if(hr==0){return}hp.first+=hr;hp.sel=new g4(b8(hp.sel.ranges,function(hs){return new ev(Y(hs.anchor.line+hr,hs.anchor.ch),Y(hs.head.line+hr,hs.head.ch))}),hp.sel.primIndex);if(hp.cm){am(hp.cm,hp.first,hp.first-hr,hr);for(var hq=hp.cm.display,i=hq.viewFrom;i<hq.viewTo;i++){S(hp.cm,i,"gutter")}}}function eN(hs,ht,hr,hp){if(hs.cm&&!hs.cm.curOp){return du(hs.cm,eN)(hs,ht,hr,hp)}if(ht.to.line<hs.first){ge(hs,ht.text.length-1-(ht.to.line-ht.from.line));return}if(ht.from.line>hs.lastLine()){return}if(ht.from.line<hs.first){var i=ht.text.length-1-(hs.first-ht.from.line);ge(hs,i);ht={from:Y(hs.first,0),to:Y(ht.to.line+i,ht.to.ch),text:[gB(ht.text)],origin:ht.origin}}var hq=hs.lastLine();if(ht.to.line>hq){ht={from:ht.from,to:Y(hq,f5(hs,hq).text.length),text:[ht.text[0]],origin:ht.origin}}ht.removed=g6(hs,ht.from,ht.to);if(!hr){hr=ga(hs,ht)}if(hs.cm){aP(hs.cm,ht,hp)}else{gr(hs,ht,hp)}e2(hs,hr,ab)}function aP(hz,hv,ht){var hy=hz.doc,hu=hz.display,hw=hv.from,hx=hv.to;var i=false,hs=hw.line;if(!hz.options.lineWrapping){hs=b2(z(f5(hy,hw.line)));hy.iter(hs,hx.line+1,function(hB){if(hB==hu.maxLine){i=true;return true}})}if(hy.sel.contains(hv.from,hv.to)>-1){X(hz)}gr(hy,hv,ht,bn(hz));if(!hz.options.lineWrapping){hy.iter(hs,hw.line+hv.text.length,function(hC){var hB=eZ(hC);if(hB>hu.maxLineLength){hu.maxLine=hC;hu.maxLineLength=hB;hu.maxLineChanged=true;i=false}});if(i){hz.curOp.updateMaxLine=true}}hy.frontier=Math.min(hy.frontier,hw.line);eO(hz,400);var hA=hv.text.length-(hx.line-hw.line)-1;if(hv.full){am(hz)}else{if(hw.line==hx.line&&hv.text.length==1&&!eq(hz.doc,hv)){S(hz,hw.line,"text")}else{am(hz,hw.line,hx.line+1,hA)}}var hq=gb(hz,"changes"),hr=gb(hz,"change");if(hr||hq){var hp={from:hw,to:hx,text:hv.text,removed:hv.removed,origin:hv.origin};if(hr){ai(hz,"change",hz,hp)}if(hq){(hz.curOp.changeObjs||(hz.curOp.changeObjs=[])).push(hp)}}hz.display.selForContextMenu=null}function a9(hr,hq,ht,hs,i){if(!hs){hs=ht}if(cA(hs,ht)<0){var hp=hs;hs=ht;ht=hp}if(typeof hq=="string"){hq=hr.splitLines(hq)}bp(hr,{from:ht,to:hs,text:hq,origin:i})}function J(hr,hq,hp,i){if(hp<hr.line){hr.line+=i}else{if(hq<hr.line){hr.line=hq;hr.ch=0}}}function f8(ht,hv,hw,hx){for(var hs=0;hs<ht.length;++hs){var hp=ht[hs],hu=true;if(hp.ranges){if(!hp.copied){hp=ht[hs]=hp.deepCopy();hp.copied=true}for(var hr=0;hr<hp.ranges.length;hr++){J(hp.ranges[hr].anchor,hv,hw,hx);J(hp.ranges[hr].head,hv,hw,hx)}continue}for(var hq=0;hq<hp.changes.length;++hq){var hy=hp.changes[hq];if(hw<hy.from.line){hy.from=Y(hy.from.line+hx,hy.from.ch);hy.to=Y(hy.to.line+hx,hy.to.ch)}else{if(hv<=hy.to.line){hu=false;break}}}if(!hu){ht.splice(0,hs+1);hs=0}}}function eb(hp,hs){var hr=hs.from.line,hq=hs.to.line,i=hs.text.length-(hq-hr)-1;f8(hp.done,hr,hq,i);f8(hp.undone,hr,hq,i)}function fg(hr,hq,i,ht){var hs=hq,hp=hq;if(typeof hq=="number"){hp=f5(hr,dy(hr,hq))}else{hs=b2(hq)}if(hs==null){return null}if(ht(hp,hs)&&hr.cm){S(hr.cm,hs,i)}return hp}function fM(hq){var hs=this;this.lines=hq;this.parent=null;var hp=0;for(var hr=0;hr<hq.length;++hr){hq[hr].parent=hs;hp+=hq[hr].height}this.height=hp}fM.prototype={chunkSize:function(){return this.lines.length},removeInner:function(hp,hu){var ht=this;for(var hr=hp,hs=hp+hu;hr<hs;++hr){var hq=ht.lines[hr];ht.height-=hq.height;bQ(hq);ai(hq,"delete")}this.lines.splice(hp,hu)},collapse:function(i){i.push.apply(i,this.lines)},insertInner:function(hq,hr,hp){var ht=this;this.height+=hp;this.lines=this.lines.slice(0,hq).concat(hr).concat(this.lines.slice(hq));for(var hs=0;hs<hr.length;++hs){hr[hs].parent=ht}},iterN:function(i,hs,hr){var hq=this;for(var hp=i+hs;i<hp;++i){if(hr(hq.lines[i])){return true}}}};function gp(hs){var hu=this;this.children=hs;var hr=0,hp=0;for(var hq=0;hq<hs.length;++hq){var ht=hs[hq];hr+=ht.chunkSize();hp+=ht.height;ht.parent=hu}this.size=hr;this.height=hp;this.parent=null}gp.prototype={chunkSize:function(){return this.size},removeInner:function(hr,hq){var ht=this;this.size-=hq;for(var hs=0;hs<this.children.length;++hs){var hp=ht.children[hs],hv=hp.chunkSize();if(hr<hv){var hu=Math.min(hq,hv-hr),hw=hp.height;hp.removeInner(hr,hu);ht.height-=hw-hp.height;if(hv==hu){ht.children.splice(hs--,1);hp.parent=null}if((hq-=hu)==0){break}hr=0}else{hr-=hv}}if(this.size-hq<25&&(this.children.length>1||!(this.children[0] instanceof fM))){var hx=[];this.collapse(hx);this.children=[new fM(hx)];this.children[0].parent=this}},collapse:function(hp){var hr=this;for(var hq=0;hq<this.children.length;++hq){hr.children[hq].collapse(hp)}},insertInner:function(hq,hy,hx){var ht=this;this.size+=hy.length;this.height+=hx;for(var hs=0;hs<this.children.length;++hs){var hp=ht.children[hs],hv=hp.chunkSize();if(hq<=hv){hp.insertInner(hq,hy,hx);if(hp.lines&&hp.lines.length>50){var hr=hp.lines.length%25+25;for(var hw=hr;hw<hp.lines.length;){var hu=new fM(hp.lines.slice(hw,hw+=25));hp.height-=hu.height;ht.children.splice(++hs,0,hu);hu.parent=ht}hp.lines=hp.lines.slice(0,hr);ht.maybeSpill()}break}hq-=hv}},maybeSpill:function(){if(this.children.length<=10){return}var hr=this;do{var hp=hr.children.splice(hr.children.length-5,5);var hq=new gp(hp);if(!hr.parent){var hs=new gp(hr.children);hs.parent=hr;hr.children=[hs,hq];hr=hs}else{hr.size-=hq.size;hr.height-=hq.height;var i=dN(hr.parent.children,hr);hr.parent.children.splice(i+1,0,hq)}hq.parent=hr.parent}while(hr.children.length>10);hr.parent.maybeSpill()},iterN:function(hp,hw,hv){var hu=this;for(var hq=0;hq<this.children.length;++hq){var ht=hu.children[hq],hs=ht.chunkSize();if(hp<hs){var hr=Math.min(hw,hs-hp);if(ht.iterN(hp,hr,hv)){return true}if((hw-=hr)==0){break}hp=0}else{hp-=hs}}}};function d8(hr,hq,i){var hs=this;if(i){for(var hp in i){if(i.hasOwnProperty(hp)){hs[hp]=i[hp]}}}this.doc=hr;this.node=hq}bO(d8);function ex(i,hp,hq){if(b1(hp)<((i.curOp&&i.curOp.scrollTop)||i.doc.scrollTop)){dd(i,null,hq)}}d8.prototype.clear=function(){var hv=this;var hq=this.doc.cm,hs=this.line.widgets,hr=this.line,hu=b2(hr);if(hu==null||!hs){return}for(var ht=0;ht<hs.length;++ht){if(hs[ht]==hv){hs.splice(ht--,1)}}if(!hs.length){hr.widgets=null}var hp=dr(this);g9(hr,Math.max(0,hr.height-hp));if(hq){de(hq,function(){ex(hq,hr,-hp);S(hq,hu,"widget")})}};d8.prototype.changed=function(){var hp=this.height,i=this.doc.cm,hq=this.line;this.height=null;var hr=dr(this)-hp;if(!hr){return}g9(hq,hq.height+hr);if(i){de(i,function(){i.curOp.forceUpdate=true;ex(i,hq,hr)})}};function bV(ht,hs,hq,hp){var hr=new d8(ht,hq,hp);var i=ht.cm;if(i&&hr.noHScroll){i.display.alignWidgets=true}fg(ht,hs,"widget",function(hv){var hw=hv.widgets||(hv.widgets=[]);if(hr.insertAt==null){hw.push(hr)}else{hw.splice(Math.min(hw.length-1,Math.max(0,hr.insertAt)),0,hr)}hr.line=hv;if(i&&!gm(ht,hv)){var hu=b1(hv)<ht.scrollTop;g9(hv,hv.height+dr(hr));if(hu){dd(i,null,hr.height)}i.curOp.forceUpdate=true}return true});return hr}var bc=0;function R(hp,i){this.lines=[];this.type=i;this.doc=hp;this.id=++bc}bO(R);R.prototype.clear=function(){var hu=this;if(this.explicitlyCleared){return}var hy=this.doc.cm,hr=hy&&!hy.curOp;if(hr){da(hy)}if(gb(this,"clear")){var hz=this.find();if(hz){ai(this,"clear",hz.from,hz.to)}}var hs=null,hw=null;for(var ht=0;ht<this.lines.length;++ht){var hA=hu.lines[ht];var hx=f0(hA.markedSpans,hu);if(hy&&!hu.collapsed){S(hy,b2(hA),"text")}else{if(hy){if(hx.to!=null){hw=b2(hA)}if(hx.from!=null){hs=b2(hA)}}}hA.markedSpans=fr(hA.markedSpans,hx);if(hx.from==null&&hu.collapsed&&!gm(hu.doc,hA)&&hy){g9(hA,a6(hy.display))}}if(hy&&this.collapsed&&!hy.options.lineWrapping){for(var hq=0;hq<this.lines.length;++hq){var hp=z(hu.lines[hq]),hv=eZ(hp);if(hv>hy.display.maxLineLength){hy.display.maxLine=hp;hy.display.maxLineLength=hv;hy.display.maxLineChanged=true}}}if(hs!=null&&hy&&this.collapsed){am(hy,hs,hw+1)}this.lines.length=0;this.explicitlyCleared=true;if(this.atomic&&this.doc.cantEdit){this.doc.cantEdit=false;if(hy){fd(hy.doc)}}if(hy){ai(hy,"markerCleared",hy,this)}if(hr){at(hy)}if(this.parent){this.parent.clear()}};R.prototype.find=function(hs,hq){var hw=this;if(hs==null&&this.type=="bookmark"){hs=1}var hv,hu;for(var hr=0;hr<this.lines.length;++hr){var hp=hw.lines[hr];var ht=f0(hp.markedSpans,hw);if(ht.from!=null){hv=Y(hq?hp:b2(hp),ht.from);if(hs==-1){return hv}}if(ht.to!=null){hu=Y(hq?hp:b2(hp),ht.to);if(hs==1){return hu}}}return hv&&{from:hv,to:hu}};R.prototype.changed=function(){var hq=this.find(-1,true),hp=this,i=this.doc.cm;if(!hq||!i){return}de(i,function(){var hs=hq.line,ht=b2(hq.line);var hr=f2(i,ht);if(hr){aB(hr);i.curOp.selectionChanged=i.curOp.forceUpdate=true}i.curOp.updateMaxLine=true;if(!gm(hp.doc,hs)&&hp.height!=null){var hv=hp.height;hp.height=null;var hu=dr(hp)-hv;if(hu){g9(hs,hs.height+hu)}}})};R.prototype.attachLine=function(i){if(!this.lines.length&&this.doc.cm){var hp=this.doc.cm.curOp;if(!hp.maybeHiddenMarkers||dN(hp.maybeHiddenMarkers,this)==-1){(hp.maybeUnhiddenMarkers||(hp.maybeUnhiddenMarkers=[])).push(this)}}this.lines.push(i)};R.prototype.detachLine=function(i){this.lines.splice(dN(this.lines,i),1);if(!this.lines.length&&this.doc.cm){var hp=this.doc.cm.curOp;(hp.maybeHiddenMarkers||(hp.maybeHiddenMarkers=[])).push(this)}};function fo(hx,hv,hw,hz,ht){if(hz&&hz.shared){return O(hx,hv,hw,hz,ht)}if(hx.cm&&!hx.cm.curOp){return du(hx.cm,fo)(hx,hv,hw,hz,ht)}var hs=new R(hx,ht),hy=cA(hv,hw);if(hz){aU(hz,hs,false)}if(hy>0||hy==0&&hs.clearWhenEmpty!==false){return hs}if(hs.replacedWith){hs.collapsed=true;hs.widgetNode=g5("span",[hs.replacedWith],"CodeMirror-widget");if(!hz.handleMouseEvents){hs.widgetNode.setAttribute("cm-ignore-events","true")}if(hz.insertLeft){hs.widgetNode.insertLeft=true}}if(hs.collapsed){if(A(hx,hv.line,hv,hw,hs)||hv.line!=hw.line&&A(hx,hw.line,hv,hw,hs)){throw new Error("Inserting collapsed marker partially overlapping an existing one")}bL()}if(hs.addToHistory){gJ(hx,{from:hv,to:hw,origin:"markText"},hx.sel,NaN)}var hq=hv.line,hu=hx.cm,hp;hx.iter(hq,hw.line+1,function(i){if(hu&&hs.collapsed&&!hu.options.lineWrapping&&z(i)==hu.display.maxLine){hp=true}if(hs.collapsed&&hq!=hv.line){g9(i,0)}cy(i,new eU(hs,hq==hv.line?hv.ch:null,hq==hw.line?hw.ch:null));++hq});if(hs.collapsed){hx.iter(hv.line,hw.line+1,function(i){if(gm(hx,i)){g9(i,0)}})}if(hs.clearOnEnter){cd(hs,"beforeCursorEnter",function(){return hs.clear()})}if(hs.readOnly){gt();if(hx.history.done.length||hx.history.undone.length){hx.clearHistory()}}if(hs.collapsed){hs.id=++bc;hs.atomic=true}if(hu){if(hp){hu.curOp.updateMaxLine=true}if(hs.collapsed){am(hu,hv.line,hw.line+1)}else{if(hs.className||hs.title||hs.startStyle||hs.endStyle||hs.css){for(var hr=hv.line;hr<=hw.line;hr++){S(hu,hr,"text")}}}if(hs.atomic){fd(hu.doc)}ai(hu,"markerAdded",hu,hs)}return hs}function y(hr,hq){var hs=this;this.markers=hr;this.primary=hq;for(var hp=0;hp<hr.length;++hp){hr[hp].parent=hs}}bO(y);y.prototype.clear=function(){var hq=this;if(this.explicitlyCleared){return}this.explicitlyCleared=true;for(var hp=0;hp<this.markers.length;++hp){hq.markers[hp].clear()}ai(this,"clear")};y.prototype.find=function(hp,i){return this.primary.find(hp,i)};function O(hs,hv,hu,i,hq){i=aU(i);i.shared=false;var ht=[fo(hs,hv,hu,i,hq)],hp=ht[0];var hr=i.widgetNode;eG(hs,function(hx){if(hr){i.widgetNode=hr.cloneNode(true)}ht.push(fo(hx,gH(hx,hv),gH(hx,hu),i,hq));for(var hw=0;hw<hx.linked.length;++hw){if(hx.linked[hw].isParent){return}}hp=gB(ht)});return new y(ht,hp)}function fA(i){return i.findMarks(Y(i.first,0),i.clipPos(Y(i.lastLine())),function(hp){return hp.parent})}function ec(hu,hv){for(var hs=0;hs<hv.length;hs++){var hq=hv[hs],hw=hq.find();var hp=hu.clipPos(hw.from),ht=hu.clipPos(hw.to);if(cA(hp,ht)){var hr=fo(hu,hp,ht,hq.primary,hq.primary.type);hq.markers.push(hr);hr.parent=hq}}}function e1(hr){var hp=function(hu){var hs=hr[hu],hw=[hs.primary.doc];eG(hs.primary.doc,function(i){return hw.push(i)});for(var ht=0;ht<hs.markers.length;ht++){var hv=hs.markers[ht];if(dN(hw,hv.doc)==-1){hv.parent=null;hs.markers.splice(ht--,1)}}};for(var hq=0;hq<hr.length;hq++){hp(hq)}}var cP=0;var aA=function(hr,hq,i,hp){if(!(this instanceof aA)){return new aA(hr,hq,i,hp)}if(i==null){i=0}gp.call(this,[new fM([new g8("",null)])]);this.first=i;this.scrollTop=this.scrollLeft=0;this.cantEdit=false;this.cleanGeneration=1;this.frontier=i;var hs=Y(i,0);this.sel=fD(hs);this.history=new gU(null);this.id=++cP;this.modeOption=hq;this.lineSep=hp;this.extend=false;if(typeof hr=="string"){hr=this.splitLines(hr)}gr(this,{from:hs,to:hs,text:hr});b9(this,fD(hs),ab)};aA.prototype=cI(gp.prototype,{constructor:aA,iter:function(hq,hp,i){if(i){this.iterN(hq-this.first,hp-hq,i)}else{this.iterN(this.first,this.first+this.size,hq)}},insert:function(hq,hr){var hp=0;for(var hs=0;hs<hr.length;++hs){hp+=hr[hs].height}this.insertInner(hq-this.first,hr,hp)},remove:function(i,hp){this.removeInner(i-this.first,hp)},getValue:function(hp){var i=ba(this,this.first,this.first+this.size);if(hp===false){return i}return i.join(hp||this.lineSeparator())},setValue:c2(function(hp){var hq=Y(this.first,0),i=this.first+this.size-1;bp(this,{from:hq,to:Y(i,f5(this,i).text.length),text:this.splitLines(hp),origin:"setValue",full:true},true);b9(this,fD(hq))}),replaceRange:function(hp,hr,hq,i){hr=gH(this,hr);hq=hq?gH(this,hq):hr;a9(this,hp,hr,hq,i)},getRange:function(hr,hq,hp){var i=g6(this,gH(this,hr),gH(this,hq));if(hp===false){return i}return i.join(hp||this.lineSeparator())},getLine:function(hp){var i=this.getLineHandle(hp);return i&&i.text},getLineHandle:function(i){if(cq(this,i)){return f5(this,i)}},getLineNumber:function(i){return b2(i)},getLineHandleVisualStart:function(i){if(typeof i=="number"){i=f5(this,i)}return z(i)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(i){return gH(this,i)},getCursor:function(hq){var i=this.sel.primary(),hp;if(hq==null||hq=="head"){hp=i.head}else{if(hq=="anchor"){hp=i.anchor}else{if(hq=="end"||hq=="to"||hq===false){hp=i.to()}else{hp=i.from()}}}return hp},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:c2(function(i,hq,hp){H(this,gH(this,typeof i=="number"?Y(i,hq||0):i),null,hp)}),setSelection:c2(function(hp,hq,i){H(this,gH(this,hp),gH(this,hq||hp),i)}),extendSelection:c2(function(hq,i,hp){gZ(this,gH(this,hq),i&&gH(this,i),hp)}),extendSelections:c2(function(hp,i){aC(this,ey(this,hp),i)}),extendSelectionsBy:c2(function(hq,i){var hp=b8(this.sel.ranges,hq);aC(this,ey(this,hp),i)}),setSelections:c2(function(hp,ht,hr){var hu=this;if(!hp.length){return}var hq=[];for(var hs=0;hs<hp.length;hs++){hq[hs]=new ev(gH(hu,hp[hs].anchor),gH(hu,hp[hs].head))}if(ht==null){ht=Math.min(hp.length-1,this.sel.primIndex)}b9(this,cV(hq,ht),hr)}),addSelection:c2(function(hq,hr,hp){var i=this.sel.ranges.slice(0);i.push(new ev(gH(this,hq),gH(this,hr||hq)));b9(this,cV(i,i.length-1),hp)}),getSelection:function(ht){var hu=this;var hq=this.sel.ranges,hp;for(var hr=0;hr<hq.length;hr++){var hs=g6(hu,hq[hr].from(),hq[hr].to());hp=hp?hp.concat(hs):hs}if(ht===false){return hp}else{return hp.join(ht||this.lineSeparator())}},getSelections:function(ht){var hu=this;var hs=[],hp=this.sel.ranges;for(var hq=0;hq<hp.length;hq++){var hr=g6(hu,hp[hq].from(),hp[hq].to());if(ht!==false){hr=hr.join(ht||hu.lineSeparator())}hs[hq]=hr}return hs},replaceSelection:function(hr,ht,hp){var hs=[];for(var hq=0;hq<this.sel.ranges.length;hq++){hs[hq]=hr}this.replaceSelections(hs,ht,hp||"+input")},replaceSelections:c2(function(hq,hv,hx){var hu=this;var hw=[],hs=this.sel;for(var ht=0;ht<hs.ranges.length;ht++){var hy=hs.ranges[ht];hw[ht]={from:hy.from(),to:hy.to(),text:hu.splitLines(hq[ht]),origin:hx}}var hp=hv&&hv!="end"&&aj(this,hw,hv);for(var hr=hw.length-1;hr>=0;hr--){bp(hu,hw[hr])}if(hp){fY(this,hp)}else{if(this.cm){gA(this.cm)}}}),undo:c2(function(){cp(this,"undo")}),redo:c2(function(){cp(this,"redo")}),undoSelection:c2(function(){cp(this,"undo",true)}),redoSelection:c2(function(){cp(this,"redo",true)}),setExtending:function(i){this.extend=i},getExtending:function(){return this.extend},historySize:function(){var hs=this.history,hp=0,hr=0;for(var hq=0;hq<hs.done.length;hq++){if(!hs.done[hq].ranges){++hp}}for(var ht=0;ht<hs.undone.length;ht++){if(!hs.undone[ht].ranges){++hr}}return{undo:hp,redo:hr}},clearHistory:function(){this.history=new gU(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(true)},changeGeneration:function(i){if(i){this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null}return this.history.generation},isClean:function(i){return this.history.generation==(i||this.cleanGeneration)},getHistory:function(){return{done:b4(this.history.done),undone:b4(this.history.undone)}},setHistory:function(hp){var i=this.history=new gU(this.history.maxGeneration);i.done=b4(hp.done.slice(0),null,true);i.undone=b4(hp.undone.slice(0),null,true)},setGutterMarker:c2(function(i,hp,hq){return fg(this,i,"gutter",function(hr){var hs=hr.gutterMarkers||(hr.gutterMarkers={});hs[hp]=hq;if(!hq&&fH(hs)){hr.gutterMarkers=null}return true})}),clearGutter:c2(function(hq){var hr=this;var hp=this.first;this.iter(function(i){if(i.gutterMarkers&&i.gutterMarkers[hq]){fg(hr,i,"gutter",function(){i.gutterMarkers[hq]=null;if(fH(i.gutterMarkers)){i.gutterMarkers=null}return true})}++hp})}),lineInfo:function(i){var hp;if(typeof i=="number"){if(!cq(this,i)){return null}hp=i;i=f5(this,i);if(!i){return null}}else{hp=b2(i);if(hp==null){return null}}return{line:hp,handle:i,text:i.text,gutterMarkers:i.gutterMarkers,textClass:i.textClass,bgClass:i.bgClass,wrapClass:i.wrapClass,widgets:i.widgets}},addLineClass:c2(function(hq,hp,i){return fg(this,hq,hp=="gutter"?"gutter":"class",function(hr){var hs=hp=="text"?"textClass":hp=="background"?"bgClass":hp=="gutter"?"gutterClass":"wrapClass";if(!hr[hs]){hr[hs]=i}else{if(T(i).test(hr[hs])){return false}else{hr[hs]+=" "+i}}return true})}),removeLineClass:c2(function(hq,hp,i){return fg(this,hq,hp=="gutter"?"gutter":"class",function(hs){var hv=hp=="text"?"textClass":hp=="background"?"bgClass":hp=="gutter"?"gutterClass":"wrapClass";var hu=hs[hv];if(!hu){return false}else{if(i==null){hs[hv]=null}else{var ht=hu.match(T(i));if(!ht){return false}var hr=ht.index+ht[0].length;hs[hv]=hu.slice(0,ht.index)+(!ht.index||hr==hu.length?"":" ")+hu.slice(hr)||null}}return true})}),addLineWidget:c2(function(hq,hp,i){return bV(this,hq,hp,i)}),removeLineWidget:function(i){i.clear()},markText:function(hq,hp,i){return fo(this,gH(this,hq),gH(this,hp),i,i&&i.type||"range")},setBookmark:function(hq,i){var hp={replacedWith:i&&(i.nodeType==null?i.widget:i),insertLeft:i&&i.insertLeft,clearWhenEmpty:false,shared:i&&i.shared,handleMouseEvents:i&&i.handleMouseEvents};hq=gH(this,hq);return fo(this,hq,hq,hp,"bookmark")},findMarksAt:function(ht){ht=gH(this,ht);var hs=[],hq=f5(this,ht.line).markedSpans;if(hq){for(var hp=0;hp<hq.length;++hp){var hr=hq[hp];if((hr.from==null||hr.from<=ht.ch)&&(hr.to==null||hr.to>=ht.ch)){hs.push(hr.marker.parent||hr.marker)}}}return hs},findMarks:function(hs,hr,hp){hs=gH(this,hs);hr=gH(this,hr);var hq=[],i=hs.line;this.iter(hs.line,hr.line+1,function(ht){var hv=ht.markedSpans;if(hv){for(var hu=0;hu<hv.length;hu++){var hw=hv[hu];if(!(hw.to!=null&&i==hs.line&&hs.ch>=hw.to||hw.from==null&&i!=hs.line||hw.from!=null&&i==hr.line&&hw.from>=hr.ch)&&(!hp||hp(hw.marker))){hq.push(hw.marker.parent||hw.marker)}}}++i});return hq},getAllMarks:function(){var i=[];this.iter(function(hq){var hp=hq.markedSpans;if(hp){for(var hr=0;hr<hp.length;++hr){if(hp[hr].from!=null){i.push(hp[hr].marker)}}}});return i},posFromIndex:function(hr){var hp,i=this.first,hq=this.lineSeparator().length;this.iter(function(hs){var ht=hs.text.length+hq;if(ht>hr){hp=hr;return true}hr-=ht;++i});return gH(this,Y(i,hp))},indexFromPos:function(hq){hq=gH(this,hq);var i=hq.ch;if(hq.line<this.first||hq.ch<0){return 0}var hp=this.lineSeparator().length;this.iter(this.first,hq.line,function(hr){i+=hr.text.length+hp});return i},copy:function(i){var hp=new aA(ba(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep);hp.scrollTop=this.scrollTop;hp.scrollLeft=this.scrollLeft;hp.sel=this.sel;hp.extend=false;if(i){hp.history.undoDepth=this.history.undoDepth;hp.setHistory(this.getHistory())}return hp},linkedDoc:function(i){if(!i){i={}}var hr=this.first,hq=this.first+this.size;if(i.from!=null&&i.from>hr){hr=i.from}if(i.to!=null&&i.to<hq){hq=i.to}var hp=new aA(ba(this,hr,hq),i.mode||this.modeOption,hr,this.lineSep);if(i.sharedHist){hp.history=this.history}(this.linked||(this.linked=[])).push({doc:hp,sharedHist:i.sharedHist});hp.linked=[{doc:this,isParent:true,sharedHist:i.sharedHist}];ec(hp,fA(this));return hp},unlinkDoc:function(hq){var ht=this;if(hq instanceof fT){hq=hq.doc}if(this.linked){for(var hr=0;hr<this.linked.length;++hr){var hs=ht.linked[hr];if(hs.doc!=hq){continue}ht.linked.splice(hr,1);hq.unlinkDoc(ht);e1(fA(ht));break}}if(hq.history==this.history){var hp=[hq.id];eG(hq,function(i){return hp.push(i.id)},true);hq.history=new gU(null);hq.history.done=b4(this.history.done,hp);hq.history.undone=b4(this.history.undone,hp)}},iterLinkedDocs:function(i){eG(this,i)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(i){if(this.lineSep){return i.split(this.lineSep)}return gR(i)},lineSeparator:function(){return this.lineSep||"\n"}});aA.prototype.eachLine=aA.prototype.iter;var al=0;function bt(hx){var hz=this;dF(hz);if(aY(hz,hx)||bj(hz.display,hx)){return}c7(hx);if(eh){al=+new Date}var hy=cL(hz,hx,true),hq=hx.dataTransfer.files;if(!hy||hz.isReadOnly()){return}if(hq&&hq.length&&window.FileReader&&window.File){var ht=hq.length,hA=Array(ht),hr=0;var hv=function(hD,hC){if(hz.options.allowDropFileTypes&&dN(hz.options.allowDropFileTypes,hD.type)==-1){return}var hB=new FileReader;hB.onload=du(hz,function(){var i=hB.result;if(/[\x00-\x08\x0e-\x1f]{2}/.test(i)){i=""}hA[hC]=i;if(++hr==ht){hy=gH(hz.doc,hy);var hE={from:hy,to:hy,text:hz.doc.splitLines(hA.join(hz.doc.lineSeparator())),origin:"paste"};bp(hz.doc,hE);fY(hz.doc,fD(hy,dq(hE)))}});hB.readAsText(hD)};for(var hw=0;hw<ht;++hw){hv(hq[hw],hw)}}else{if(hz.state.draggingText&&hz.doc.sel.contains(hy)>-1){hz.state.draggingText(hx);setTimeout(function(){return hz.display.input.focus()},20);return}try{var hp=hx.dataTransfer.getData("Text");if(hp){var hu;if(hz.state.draggingText&&!hz.state.draggingText.copy){hu=hz.listSelections()}e2(hz.doc,fD(hy,hy));if(hu){for(var hs=0;hs<hu.length;++hs){a9(hz.doc,"",hu[hs].anchor,hu[hs].head,"drag")}}hz.replaceSelection(hp,"around","paste");hz.display.input.focus()}}catch(hx){}}}function Q(i,hq){if(eh&&(!i.state.draggingText||+new Date-al<100)){e4(hq);return}if(aY(i,hq)||bj(i.display,hq)){return}hq.dataTransfer.setData("Text",i.getSelection());hq.dataTransfer.effectAllowed="copyMove";if(hq.dataTransfer.setDragImage&&!aJ){var hp=g5("img",null,null,"position: fixed; left: 0; top: 0;");hp.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";if(eB){hp.width=hp.height=1;i.display.wrapper.appendChild(hp);hp._top=hp.offsetTop}hq.dataTransfer.setDragImage(hp,0,0);if(eB){hp.parentNode.removeChild(hp)}}}function hm(i,hp){var hr=cL(i,hp);if(!hr){return}var hq=document.createDocumentFragment();B(i,hr,hq);if(!i.display.dragCursor){i.display.dragCursor=g5("div",null,"CodeMirror-cursors CodeMirror-dragcursors");i.display.lineSpace.insertBefore(i.display.dragCursor,i.display.cursorDiv)}b7(i.display.dragCursor,hq)}function dF(i){if(i.display.dragCursor){i.display.lineSpace.removeChild(i.display.dragCursor);i.display.dragCursor=null}}function aH(hs){if(!document.body.getElementsByClassName){return}var hr=document.body.getElementsByClassName("CodeMirror");for(var hq=0;hq<hr.length;hq++){var hp=hr[hq].CodeMirror;if(hp){hs(hp)}}}var c1=false;function bs(){if(c1){return}gz();c1=true}function gz(){var i;cd(window,"resize",function(){if(i==null){i=setTimeout(function(){i=null;aH(a0)},100)}});cd(window,"blur",function(){return aH(a2)})}function a0(i){var hp=i.display;if(hp.lastWrapHeight==hp.wrapper.clientHeight&&hp.lastWrapWidth==hp.wrapper.clientWidth){return}hp.cachedCharWidth=hp.cachedTextHeight=hp.cachedPaddingH=null;hp.scrollbarsClipped=false;i.setSize()}var f7={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"};for(var go=0;go<10;go++){f7[go+48]=f7[go+96]=String(go)}for(var gT=65;gT<=90;gT++){f7[gT]=String.fromCharCode(gT)}for(var gS=1;gS<=12;gS++){f7[gS+111]=f7[gS+63235]="F"+gS}var f1={};f1.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"};f1.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"};f1.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"};f1.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]};f1["default"]=co?f1.macDefault:f1.pcDefault;function dX(hq){var hw=hq.split(/-(?!$)/);hq=hw[hw.length-1];var hv,hu,hp,ht;for(var hs=0;hs<hw.length-1;hs++){var hr=hw[hs];if(/^(cmd|meta|m)$/i.test(hr)){ht=true}else{if(/^a(lt)?$/i.test(hr)){hv=true}else{if(/^(c|ctrl|control)$/i.test(hr)){hu=true}else{if(/^s(hift)?$/i.test(hr)){hp=true}else{throw new Error("Unrecognized modifier name: "+hr)}}}}}if(hv){hq="Alt-"+hq}if(hu){hq="Ctrl-"+hq}if(ht){hq="Cmd-"+hq}if(hp){hq="Shift-"+hq}return hq}function c8(hw){var hq={};for(var hv in hw){if(hw.hasOwnProperty(hv)){var hx=hw[hv];if(/^(name|fallthrough|(de|at)tach)$/.test(hv)){continue}if(hx=="..."){delete hw[hv];continue}var hy=b8(hv.split(" "),dX);for(var hu=0;hu<hy.length;hu++){var hs=void 0,hr=void 0;if(hu==hy.length-1){hr=hy.join(" ");hs=hx}else{hr=hy.slice(0,hu+1).join(" ");hs="..."}var ht=hq[hr];if(!ht){hq[hr]=hs}else{if(ht!=hs){throw new Error("Inconsistent bindings for "+hr)}}}delete hw[hv]}}for(var hp in hq){hw[hp]=hq[hp]}return hw}function j(hs,ht,hv,hr){ht=gY(ht);var hu=ht.call?ht.call(hs,hr):ht[hs];if(hu===false){return"nothing"}if(hu==="..."){return"multi"}if(hu!=null&&hv(hu)){return"handled"}if(ht.fallthrough){if(Object.prototype.toString.call(ht.fallthrough)!="[object Array]"){return j(hs,ht.fallthrough,hv,hr)}for(var hq=0;hq<ht.fallthrough.length;hq++){var hp=j(hs,ht.fallthrough[hq],hv,hr);if(hp){return hp}}}}function fi(hp){var i=typeof hp=="string"?hp:f7[hp.keyCode];return i=="Ctrl"||i=="Alt"||i=="Shift"||i=="Mod"}function gh(hp,hr){if(eB&&hp.keyCode==34&&hp["char"]){return false}var hq=f7[hp.keyCode],i=hq;if(i==null||hp.altGraphKey){return false}if(hp.altKey&&hq!="Alt"){i="Alt-"+i}if((b5?hp.metaKey:hp.ctrlKey)&&hq!="Ctrl"){i="Ctrl-"+i}if((b5?hp.ctrlKey:hp.metaKey)&&hq!="Cmd"){i="Cmd-"+i}if(!hr&&hp.shiftKey&&hq!="Shift"){i="Shift-"+i}return i}function gY(i){return typeof i=="string"?f1[i]:i}function fK(hp,hv){var hq=hp.doc.sel.ranges,ht=[];for(var hs=0;hs<hq.length;hs++){var hr=hv(hq[hs]);while(ht.length&&cA(hr.from,gB(ht).to)<=0){var hu=ht.pop();if(cA(hu.from,hr.from)<0){hr.from=hu.from;break}}ht.push(hr)}de(hp,function(){for(var hw=ht.length-1;hw>=0;hw--){a9(hp.doc,"",ht[hw].from,ht[hw].to,"+delete")}gA(hp)})}var fl={selectAll:aq,singleSelection:function(i){return i.setSelection(i.getCursor("anchor"),i.getCursor("head"),ab)},killLine:function(i){return fK(i,function(hq){if(hq.empty()){var hp=f5(i.doc,hq.head.line).text.length;if(hq.head.ch==hp&&hq.head.line<i.lastLine()){return{from:hq.head,to:Y(hq.head.line+1,0)}}else{return{from:hq.head,to:Y(hq.head.line,hp)}}}else{return{from:hq.from(),to:hq.to()}}})},deleteLine:function(i){return fK(i,function(hp){return({from:Y(hp.from().line,0),to:gH(i.doc,Y(hp.to().line+1,0))})})},delLineLeft:function(i){return fK(i,function(hp){return({from:Y(hp.from().line,0),to:hp.from()})})},delWrappedLineLeft:function(i){return fK(i,function(hp){var hr=i.charCoords(hp.head,"div").top+5;var hq=i.coordsChar({left:0,top:hr},"div");return{from:hq,to:hp.from()}})},delWrappedLineRight:function(i){return fK(i,function(hp){var hr=i.charCoords(hp.head,"div").top+5;var hq=i.coordsChar({left:i.display.lineDiv.offsetWidth+100,top:hr},"div");return{from:hp.from(),to:hq}})},undo:function(i){return i.undo()},redo:function(i){return i.redo()},undoSelection:function(i){return i.undoSelection()},redoSelection:function(i){return i.redoSelection()},goDocStart:function(i){return i.extendSelection(Y(i.firstLine(),0))},goDocEnd:function(i){return i.extendSelection(Y(i.lastLine()))},goLineStart:function(i){return i.extendSelectionsBy(function(hp){return bG(i,hp.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(i){return i.extendSelectionsBy(function(hp){return ef(i,hp.head)},{origin:"+move",bias:1})},goLineEnd:function(i){return i.extendSelectionsBy(function(hp){return en(i,hp.head.line)},{origin:"+move",bias:-1})},goLineRight:function(i){return i.extendSelectionsBy(function(hp){var hq=i.charCoords(hp.head,"div").top+5;return i.coordsChar({left:i.display.lineDiv.offsetWidth+100,top:hq},"div")},dp)},goLineLeft:function(i){return i.extendSelectionsBy(function(hp){var hq=i.charCoords(hp.head,"div").top+5;return i.coordsChar({left:0,top:hq},"div")},dp)},goLineLeftSmart:function(i){return i.extendSelectionsBy(function(hp){var hq=i.charCoords(hp.head,"div").top+5;var hr=i.coordsChar({left:0,top:hq},"div");if(hr.ch<i.getLine(hr.line).search(/\S/)){return ef(i,hp.head)}return hr},dp)},goLineUp:function(i){return i.moveV(-1,"line")},goLineDown:function(i){return i.moveV(1,"line")},goPageUp:function(i){return i.moveV(-1,"page")},goPageDown:function(i){return i.moveV(1,"page")},goCharLeft:function(i){return i.moveH(-1,"char")},goCharRight:function(i){return i.moveH(1,"char")},goColumnLeft:function(i){return i.moveH(-1,"column")},goColumnRight:function(i){return i.moveH(1,"column")},goWordLeft:function(i){return i.moveH(-1,"word")},goGroupRight:function(i){return i.moveH(1,"group")},goGroupLeft:function(i){return i.moveH(-1,"group")},goWordRight:function(i){return i.moveH(1,"word")},delCharBefore:function(i){return i.deleteH(-1,"char")},delCharAfter:function(i){return i.deleteH(1,"char")},delWordBefore:function(i){return i.deleteH(-1,"word")},delWordAfter:function(i){return i.deleteH(1,"word")},delGroupBefore:function(i){return i.deleteH(-1,"group")},delGroupAfter:function(i){return i.deleteH(1,"group")},indentAuto:function(i){return i.indentSelection("smart")},indentMore:function(i){return i.indentSelection("add")},indentLess:function(i){return i.indentSelection("subtract")},insertTab:function(i){return i.replaceSelection("\t")},insertSoftTab:function(hp){var hr=[],hq=hp.listSelections(),hu=hp.options.tabSize;for(var ht=0;ht<hq.length;ht++){var hv=hq[ht].from();var hs=b6(hp.getLine(hv.line),hv.ch,hu);hr.push(cN(hu-hs%hu))}hp.replaceSelections(hr)},defaultTab:function(i){if(i.somethingSelected()){i.indentSelection("add")}else{i.execCommand("insertTab")}},transposeChars:function(i){return de(i,function(){var hr=i.listSelections(),hq=[];for(var hs=0;hs<hr.length;hs++){if(!hr[hs].empty()){continue}var hu=hr[hs].head,hp=f5(i.doc,hu.line).text;if(hp){if(hu.ch==hp.length){hu=new Y(hu.line,hu.ch-1)}if(hu.ch>0){hu=new Y(hu.line,hu.ch+1);i.replaceRange(hp.charAt(hu.ch-1)+hp.charAt(hu.ch-2),Y(hu.line,hu.ch-2),hu,"+transpose")}else{if(hu.line>i.doc.first){var ht=f5(i.doc,hu.line-1).text;if(ht){hu=new Y(hu.line,1);i.replaceRange(hp.charAt(0)+i.doc.lineSeparator()+ht.charAt(ht.length-1),Y(hu.line-1,ht.length-1),hu,"+transpose")}}}}hq.push(new ev(hu,hu))}i.setSelections(hq)})},newlineAndIndent:function(i){return de(i,function(){var hp=i.listSelections();for(var hq=hp.length-1;hq>=0;hq--){i.replaceRange(i.doc.lineSeparator(),hp[hq].anchor,hp[hq].head,"+input")}hp=i.listSelections();for(var hr=0;hr<hp.length;hr++){i.indentLine(hp[hr].from().line,null,true)}gA(i)})},openLine:function(i){return i.replaceSelection("\n","start")},toggleOverwrite:function(i){return i.toggleOverwrite()}};function bG(hp,hs){var hq=f5(hp.doc,hs);var ht=z(hq);if(ht!=hq){hs=b2(ht)}var i=a(ht);var hr=!i?0:i[0].level%2?dk(ht):c4(ht);return Y(hs,hr)}function en(hq,ht){var hp,hr=f5(hq.doc,ht);while(hp=fb(hr)){hr=hp.find(1,true).line;ht=null}var i=a(hr);var hs=!i?hr.text.length:i[0].level%2?c4(hr):dk(hr);return Y(ht==null?b2(hr):ht,hs)}function ef(hp,hu){var ht=bG(hp,hu.line);var hq=f5(hp.doc,ht.line);var i=a(hq);if(!i||i[0].level==0){var hs=Math.max(0,hq.text.search(/\S/));var hr=hu.line==ht.line&&hu.ch<=hs&&hu.ch;return Y(ht.line,hr?0:hs)}return ht}function gQ(hp,hs,i){if(typeof hs=="string"){hs=fl[hs];if(!hs){return false}}hp.display.input.ensurePolled();var hr=hp.display.shift,hq=false;try{if(hp.isReadOnly()){hp.state.suppressEdits=true}if(i){hp.display.shift=false}hq=hs(hp)!=ct}finally{hp.display.shift=hr;hp.state.suppressEdits=false}return hq}function eH(hq,hr,ht){for(var hs=0;hs<hq.state.keyMaps.length;hs++){var hp=j(hr,hq.state.keyMaps[hs],ht,hq);if(hp){return hp}}return(hq.options.extraKeys&&j(hr,hq.options.extraKeys,ht,hq))||j(hr,hq.options.keyMap,ht,hq)}var ej=new ho;function bm(hp,hr,ht,hs){var hq=hp.state.keySeq;if(hq){if(fi(hr)){return"handled"}ej.set(50,function(){if(hp.state.keySeq==hq){hp.state.keySeq=null;hp.display.input.reset()}});hr=hq+" "+hr}var i=eH(hp,hr,hs);if(i=="multi"){hp.state.keySeq=hr}if(i=="handled"){ai(hp,"keyHandled",hp,hr,ht)}if(i=="handled"||i=="multi"){c7(ht);p(hp)}if(hq&&!i&&/\'$/.test(hr)){c7(ht);return true}return !!i}function f9(i,hq){var hp=gh(hq,true);if(!hp){return false}if(hq.shiftKey&&!i.state.keySeq){return bm(i,"Shift-"+hp,hq,function(hr){return gQ(i,hr,true)})||bm(i,hp,hq,function(hr){if(typeof hr=="string"?/^go[A-Z]/.test(hr):hr.motion){return gQ(i,hr)}})}else{return bm(i,hp,hq,function(hr){return gQ(i,hr)})}}function eT(i,hq,hp){return bm(i,"'"+hp+"'",hq,function(hr){return gQ(i,hr,true)})}var dS=null;function r(hr){var i=this;i.curOp.focus=el();if(aY(i,hr)){return}if(eh&&l<11&&hr.keyCode==27){hr.returnValue=false}var hp=hr.keyCode;i.display.shift=hp==16||hr.shiftKey;var hq=f9(i,hr);if(eB){dS=hq?hp:null;if(!hq&&hp==88&&!dE&&(co?hr.metaKey:hr.ctrlKey)){i.replaceSelection("",null,"cut")}}if(hp==18&&!/\bCodeMirror-crosshair\b/.test(i.display.lineDiv.className)){az(i)}}function az(hp){var hq=hp.display.lineDiv;gv(hq,"CodeMirror-crosshair");function i(hr){if(hr.keyCode==18||!hr.altKey){h(hq,"CodeMirror-crosshair");eP(document,"keyup",i);eP(document,"mouseover",i)}}cd(document,"keyup",i);cd(document,"mouseover",i)}function bq(i){if(i.keyCode==16){this.doc.sel.shift=false}aY(this,i)}function q(hs){var i=this;if(bj(i.display,hs)||aY(i,hs)||hs.ctrlKey&&!hs.altKey||co&&hs.metaKey){return}var hr=hs.keyCode,hp=hs.charCode;if(eB&&hr==dS){dS=null;c7(hs);return}if((eB&&(!hs.which||hs.which<10))&&f9(i,hs)){return}var hq=String.fromCharCode(hp==null?hr:hp);if(hq=="\x08"){return}if(eT(i,hs,hq)){return}i.display.input.onKeyPress(hs)}function e9(hq){var i=this,hp=i.display;if(aY(i,hq)||hp.activeTouch&&hp.input.supportsTouch()){return}hp.input.ensurePolled();hp.shift=hq.shiftKey;if(bj(hp,hq)){if(!dt){hp.scroller.draggable=false;setTimeout(function(){return hp.scroller.draggable=true},100)}return}if(m(i,hq)){return}var hr=cL(i,hq);window.focus();switch(gM(hq)){case 1:if(i.state.selectingText){i.state.selectingText(hq)}else{if(hr){aD(i,hq,hr)}else{if(M(hq)==hp.scroller){c7(hq)}}}break;case 2:if(dt){i.state.lastMiddleDown=+new Date}if(hr){gZ(i.doc,hr)}setTimeout(function(){return hp.input.focus()},20);c7(hq);break;case 3:if(hd){hl(i,hq)}else{ap(i)}break}}var dR;var dI;function aD(hp,hu,hv){if(eh){setTimeout(cT(t,hp),0)}else{hp.curOp.focus=el()}var hq=+new Date,hs;if(dI&&dI.time>hq-400&&cA(dI.pos,hv)==0){hs="triple"}else{if(dR&&dR.time>hq-400&&cA(dR.pos,hv)==0){hs="double";dI={time:hq,pos:hv}}else{hs="single";dR={time:hq,pos:hv}}}var ht=hp.doc.sel,i=co?hu.metaKey:hu.ctrlKey,hr;if(hp.options.dragDrop&&fw&&!hp.isReadOnly()&&hs=="single"&&(hr=ht.contains(hv))>-1&&(cA((hr=ht.ranges[hr]).from(),hv)<0||hv.xRel>0)&&(cA(hr.to(),hv)>0||hv.xRel<0)){bb(hp,hu,hv,i)}else{n(hp,hu,hv,hs,i)}}function bb(hq,ht,hu,hp){var hs=hq.display,hr=+new Date;var i=du(hq,function(hv){if(dt){hs.scroller.draggable=false}hq.state.draggingText=false;eP(document,"mouseup",i);eP(hs.scroller,"drop",i);if(Math.abs(ht.clientX-hv.clientX)+Math.abs(ht.clientY-hv.clientY)<10){c7(hv);if(!hp&&+new Date-200<hr){gZ(hq.doc,hu)}if(dt||eh&&l==9){setTimeout(function(){document.body.focus();hs.input.focus()},20)}else{hs.input.focus()}}});if(dt){hs.scroller.draggable=true}hq.state.draggingText=i;i.copy=co?ht.altKey:ht.ctrlKey;if(hs.scroller.dragDrop){hs.scroller.dragDrop()}cd(document,"mouseup",i);cd(hs.scroller,"drop",i)}function n(hs,hG,hr,hp,hu){var hD=hs.display,hI=hs.doc;c7(hG);var hq,hH,ht=hI.sel,i=ht.ranges;if(hu&&!hG.shiftKey){hH=hI.sel.contains(hr);if(hH>-1){hq=i[hH]}else{hq=new ev(hr,hr)}}else{hq=hI.sel.primary();hH=hI.sel.primIndex}if(gF?hG.shiftKey&&hG.metaKey:hG.altKey){hp="rect";if(!hu){hq=new ev(hr,hr)}hr=cL(hs,hG,true,true);hH=-1}else{if(hp=="double"){var hE=hs.findWordAt(hr);if(hs.display.shift||hI.extend){hq=gl(hI,hq,hE.anchor,hE.head)}else{hq=hE}}else{if(hp=="triple"){var hx=new ev(Y(hr.line,0),gH(hI,Y(hr.line+1,0)));if(hs.display.shift||hI.extend){hq=gl(hI,hq,hx.anchor,hx.head)}else{hq=hx}}else{hq=gl(hI,hq,hr)}}}if(!hu){hH=0;b9(hI,new g4([hq],0),N);ht=hI.sel}else{if(hH==-1){hH=i.length;b9(hI,cV(i.concat([hq]),hH),{scroll:false,origin:"*mouse"})}else{if(i.length>1&&i[hH].empty()&&hp=="single"&&!hG.shiftKey){b9(hI,cV(i.slice(0,hH).concat(i.slice(hH+1)),0),{scroll:false,origin:"*mouse"});ht=hI.sel}else{e(hI,hH,hq,N)}}}var hC=hr;function hB(hT){if(cA(hC,hT)==0){return}hC=hT;if(hp=="rect"){var hL=[],hQ=hs.options.tabSize;var hK=b6(f5(hI,hr.line).text,hr.ch,hQ);var hX=b6(f5(hI,hT.line).text,hT.ch,hQ);var hM=Math.min(hK,hX),hV=Math.max(hK,hX);for(var hY=Math.min(hr.line,hT.line),hO=Math.min(hs.lastLine(),Math.max(hr.line,hT.line));hY<=hO;hY++){var hW=f5(hI,hY).text,hN=e3(hW,hM,hQ);if(hM==hV){hL.push(new ev(Y(hY,hN),Y(hY,hN)))}else{if(hW.length>hN){hL.push(new ev(Y(hY,hN),Y(hY,e3(hW,hV,hQ))))}}}if(!hL.length){hL.push(new ev(hr,hr))}b9(hI,cV(ht.ranges.slice(0,hH).concat(hL),hH),{origin:"*mouse",scroll:false});hs.scrollIntoView(hT)}else{var hR=hq;var hP=hR.anchor,hS=hT;if(hp!="single"){var hU;if(hp=="double"){hU=hs.findWordAt(hT)}else{hU=new ev(Y(hT.line,0),gH(hI,Y(hT.line+1,0)))}if(cA(hU.anchor,hP)>0){hS=hU.head;hP=ay(hR.from(),hU.anchor)}else{hS=hU.anchor;hP=bM(hR.to(),hU.head)}}var hJ=ht.ranges.slice(0);hJ[hH]=new ev(gH(hI,hP),hS);b9(hI,cV(hJ,hH),N)}}var hz=hD.wrapper.getBoundingClientRect();var hv=0;function hF(hL){var hJ=++hv;var hN=cL(hs,hL,true,hp=="rect");if(!hN){return}if(cA(hN,hC)!=0){hs.curOp.focus=el();hB(hN);var hM=cn(hD,hI);if(hN.line>=hM.to||hN.line<hM.from){setTimeout(du(hs,function(){if(hv==hJ){hF(hL)}}),150)}}else{var hK=hL.clientY<hz.top?-20:hL.clientY>hz.bottom?20:0;if(hK){setTimeout(du(hs,function(){if(hv!=hJ){return}hD.scroller.scrollTop+=hK;hF(hL)}),50)}}}function hy(hJ){hs.state.selectingText=false;hv=Infinity;c7(hJ);hD.input.focus();eP(document,"mousemove",hA);eP(document,"mouseup",hw);hI.history.lastSelOrigin=null}var hA=du(hs,function(hJ){if(!gM(hJ)){hy(hJ)}else{hF(hJ)}});var hw=du(hs,hy);hs.state.selectingText=hw;cd(document,"mousemove",hA);cd(document,"mouseup",hw)}function hn(hz,hv,hx,hy){var hq,hp;try{hq=hv.clientX;hp=hv.clientY}catch(hv){return false}if(hq>=Math.floor(hz.display.gutters.getBoundingClientRect().right)){return false}if(hy){c7(hv)}var hw=hz.display;var hu=hw.lineDiv.getBoundingClientRect();if(hp>hu.bottom||!gb(hz,hx)){return b0(hv)}hp-=hu.top-hw.viewOffset;for(var hs=0;hs<hz.options.gutters.length;++hs){var ht=hw.gutters.childNodes[hs];if(ht&&ht.getBoundingClientRect().right>=hq){var hA=bW(hz.doc,hp);var hr=hz.options.gutters[hs];aL(hz,hx,hz,hA,hr,hv);return b0(hv)}}}function m(i,hp){return hn(i,hp,"gutterClick",true)}function hl(i,hp){if(bj(i.display,hp)||dL(i,hp)){return}if(aY(i,hp,"contextmenu")){return}i.display.input.onContextMenu(hp)}function dL(i,hp){if(!gb(i,"gutterContextMenu")){return false}return hn(i,hp,"gutterContextMenu",false)}function df(i){i.display.wrapper.className=i.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+i.options.theme.replace(/(^|\s)\s*/g," cm-s-");ao(i)}var cw={toString:function(){return"CodeMirror.Init"}};var fQ={};var bo={};function fq(i){var hq=i.optionHandlers;function hp(hr,hu,ht,hs){i.defaults[hr]=hu;if(ht){hq[hr]=hs?function(hv,hx,hw){if(hw!=cw){ht(hv,hx,hw)}}:ht}}i.defineOption=hp;i.Init=cw;hp("value","",function(hr,hs){return hr.setValue(hs)},true);hp("mode",null,function(hr,hs){hr.doc.modeOption=hs;bE(hr)},true);hp("indentUnit",2,bE,true);hp("indentWithTabs",false);hp("smartIndent",true);hp("tabSize",4,function(hr){eY(hr);ao(hr);am(hr)},true);hp("lineSeparator",null,function(hr,hu){hr.doc.lineSep=hu;if(!hu){return}var ht=[],hv=hr.doc.first;hr.doc.iter(function(hw){for(var hy=0;;){var hx=hw.text.indexOf(hu,hy);if(hx==-1){break}hy=hx+hu.length;ht.push(Y(hv,hx))}hv++});for(var hs=ht.length-1;hs>=0;hs--){a9(hr.doc,hu,ht[hs],Y(ht[hs].line,ht[hs].ch+hu.length))}});hp("specialChars",/[\u0000-\u001f\u007f\u00ad\u061c\u200b-\u200f\u2028\u2029\ufeff]/g,function(hr,ht,hs){hr.state.specialChars=new RegExp(ht.source+(ht.test("\t")?"":"|\t"),"g");if(hs!=cw){hr.refresh()}});hp("specialCharPlaceholder",f4,function(hr){return hr.refresh()},true);hp("electricChars",true);hp("inputStyle",eR?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},true);hp("spellcheck",false,function(hr,hs){return hr.getInputField().spellcheck=hs},true);hp("rtlMoveVisually",!aW);hp("wholeLineUpdateBefore",true);hp("theme","default",function(hr){df(hr);d2(hr)},true);hp("keyMap","default",function(hr,hv,hs){var ht=gY(hv);var hu=hs!=cw&&gY(hs);if(hu&&hu.detach){hu.detach(hr,ht)}if(ht.attach){ht.attach(hr,hu||null)}});hp("extraKeys",null);hp("lineWrapping",false,fp,true);hp("gutters",[],function(hr){cz(hr.options);d2(hr)},true);hp("fixedGutter",true,function(hr,hs){hr.display.gutters.style.left=hs?ew(hr.display)+"px":"0";hr.refresh()},true);hp("coverGutterNextToScrollbar",false,function(hr){return fL(hr)},true);hp("scrollbarStyle","native",function(hr){aK(hr);fL(hr);hr.display.scrollbars.setScrollTop(hr.doc.scrollTop);hr.display.scrollbars.setScrollLeft(hr.doc.scrollLeft)},true);hp("lineNumbers",false,function(hr){cz(hr.options);d2(hr)},true);hp("firstLineNumber",1,d2,true);hp("lineNumberFormatter",function(hr){return hr},d2,true);hp("showCursorWhenSelecting",false,bR,true);hp("resetSelectionOnContextMenu",true);hp("lineWiseCopyCut",true);hp("readOnly",false,function(hr,hs){if(hs=="nocursor"){a2(hr);hr.display.input.blur();hr.display.disabled=true}else{hr.display.disabled=false}hr.display.input.readOnlyChanged(hs)});hp("disableInput",false,function(hr,hs){if(!hs){hr.display.input.reset()}},true);hp("dragDrop",true,g2);hp("allowDropFileTypes",null);hp("cursorBlinkRate",530);hp("cursorScrollMargin",0);hp("cursorHeight",1,bR,true);hp("singleCursorHeightPerLine",true,bR,true);hp("workTime",100);hp("workDelay",100);hp("flattenSpans",true,eY,true);hp("addModeClass",false,eY,true);hp("pollInterval",100);hp("undoDepth",200,function(hr,hs){return hr.doc.history.undoDepth=hs});hp("historyEventDelay",1250);hp("viewportMargin",10,function(hr){return hr.refresh()},true);hp("maxHighlightLength",10000,eY,true);hp("moveInputWithCursor",true,function(hr,hs){if(!hs){hr.display.input.resetPosition()}});hp("tabindex",null,function(hr,hs){return hr.display.input.getField().tabIndex=hs||""});hp("autofocus",null)}function d2(i){eM(i);am(i);fn(i)}function g2(hp,hs,hq){var ht=hq&&hq!=cw;if(!hs!=!ht){var hr=hp.display.dragFunctions;var i=hs?cd:eP;i(hp.display.scroller,"dragstart",hr.start);i(hp.display.scroller,"dragenter",hr.enter);i(hp.display.scroller,"dragover",hr.over);i(hp.display.scroller,"dragleave",hr.leave);i(hp.display.scroller,"drop",hr.drop)}}function fp(i){if(i.options.lineWrapping){gv(i.display.wrapper,"CodeMirror-wrap");i.display.sizer.style.minWidth="";i.display.sizerWidth=null}else{h(i.display.wrapper,"CodeMirror-wrap");f(i)}aa(i);am(i);ao(i);setTimeout(function(){return fL(i)},100)}function fT(hp,hr){var hw=this;if(!(this instanceof fT)){return new fT(hp,hr)}this.options=hr=hr?aU(hr):{};aU(fQ,hr,false);cz(hr);var hv=hr.value;if(typeof hv=="string"){hv=new aA(hv,hr.mode,null,hr.lineSeparator)}this.doc=hv;var hq=new fT.inputStyles[hr.inputStyle](this);var hu=this.display=new fs(hp,hv,hq);hu.wrapper.CodeMirror=this;eM(this);df(this);if(hr.lineWrapping){this.display.wrapper.className+=" CodeMirror-wrap"}aK(this);this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:false,delayingBlurEvent:false,focused:false,suppressEdits:false,pasteIncoming:false,cutIncoming:false,selectingText:false,draggingText:false,highlight:new ho(),keySeq:null,specialChars:null};if(hr.autofocus&&!eR){hu.input.focus()}if(eh&&l<11){setTimeout(function(){return hw.display.input.reset(true)},20)}gP(this);bs();da(this);this.curOp.forceUpdate=true;eL(this,hv);if((hr.autofocus&&!eR)||this.hasFocus()){setTimeout(cT(c0,this),20)}else{a2(this)}for(var ht in bo){if(bo.hasOwnProperty(ht)){bo[ht](hw,hr[ht],cw)}}eE(this);if(hr.finishInit){hr.finishInit(this)}for(var hs=0;hs<bg.length;++hs){bg[hs](hw)}at(this);if(dt&&hr.lineWrapping&&getComputedStyle(hu.lineDiv).textRendering=="optimizelegibility"){hu.lineDiv.style.textRendering="auto"}}fT.defaults=fQ;fT.optionHandlers=bo;function gP(hp){var ht=hp.display;cd(ht.scroller,"mousedown",du(hp,e9));if(eh&&l<11){cd(ht.scroller,"dblclick",du(hp,function(hx){if(aY(hp,hx)){return}var hy=cL(hp,hx);if(!hy||m(hp,hx)||bj(hp.display,hx)){return}c7(hx);var hw=hp.findWordAt(hy);gZ(hp.doc,hw.anchor,hw.head)}))}else{cd(ht.scroller,"dblclick",function(hw){return aY(hp,hw)||c7(hw)})}if(!hd){cd(ht.scroller,"contextmenu",function(hw){return hl(hp,hw)})}var hv,i={end:0};function hu(){if(ht.activeTouch){hv=setTimeout(function(){return ht.activeTouch=null},1000);i=ht.activeTouch;i.end=+new Date}}function hr(hw){if(hw.touches.length!=1){return false}var hx=hw.touches[0];return hx.radiusX<=1&&hx.radiusY<=1}function hq(hz,hw){if(hw.left==null){return true}var hy=hw.left-hz.left,hx=hw.top-hz.top;return hy*hy+hx*hx>20*20}cd(ht.scroller,"touchstart",function(hx){if(!aY(hp,hx)&&!hr(hx)){ht.input.ensurePolled();clearTimeout(hv);var hw=+new Date;ht.activeTouch={start:hw,moved:false,prev:hw-i.end<=300?i:null};if(hx.touches.length==1){ht.activeTouch.left=hx.touches[0].pageX;ht.activeTouch.top=hx.touches[0].pageY}}});cd(ht.scroller,"touchmove",function(){if(ht.activeTouch){ht.activeTouch.moved=true}});cd(ht.scroller,"touchend",function(hx){var hz=ht.activeTouch;if(hz&&!bj(ht,hx)&&hz.left!=null&&!hz.moved&&new Date-hz.start<300){var hy=hp.coordsChar(ht.activeTouch,"page"),hw;if(!hz.prev||hq(hz,hz.prev)){hw=new ev(hy,hy)}else{if(!hz.prev.prev||hq(hz,hz.prev.prev)){hw=hp.findWordAt(hy)}else{hw=new ev(Y(hy.line,0),gH(hp.doc,Y(hy.line+1,0)))}}hp.setSelection(hw.anchor,hw.head);hp.focus();c7(hx)}hu()});cd(ht.scroller,"touchcancel",hu);cd(ht.scroller,"scroll",function(){if(ht.scroller.clientHeight){P(hp,ht.scroller.scrollTop);bT(hp,ht.scroller.scrollLeft,true);aL(hp,"scroll",hp)}});cd(ht.scroller,"mousewheel",function(hw){return c(hp,hw)});cd(ht.scroller,"DOMMouseScroll",function(hw){return c(hp,hw)});cd(ht.wrapper,"scroll",function(){return ht.wrapper.scrollTop=ht.wrapper.scrollLeft=0});ht.dragFunctions={enter:function(hw){if(!aY(hp,hw)){e4(hw)}},over:function(hw){if(!aY(hp,hw)){hm(hp,hw);e4(hw)}},start:function(hw){return Q(hp,hw)},drop:du(hp,bt),leave:function(hw){if(!aY(hp,hw)){dF(hp)}}};var hs=ht.input.getField();cd(hs,"keyup",function(hw){return bq.call(hp,hw)});cd(hs,"keydown",du(hp,r));cd(hs,"keypress",du(hp,q));cd(hs,"focus",function(hw){return c0(hp,hw)});cd(hs,"blur",function(hw){return a2(hp,hw)})}var bg=[];fT.defineInitHook=function(i){return bg.push(i)};function ag(hE,ht,hD,hr){var hC=hE.doc,hq;if(hD==null){hD="add"}if(hD=="smart"){if(!hC.mode.indent){hD="prev"}else{hq=d9(hE,ht)}}var hx=hE.options.tabSize;var hF=f5(hC,ht),hw=b6(hF.text,null,hx);if(hF.stateAfter){hF.stateAfter=null}var hp=hF.text.match(/^\s*/)[0],hA;if(!hr&&!/\S/.test(hF.text)){hA=0;hD="not"}else{if(hD=="smart"){hA=hC.mode.indent(hq,hF.text.slice(hp.length),hF.text);if(hA==ct||hA>150){if(!hr){return}hD="prev"}}}if(hD=="prev"){if(ht>hC.first){hA=b6(f5(hC,ht-1).text,null,hx)}else{hA=0}}else{if(hD=="add"){hA=hw+hE.options.indentUnit}else{if(hD=="subtract"){hA=hw-hE.options.indentUnit}else{if(typeof hD=="number"){hA=hw+hD}}}}hA=Math.max(0,hA);var hB="",hz=0;if(hE.options.indentWithTabs){for(var hu=Math.floor(hA/hx);hu;--hu){hz+=hx;hB+="\t"}}if(hz<hA){hB+=cN(hA-hz)}if(hB!=hp){a9(hC,hB,Y(ht,0),Y(ht,hp.length),"+input");hF.stateAfter=null;return true}else{for(var hs=0;hs<hC.sel.ranges.length;hs++){var hv=hC.sel.ranges[hs];if(hv.head.line==ht&&hv.head.ch<hp.length){var hy=Y(ht,hp.length);e(hC,hs,new ev(hy,hy));break}}}}var bv=null;function dz(i){bv=i}function g0(hD,hu,hs,hr,hC){var hB=hD.doc;hD.display.shift=false;if(!hr){hr=hB.sel}var ht=hD.state.pasteIncoming||hC=="paste";var hw=gR(hu),hp=null;if(ht&&hr.ranges.length>1){if(bv&&bv.text.join("\n")==hu){if(hr.ranges.length%bv.text.length==0){hp=[];for(var hv=0;hv<bv.text.length;hv++){hp.push(hB.splitLines(bv.text[hv]))}}}else{if(hw.length==hr.ranges.length){hp=b8(hw,function(i){return[i]})}}}var hx;for(var hq=hr.ranges.length-1;hq>=0;hq--){var hE=hr.ranges[hq];var hA=hE.from(),hz=hE.to();if(hE.empty()){if(hs&&hs>0){hA=Y(hA.line,hA.ch-hs)}else{if(hD.state.overwrite&&!ht){hz=Y(hz.line,Math.min(f5(hB,hz.line).text.length,hz.ch+gB(hw).length))}else{if(bv&&bv.lineWise&&bv.text.join("\n")==hu){hA=hz=Y(hA.line,0)}}}}hx=hD.curOp.updateInput;var hy={from:hA,to:hz,text:hp?hp[hq%hp.length]:hw,origin:hC||(ht?"paste":hD.state.cutIncoming?"cut":"+input")};bp(hD.doc,hy);ai(hD,"inputRead",hD,hy)}if(hu&&!ht){gX(hD,hu)}gA(hD);hD.curOp.updateInput=hx;hD.curOp.typing=true;hD.state.pasteIncoming=hD.state.cutIncoming=false}function bi(hq,i){var hp=hq.clipboardData&&hq.clipboardData.getData("Text");if(hp){hq.preventDefault();if(!i.isReadOnly()&&!i.options.disableInput){de(i,function(){return g0(i,hp,0,null,"paste")})}return true}}function gX(hp,hs){if(!hp.options.electricChars||!hp.options.smartIndent){return}var ht=hp.doc.sel;for(var hr=ht.ranges.length-1;hr>=0;hr--){var hv=ht.ranges[hr];if(hv.head.ch>100||(hr&&ht.ranges[hr-1].head.line==hv.head.line)){continue}var hu=hp.getModeAt(hv.head);var hw=false;if(hu.electricChars){for(var hq=0;hq<hu.electricChars.length;hq++){if(hs.indexOf(hu.electricChars.charAt(hq))>-1){hw=ag(hp,hv.head.line,"smart");break}}}else{if(hu.electricInput){if(hu.electricInput.test(f5(hp.doc,hv.head.line).text.slice(0,hv.head.ch))){hw=ag(hp,hv.head.line,"smart")}}}if(hw){ai(hp,"electricInput",hp,hv.head.line)}}}function dM(hp){var hu=[],hr=[];for(var hs=0;hs<hp.doc.sel.ranges.length;hs++){var hq=hp.doc.sel.ranges[hs].head.line;var ht={anchor:Y(hq,0),head:Y(hq+1,0)};hr.push(ht);hu.push(hp.getRange(ht.anchor,ht.head))}return{text:hu,ranges:hr}}function gN(hp,i){hp.setAttribute("autocorrect","off");hp.setAttribute("autocapitalize","off");hp.setAttribute("spellcheck",!!i)}function a5(){var i=g5("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; outline: none");var hp=g5("div",[i],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");if(dt){i.style.width="1000px"}else{i.setAttribute("wrap","off")}if(fO){i.style.border="1px solid black"}gN(i);return hp}var em=function(i){var hp=i.optionHandlers;var hq=i.helpers={};i.prototype={constructor:i,focus:function(){window.focus();this.display.input.focus()},setOption:function(ht,hu){var hs=this.options,hr=hs[ht];if(hs[ht]==hu&&ht!="mode"){return}hs[ht]=hu;if(hp.hasOwnProperty(ht)){du(this,hp[ht])(this,hu,hr)}aL(this,"optionChange",this,ht)},getOption:function(hr){return this.options[hr]},getDoc:function(){return this.doc},addKeyMap:function(hs,hr){this.state.keyMaps[hr?"push":"unshift"](gY(hs))},removeKeyMap:function(hs){var ht=this.state.keyMaps;for(var hr=0;hr<ht.length;++hr){if(ht[hr]==hs||ht[hr].name==hs){ht.splice(hr,1);return true}}},addOverlay:dD(function(hr,hs){var ht=hr.token?hr:i.getMode(this.options,hr);if(ht.startState){throw new Error("Overlays may not be stateful.")}cr(this.state.overlays,{mode:ht,modeSpec:hr,opaque:hs&&hs.opaque,priority:(hs&&hs.priority)||0},function(hu){return hu.priority});this.state.modeGen++;am(this)}),removeOverlay:dD(function(hr){var hv=this;var ht=this.state.overlays;for(var hs=0;hs<ht.length;++hs){var hu=ht[hs].modeSpec;if(hu==hr||typeof hr=="string"&&hu.name==hr){ht.splice(hs,1);hv.state.modeGen++;am(hv);return}}}),indentLine:dD(function(ht,hr,hs){if(typeof hr!="string"&&typeof hr!="number"){if(hr==null){hr=this.options.smartIndent?"smart":"prev"}else{hr=hr?"add":"subtract"}}if(cq(this.doc,ht)){ag(this,ht,hr,hs)}}),indentSelection:dD(function(hA){var hx=this;var hr=this.doc.sel.ranges,hu=-1;for(var hw=0;hw<hr.length;hw++){var hB=hr[hw];if(!hB.empty()){var hy=hB.from(),hz=hB.to();var hs=Math.max(hu,hy.line);hu=Math.min(hx.lastLine(),hz.line-(hz.ch?0:1))+1;for(var hv=hs;hv<hu;++hv){ag(hx,hv,hA)}var ht=hx.doc.sel.ranges;if(hy.ch==0&&hr.length==ht.length&&ht[hw].from().ch>0){e(hx.doc,hw,new ev(hy,ht[hw].to()),ab)}}else{if(hB.head.line>hu){ag(hx,hB.head.line,hA,true);hu=hB.head.line;if(hw==hx.doc.sel.primIndex){gA(hx)}}}}}),getTokenAt:function(hs,hr){return cO(this,hs,hr)},getLineTokens:function(hs,hr){return cO(this,Y(hs),hr,true)},getTokenTypeAt:function(hy){hy=gH(this.doc,hy);var hu=dB(this,f5(this.doc,hy.line));var hw=0,hx=(hu.length-1)/2,ht=hy.ch;var hs;if(ht==0){hs=hu[2]}else{for(;;){var hr=(hw+hx)>>1;if((hr?hu[hr*2-1]:0)>=ht){hx=hr}else{if(hu[hr*2+1]<ht){hw=hr+1}else{hs=hu[hr*2+2];break}}}}var hv=hs?hs.indexOf("overlay "):-1;return hv<0?hs:hv==0?null:hs.slice(0,hv-1)},getModeAt:function(hs){var hr=this.doc.mode;if(!hr.innerMode){return hr}return i.innerMode(hr,this.getTokenAt(hs).state).mode},getHelper:function(hs,hr){return this.getHelpers(hs,hr)[0]},getHelpers:function(hy,hx){var hv=this;var hA=[];if(!hq.hasOwnProperty(hx)){return hA}var ht=hq[hx],hw=this.getModeAt(hy);if(typeof hw[hx]=="string"){if(ht[hw[hx]]){hA.push(ht[hw[hx]])}}else{if(hw[hx]){for(var hu=0;hu<hw[hx].length;hu++){var hs=ht[hw[hx][hu]];if(hs){hA.push(hs)}}}else{if(hw.helperType&&ht[hw.helperType]){hA.push(ht[hw.helperType])}else{if(ht[hw.name]){hA.push(ht[hw.name])}}}}for(var hr=0;hr<ht._global.length;hr++){var hz=ht._global[hr];if(hz.pred(hw,hv)&&dN(hA,hz.val)==-1){hA.push(hz.val)}}return hA},getStateAfter:function(hs,hr){var ht=this.doc;hs=dy(ht,hs==null?ht.first+ht.size-1:hs);return d9(this,hs+1,hr)},cursorCoords:function(hu,hs){var ht,hr=this.doc.sel.primary();if(hu==null){ht=hr.head}else{if(typeof hu=="object"){ht=gH(this.doc,hu)}else{ht=hu?hr.from():hr.to()}}return es(this,ht,hs||"page")},charCoords:function(hs,hr){return db(this,gH(this.doc,hs),hr||"page")},coordsChar:function(hr,hs){hr=hj(this,hr,hs||"page");return gO(this,hr.left,hr.top)},lineAtHeight:function(hr,hs){hr=hj(this,{top:hr,left:0},hs||"page").top;return bW(this.doc,hr+this.display.viewOffset)},heightAtLine:function(hs,hw,hv){var hr=false,ht;if(typeof hs=="number"){var hu=this.doc.first+this.doc.size-1;if(hs<this.doc.first){hs=this.doc.first}else{if(hs>hu){hs=hu;hr=true}}ht=f5(this.doc,hs)}else{ht=hs}return fC(this,ht,{top:0,left:0},hw||"page",hv).top+(hr?this.doc.height-b1(ht):0)},defaultTextHeight:function(){return a6(this.display)},defaultCharWidth:function(){return ea(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(hw,ht,hy,hu,hA){var hv=this.display;hw=es(this,gH(this.doc,hw));var hx=hw.bottom,hs=hw.left;ht.style.position="absolute";ht.setAttribute("cm-ignore-events","true");this.display.input.setUneditable(ht);hv.sizer.appendChild(ht);if(hu=="over"){hx=hw.top}else{if(hu=="above"||hu=="near"){var hr=Math.max(hv.wrapper.clientHeight,this.doc.height),hz=Math.max(hv.sizer.clientWidth,hv.lineSpace.clientWidth);if((hu=="above"||hw.bottom+ht.offsetHeight>hr)&&hw.top>ht.offsetHeight){hx=hw.top-ht.offsetHeight}else{if(hw.bottom+ht.offsetHeight<=hr){hx=hw.bottom}}if(hs+ht.offsetWidth>hz){hs=hz-ht.offsetWidth}}}ht.style.top=hx+"px";ht.style.left=ht.style.right="";if(hA=="right"){hs=hv.sizer.clientWidth-ht.offsetWidth;ht.style.right="0px"}else{if(hA=="left"){hs=0}else{if(hA=="middle"){hs=(hv.sizer.clientWidth-ht.offsetWidth)/2}}ht.style.left=hs+"px"}if(hy){G(this,hs,hx,hs+ht.offsetWidth,hx+ht.offsetHeight)}},triggerOnKeyDown:dD(r),triggerOnKeyPress:dD(q),triggerOnKeyUp:bq,execCommand:function(hr){if(fl.hasOwnProperty(hr)){return fl[hr].call(null,this)}},triggerElectric:dD(function(hr){gX(this,hr)}),findPosH:function(hy,hu,hv,hs){var hx=this;var hr=1;if(hu<0){hr=-1;hu=-hu}var hw=gH(this.doc,hy);for(var ht=0;ht<hu;++ht){hw=bK(hx.doc,hw,hr,hv,hs);if(hw.hitSide){break}}return hw},moveH:dD(function(hr,hs){var ht=this;this.extendSelectionsBy(function(hu){if(ht.display.shift||ht.doc.extend||hu.empty()){return bK(ht.doc,hu.head,hr,hs,ht.options.rtlMoveVisually)}else{return hr<0?hu.from():hu.to()}},dp)}),deleteH:dD(function(hr,hs){var ht=this.doc.sel,hu=this.doc;if(ht.somethingSelected()){hu.replaceSelection("",null,"+delete")}else{fK(this,function(hw){var hv=bK(hu,hw.head,hr,hs,false);return hr<0?{from:hv,to:hw.head}:{from:hw.head,to:hv}})}}),findPosV:function(hx,hu,hy,hA){var ht=this;var hr=1,hw=hA;if(hu<0){hr=-1;hu=-hu}var hz=gH(this.doc,hx);for(var hs=0;hs<hu;++hs){var hv=es(ht,hz,"div");if(hw==null){hw=hv.left}else{hv.left=hw}hz=bD(ht,hv,hr,hy);if(hz.hitSide){break}}return hz},moveV:dD(function(hr,ht){var hx=this;var hv=this.doc,hu=[];var hw=!this.display.shift&&!hv.extend&&hv.sel.somethingSelected();hv.extendSelectionsBy(function(hy){if(hw){return hr<0?hy.from():hy.to()}var hA=es(hx,hy.head,"div");if(hy.goalColumn!=null){hA.left=hy.goalColumn}hu.push(hA.left);var hz=bD(hx,hA,hr,ht);if(ht=="page"&&hy==hv.sel.primary()){dd(hx,null,db(hx,hz,"div").top-hA.top)}return hz},dp);if(hu.length){for(var hs=0;hs<hv.sel.ranges.length;hs++){hv.sel.ranges[hs].goalColumn=hu[hs]}}}),findWordAt:function(hy){var hw=this.doc,hu=f5(hw,hy.line).text;var hx=hy.ch,ht=hy.ch;if(hu){var hv=this.getHelper(hy,"wordChars");if((hy.xRel<0||ht==hu.length)&&hx){--hx}else{++ht}var hs=hu.charAt(hx);var hr=cZ(hs,hv)?function(hz){return cZ(hz,hv)}:/\s/.test(hs)?function(hz){return/\s/.test(hz)}:function(hz){return(!/\s/.test(hz)&&!cZ(hz))};while(hx>0&&hr(hu.charAt(hx-1))){--hx}while(ht<hu.length&&hr(hu.charAt(ht))){++ht}}return new ev(Y(hy.line,hx),Y(hy.line,ht))},toggleOverwrite:function(hr){if(hr!=null&&hr==this.state.overwrite){return}if(this.state.overwrite=!this.state.overwrite){gv(this.display.cursorDiv,"CodeMirror-overwrite")}else{h(this.display.cursorDiv,"CodeMirror-overwrite")}aL(this,"overwriteToggle",this,this.state.overwrite)},hasFocus:function(){return this.display.input.getField()==el()},isReadOnly:function(){return !!(this.options.readOnly||this.doc.cantEdit)},scrollTo:dD(function(hr,hs){if(hr!=null||hs!=null){gx(this)}if(hr!=null){this.curOp.scrollLeft=hr}if(hs!=null){this.curOp.scrollTop=hs}}),getScrollInfo:function(){var hr=this.display.scroller;return{left:hr.scrollLeft,top:hr.scrollTop,height:hr.scrollHeight-dl(this)-this.display.barHeight,width:hr.scrollWidth-dl(this)-this.display.barWidth,clientHeight:dn(this),clientWidth:dQ(this)}},scrollIntoView:dD(function(ht,hs){if(ht==null){ht={from:this.doc.sel.primary().head,to:null};if(hs==null){hs=this.options.cursorScrollMargin}}else{if(typeof ht=="number"){ht={from:Y(ht,0),to:null}}else{if(ht.from==null){ht={from:ht,to:null}}}}if(!ht.to){ht.to=ht.from}ht.margin=hs||0;if(ht.from.line!=null){gx(this);this.curOp.scrollToPos=ht}else{var hr=I(this,Math.min(ht.from.left,ht.to.left),Math.min(ht.from.top,ht.to.top)-ht.margin,Math.max(ht.from.right,ht.to.right),Math.max(ht.from.bottom,ht.to.bottom)+ht.margin);this.scrollTo(hr.scrollLeft,hr.scrollTop)}}),setSize:dD(function(hu,hr){var hv=this;var ht=function(hw){return typeof hw=="number"||/^\d+$/.test(String(hw))?hw+"px":hw};if(hu!=null){this.display.wrapper.style.width=ht(hu)}if(hr!=null){this.display.wrapper.style.height=ht(hr)}if(this.options.lineWrapping){aV(this)}var hs=this.display.viewFrom;this.doc.iter(hs,this.display.viewTo,function(hw){if(hw.widgets){for(var hx=0;hx<hw.widgets.length;hx++){if(hw.widgets[hx].noHScroll){S(hv,hs,"widget");break}}}++hs});this.curOp.forceUpdate=true;aL(this,"refresh",this)}),operation:function(hr){return de(this,hr)},refresh:dD(function(){var hr=this.display.cachedTextHeight;am(this);this.curOp.forceUpdate=true;ao(this);this.scrollTo(this.doc.scrollLeft,this.doc.scrollTop);dx(this);if(hr==null||Math.abs(hr-a6(this.display))>0.5){aa(this)}aL(this,"refresh",this)}),swapDoc:dD(function(hs){var hr=this.doc;hr.cm=null;eL(this,hs);ao(this);this.display.input.reset();this.scrollTo(hs.scrollLeft,hs.scrollTop);this.curOp.forceScroll=true;ai(this,"swapDoc",this,hr);return hr}),getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}};bO(i);i.registerHelper=function(hs,hr,ht){if(!hq.hasOwnProperty(hs)){hq[hs]=i[hs]={_global:[]}}hq[hs][hr]=ht};i.registerGlobalHelper=function(ht,hs,hr,hu){i.registerHelper(ht,hs,hu);hq[ht]._global.push({pred:hr,val:hu})}};function bK(hF,hs,hA,hz,hu){var hx=hs.line,hy=hs.ch,hE=hA;var hp=f5(hF,hx);function hD(){var hG=hx+hA;if(hG<hF.first||hG>=hF.first+hF.size){return false}hx=hG;return hp=f5(hF,hG)}function hC(hH){var hG=(hu?v:an)(hp,hy,hA,true);if(hG==null){if(!hH&&hD()){if(hu){hy=(hA<0?dk:c4)(hp)}else{hy=hA<0?hp.text.length:0}}else{return false}}else{hy=hG}return true}if(hz=="char"){hC()}else{if(hz=="column"){hC(true)}else{if(hz=="word"||hz=="group"){var hB=null,hv=hz=="group";var i=hF.cm&&hF.cm.getHelper(hs,"wordChars");for(var ht=true;;ht=false){if(hA<0&&!hC(!ht)){break}var hq=hp.text.charAt(hy)||"\n";var hr=cZ(hq,i)?"w":hv&&hq=="\n"?"n":!hv||/\s/.test(hq)?null:"p";if(hv&&!ht&&!hr){hr="s"}if(hB&&hB!=hr){if(hA<0){hA=1;hC()}break}if(hr){hB=hr}if(hA>0&&!hC(!ht)){break}}}}}var hw=cb(hF,Y(hx,hy),hs,hE,true);if(!cA(hs,hw)){hw.hitSide=true}return hw}function bD(hx,hs,hp,hw){var hv=hx.doc,hu=hs.left,ht;if(hw=="page"){var hr=Math.min(hx.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);var i=Math.max(hr-0.5*a6(hx.display),3);ht=(hp>0?hs.bottom:hs.top)+hp*i}else{if(hw=="line"){ht=hp>0?hs.bottom+3:hs.top-3}}var hq;for(;;){hq=gO(hx,hu,ht);if(!hq.outside){break}if(hp<0?ht<=0:ht>=hv.height){hq.hitSide=true;break}ht+=hp*5}return hq}var d0=function d0(i){this.cm=i;this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null;this.polling=new ho();this.composing=null;this.gracePeriod=false;this.readDOMTimeout=null};d0.prototype.init=function c3(hr){var ht=this;var hq=this,i=hq.cm;var hs=hq.div=hr.lineDiv;gN(hs,i.options.spellcheck);cd(hs,"paste",function(hu){if(aY(i,hu)||bi(hu,i)){return}if(l<=11){setTimeout(du(i,function(){if(!hq.pollContent()){am(i)}}),20)}});cd(hs,"compositionstart",function(hu){ht.composing={data:hu.data,done:false}});cd(hs,"compositionupdate",function(hu){if(!ht.composing){ht.composing={data:hu.data,done:false}}});cd(hs,"compositionend",function(hu){if(ht.composing){if(hu.data!=ht.composing.data){ht.readFromDOMSoon()}ht.composing.done=true}});cd(hs,"touchstart",function(){return hq.forceCompositionEnd()});cd(hs,"input",function(){if(!ht.composing){ht.readFromDOMSoon()}});function hp(hy){if(aY(i,hy)){return}if(i.somethingSelected()){dz({lineWise:false,text:i.getSelections()});if(hy.type=="cut"){i.replaceSelection("",null,"cut")}}else{if(!i.options.lineWiseCopyCut){return}else{var hv=dM(i);dz({lineWise:true,text:hv.text});if(hy.type=="cut"){i.operation(function(){i.setSelections(hv.ranges,0,ab);i.replaceSelection("",null,"cut")})}}}if(hy.clipboardData){hy.clipboardData.clearData();var hx=bv.text.join("\n");hy.clipboardData.setData("Text",hx);if(hy.clipboardData.getData("Text")==hx){hy.preventDefault();return}}var hw=a5(),hz=hw.firstChild;i.display.lineSpace.insertBefore(hw,i.display.lineSpace.firstChild);hz.value=bv.text.join("\n");var hu=document.activeElement;ei(hz);setTimeout(function(){i.display.lineSpace.removeChild(hw);hu.focus();if(hu==hs){hq.showPrimarySelection()}},50)}cd(hs,"copy",hp);cd(hs,"cut",hp)};d0.prototype.prepareSelection=function cv(){var i=gE(this.cm,false);i.focus=this.cm.state.focused;return i};d0.prototype.showSelection=function ar(hp,i){if(!hp||!this.cm.display.view.length){return}if(hp.focus||i){this.showPrimarySelection()}this.showMultipleSelections(hp)};d0.prototype.showPrimarySelection=function bJ(){var hr=window.getSelection(),hu=this.cm.doc.sel.primary();var hs=aF(this.cm,hr.anchorNode,hr.anchorOffset);var hw=aF(this.cm,hr.focusNode,hr.focusOffset);if(hs&&!hs.bad&&hw&&!hw.bad&&cA(ay(hs,hw),hu.from())==0&&cA(bM(hs,hw),hu.to())==0){return}var hq=cY(this.cm,hu.from());var hv=cY(this.cm,hu.to());if(!hq&&!hv){return}var hy=this.cm.display.view;var ht=hr.rangeCount&&hr.getRangeAt(0);if(!hq){hq={node:hy[0].measure.map[2],offset:0}}else{if(!hv){var hp=hy[hy.length-1].measure;var hz=hp.maps?hp.maps[hp.maps.length-1]:hp.map;hv={node:hz[hz.length-1],offset:hz[hz.length-2]-hz[hz.length-3]}}}var i;try{i=cK(hq.node,hq.offset,hv.offset,hv.node)}catch(hx){}if(i){if(!cM&&this.cm.state.focused){hr.collapse(hq.node,hq.offset);if(!i.collapsed){hr.removeAllRanges();hr.addRange(i)}}else{hr.removeAllRanges();hr.addRange(i)}if(ht&&hr.anchorNode==null){hr.addRange(ht)}else{if(cM){this.startGracePeriod()}}}this.rememberSelection()};d0.prototype.startGracePeriod=function ha(){var i=this;clearTimeout(this.gracePeriod);this.gracePeriod=setTimeout(function(){i.gracePeriod=false;if(i.selectionChanged()){i.cm.operation(function(){return i.cm.curOp.selectionChanged=true})}},20)};d0.prototype.showMultipleSelections=function gG(i){b7(this.cm.display.cursorDiv,i.cursors);b7(this.cm.display.selectionDiv,i.selection)};d0.prototype.rememberSelection=function ak(){var i=window.getSelection();this.lastAnchorNode=i.anchorNode;this.lastAnchorOffset=i.anchorOffset;this.lastFocusNode=i.focusNode;this.lastFocusOffset=i.focusOffset};d0.prototype.selectionInEditor=function cU(){var hp=window.getSelection();if(!hp.rangeCount){return false}var i=hp.getRangeAt(0).commonAncestorContainer;return he(this.div,i)};d0.prototype.focus=function eW(){if(this.cm.options.readOnly!="nocursor"){if(!this.selectionInEditor()){this.showSelection(this.prepareSelection(),true)}this.div.focus()}};d0.prototype.blur=function cu(){this.div.blur()};d0.prototype.getField=function eQ(){return this.div};d0.prototype.supportsTouch=function bk(){return true};d0.prototype.receivedFocus=function ca(){var i=this;if(this.selectionInEditor()){this.pollSelection()}else{de(this.cm,function(){return i.cm.curOp.selectionChanged=true})}function hp(){if(i.cm.state.focused){i.pollSelection();i.polling.set(i.cm.options.pollInterval,hp)}}this.polling.set(this.cm.options.pollInterval,hp)};d0.prototype.selectionChanged=function cx(){var i=window.getSelection();return i.anchorNode!=this.lastAnchorNode||i.anchorOffset!=this.lastAnchorOffset||i.focusNode!=this.lastFocusNode||i.focusOffset!=this.lastFocusOffset};d0.prototype.pollSelection=function dZ(){if(!this.composing&&this.readDOMTimeout==null&&!this.gracePeriod&&this.selectionChanged()){var hr=window.getSelection(),i=this.cm;this.rememberSelection();var hp=aF(i,hr.anchorNode,hr.anchorOffset);var hq=aF(i,hr.focusNode,hr.focusOffset);if(hp&&hq){de(i,function(){b9(i.doc,fD(hp,hq),ab);if(hp.bad||hq.bad){i.curOp.selectionChanged=true}})}}};d0.prototype.pollContent=function V(){if(this.readDOMTimeout!=null){clearTimeout(this.readDOMTimeout);this.readDOMTimeout=null}var hy=this.cm,hI=hy.display,hG=hy.doc.sel.primary();var hH=hG.from(),hs=hG.to();if(hH.ch==0&&hH.line>hy.firstLine()){hH=Y(hH.line-1,f5(hy.doc,hH.line-1).length)}if(hs.ch==f5(hy.doc,hs.line).text.length&&hs.line<hy.lastLine()){hs=Y(hs.line+1,0)}if(hH.line<hI.viewFrom||hs.line>hI.viewTo-1){return false}var hv,ht,hx;if(hH.line==hI.viewFrom||(hv=dV(hy,hH.line))==0){ht=b2(hI.view[0].line);hx=hI.view[0].node}else{ht=b2(hI.view[hv].line);hx=hI.view[hv-1].node.nextSibling}var hF=dV(hy,hs.line);var hA,hD;if(hF==hI.view.length-1){hA=hI.viewTo-1;hD=hI.lineDiv.lastChild}else{hA=b2(hI.view[hF+1].line)-1;hD=hI.view[hF+1].node.previousSibling}if(!hx){return false}var hJ=hy.doc.splitLines(g1(hy,hx,hD,ht,hA));var hC=g6(hy.doc,Y(ht,0),Y(hA,f5(hy.doc,hA).text.length));while(hJ.length>1&&hC.length>1){if(gB(hJ)==gB(hC)){hJ.pop();hC.pop();hA--}else{if(hJ[0]==hC[0]){hJ.shift();hC.shift();ht++}else{break}}}var hE=0,hq=0;var hz=hJ[0],hp=hC[0],i=Math.min(hz.length,hp.length);while(hE<i&&hz.charCodeAt(hE)==hp.charCodeAt(hE)){++hE}var hw=gB(hJ),hK=gB(hC);var hr=Math.min(hw.length-(hJ.length==1?hE:0),hK.length-(hC.length==1?hE:0));while(hq<hr&&hw.charCodeAt(hw.length-hq-1)==hK.charCodeAt(hK.length-hq-1)){++hq}hJ[hJ.length-1]=hw.slice(0,hw.length-hq).replace(/^\u200b+/,"");hJ[0]=hJ[0].slice(hE).replace(/\u200b+$/,"");var hu=Y(ht,hE);var hB=Y(hA,hC.length?gB(hC).length-hq:0);if(hJ.length>1||hJ[0]||cA(hu,hB)){a9(hy.doc,hJ,hu,hB,"+input");return true}};d0.prototype.ensurePolled=function gn(){this.forceCompositionEnd()};d0.prototype.reset=function gq(){this.forceCompositionEnd()};d0.prototype.forceCompositionEnd=function dY(){if(!this.composing){return}clearTimeout(this.readDOMTimeout);this.composing=null;if(!this.pollContent()){am(this.cm)}this.div.blur();this.div.focus()};d0.prototype.readFromDOMSoon=function fW(){var i=this;if(this.readDOMTimeout!=null){return}this.readDOMTimeout=setTimeout(function(){i.readDOMTimeout=null;if(i.composing){if(i.composing.done){i.composing=null}else{return}}if(i.cm.isReadOnly()||!i.pollContent()){de(i.cm,function(){return am(i.cm)})}},80)};d0.prototype.setUneditable=function bz(i){i.contentEditable="false"};d0.prototype.onKeyPress=function cW(i){i.preventDefault();if(!this.cm.isReadOnly()){du(this.cm,g0)(this.cm,String.fromCharCode(i.charCode==null?i.keyCode:i.charCode),0)}};d0.prototype.readOnlyChanged=function d3(i){this.div.contentEditable=String(i!="nocursor")};d0.prototype.onContextMenu=function aE(){};d0.prototype.resetPosition=function fz(){};d0.prototype.needsContentAttribute=true;function cY(hu,hs){var ht=f2(hu,hs.line);if(!ht||ht.hidden){return null}var hw=f5(hu.doc,hs.line);var hp=cR(ht,hw,hs.line);var hq=a(hw),hr="left";if(hq){var i=aO(hq,hs.ch);hr=i%2?"right":"left"}var hv=aR(hp.map,hs.ch,hr);hv.offset=hv.collapse=="right"?hv.end:hv.start;return hv}function e6(hp,i){if(i){hp.bad=true}return hp}function g1(hw,hu,hv,hr,hp){var hx="",hq=false,i=hw.doc.lineSeparator();function hs(hy){return function(hz){return hz.id==hy}}function ht(hB){if(hB.nodeType==1){var hy=hB.getAttribute("cm-text");if(hy!=null){if(hy==""){hx+=hB.textContent.replace(/\u200b/g,"")}else{hx+=hy}return}var hA=hB.getAttribute("cm-marker"),hE;if(hA){var hC=hw.findMarks(Y(hr,0),Y(hp+1,0),hs(+hA));if(hC.length&&(hE=hC[0].find())){hx+=g6(hw.doc,hE.from,hE.to).join(i)}return}if(hB.getAttribute("contenteditable")=="false"){return}for(var hz=0;hz<hB.childNodes.length;hz++){ht(hB.childNodes[hz])}if(/^(pre|div|p)$/i.test(hB.nodeName)){hq=true}}else{if(hB.nodeType==3){var hD=hB.nodeValue;if(!hD){return}if(hq){hx+=i;hq=false}hx+=hD}}}for(;;){ht(hu);if(hu==hv){break}hu=hu.nextSibling}return hx}function aF(hp,hs,hu){var ht;if(hs==hp.display.lineDiv){ht=hp.display.lineDiv.childNodes[hu];if(!ht){return e6(hp.clipPos(Y(hp.display.viewTo-1)),true)}hs=null;hu=0}else{for(ht=hs;;ht=ht.parentNode){if(!ht||ht==hp.display.lineDiv){return null}if(ht.parentNode&&ht.parentNode==hp.display.lineDiv){break}}}for(var hr=0;hr<hp.display.view.length;hr++){var hq=hp.display.view[hr];if(hq.node==ht){return ac(hq,hs,hu)}}}function ac(hx,ht,hv){var hq=hx.text.firstChild,hs=false;if(!ht||!he(hq,ht)){return e6(Y(b2(hx.line),0),true)}if(ht==hq){hs=true;ht=hq.childNodes[hv];hv=0;if(!ht){var hD=hx.rest?gB(hx.rest):hx.line;return e6(Y(b2(hD),hD.text.length),hs)}}var hu=ht.nodeType==3?ht:null,hB=ht;if(!hu&&ht.childNodes.length==1&&ht.firstChild.nodeType==3){hu=ht.firstChild;if(hv){hv=hu.nodeValue.length}}while(hB.parentNode!=hq){hB=hB.parentNode}var hp=hx.measure,hz=hp.maps;function hw(hF,hK,hH){for(var hJ=-1;hJ<(hz?hz.length:0);hJ++){var hL=hJ<0?hp.map:hz[hJ];for(var hI=0;hI<hL.length;hI+=3){var hG=hL[hI+2];if(hG==hF||hG==hK){var hM=b2(hJ<0?hx.line:hx.rest[hJ]);var hE=hL[hI]+hH;if(hH<0||hG!=hF){hE=hL[hI+(hH?1:0)]}return Y(hM,hE)}}}}var hC=hw(hu,hB,hv);if(hC){return e6(hC,hs)}for(var i=hB.nextSibling,hy=hu?hu.nodeValue.length-hv:0;i;i=i.nextSibling){hC=hw(i,i.firstChild,0);if(hC){return e6(Y(hC.line,hC.ch-hy),hs)}else{hy+=i.textContent.length}}for(var hA=hB.previousSibling,hr=hv;hA;hA=hA.previousSibling){hC=hw(hA,hA.firstChild,-1);if(hC){return e6(Y(hC.line,hC.ch+hr),hs)}else{hr+=hA.textContent.length}}}var Z=function Z(i){this.cm=i;this.prevInput="";this.pollingFast=false;this.polling=new ho();this.inaccurateSelection=false;this.hasSelection=false;this.composing=null};Z.prototype.init=function c3(hq){var hu=this;var hp=this,i=this.cm;var ht=this.wrapper=a5();var hr=this.textarea=ht.firstChild;hq.wrapper.insertBefore(ht,hq.wrapper.firstChild);if(fO){hr.style.width="0px"}cd(hr,"input",function(){if(eh&&l>=9&&hu.hasSelection){hu.hasSelection=null}hp.poll()});cd(hr,"paste",function(hv){if(aY(i,hv)||bi(hv,i)){return}i.state.pasteIncoming=true;hp.fastPoll()});function hs(hw){if(aY(i,hw)){return}if(i.somethingSelected()){dz({lineWise:false,text:i.getSelections()});if(hp.inaccurateSelection){hp.prevInput="";hp.inaccurateSelection=false;hr.value=bv.text.join("\n");ei(hr)}}else{if(!i.options.lineWiseCopyCut){return}else{var hv=dM(i);dz({lineWise:true,text:hv.text});if(hw.type=="cut"){i.setSelections(hv.ranges,null,ab)}else{hp.prevInput="";hr.value=hv.text.join("\n");ei(hr)}}}if(hw.type=="cut"){i.state.cutIncoming=true}}cd(hr,"cut",hs);cd(hr,"copy",hs);cd(hq.scroller,"paste",function(hv){if(bj(hq,hv)||aY(i,hv)){return}i.state.pasteIncoming=true;hp.focus()});cd(hq.lineSpace,"selectstart",function(hv){if(!bj(hq,hv)){c7(hv)}});cd(hr,"compositionstart",function(){var hv=i.getCursor("from");if(hp.composing){hp.composing.range.clear()}hp.composing={start:hv,range:i.markText(hv,i.getCursor("to"),{className:"CodeMirror-composing"})}});cd(hr,"compositionend",function(){if(hp.composing){hp.poll();hp.composing.range.clear();hp.composing=null}})};Z.prototype.prepareSelection=function cv(){var hp=this.cm,ht=hp.display,hs=hp.doc;var i=gE(hp);if(hp.options.moveInputWithCursor){var hu=es(hp,hs.sel.primary().head,"div");var hq=ht.wrapper.getBoundingClientRect(),hr=ht.lineDiv.getBoundingClientRect();i.teTop=Math.max(0,Math.min(ht.wrapper.clientHeight-10,hu.top+hr.top-hq.top));i.teLeft=Math.max(0,Math.min(ht.wrapper.clientWidth-10,hu.left+hr.left-hq.left))}return i};Z.prototype.showSelection=function ar(hq){var i=this.cm,hp=i.display;b7(hp.cursorDiv,hq.cursors);b7(hp.selectionDiv,hq.selection);if(hq.teTop!=null){this.wrapper.style.top=hq.teTop+"px";this.wrapper.style.left=hq.teLeft+"px"}};Z.prototype.reset=function gq(hr){if(this.contextMenuPending){return}var hp,hq,i=this.cm,ht=i.doc;if(i.somethingSelected()){this.prevInput="";var hu=ht.sel.primary();hp=dE&&(hu.to().line-hu.from().line>100||(hq=i.getSelection()).length>1000);var hs=hp?"-":hq||i.getSelection();this.textarea.value=hs;if(i.state.focused){ei(this.textarea)}if(eh&&l>=9){this.hasSelection=hs}}else{if(!hr){this.prevInput=this.textarea.value="";if(eh&&l>=9){this.hasSelection=null}}}this.inaccurateSelection=hp};Z.prototype.getField=function eQ(){return this.textarea};Z.prototype.supportsTouch=function bk(){return false};Z.prototype.focus=function eW(){if(this.cm.options.readOnly!="nocursor"&&(!eR||el()!=this.textarea)){try{this.textarea.focus()}catch(i){}}};Z.prototype.blur=function cu(){this.textarea.blur()};Z.prototype.resetPosition=function fz(){this.wrapper.style.top=this.wrapper.style.left=0};Z.prototype.receivedFocus=function ca(){this.slowPoll()};Z.prototype.slowPoll=function by(){var i=this;if(this.pollingFast){return}this.polling.set(this.cm.options.pollInterval,function(){i.poll();if(i.cm.state.focused){i.slowPoll()}})};Z.prototype.fastPoll=function C(){var hp=false,i=this;i.pollingFast=true;function hq(){var hr=i.poll();if(!hr&&!hp){hp=true;i.polling.set(60,hq)}else{i.pollingFast=false;i.slowPoll()}}i.polling.set(20,hq)};Z.prototype.poll=function a4(){var hv=this;var i=this.cm,hq=this.textarea,hr=this.prevInput;if(this.contextMenuPending||!i.state.focused||(bF(hq)&&!hr&&!this.composing)||i.isReadOnly()||i.options.disableInput||i.state.keySeq){return false}var ht=hq.value;if(ht==hr&&!i.somethingSelected()){return false}if(eh&&l>=9&&this.hasSelection===ht||co&&/[\uf700-\uf7ff]/.test(ht)){i.display.input.reset();return false}if(i.doc.sel==i.display.selForContextMenu){var hs=ht.charCodeAt(0);if(hs==8203&&!hr){hr="\u200b"}if(hs==8666){this.reset();return this.cm.execCommand("undo")}}var hu=0,hp=Math.min(hr.length,ht.length);while(hu<hp&&hr.charCodeAt(hu)==ht.charCodeAt(hu)){++hu}de(i,function(){g0(i,ht.slice(hu),hr.length-hu,null,hv.composing?"*compose":null);if(ht.length>1000||ht.indexOf("\n")>-1){hq.value=hv.prevInput=""}else{hv.prevInput=ht}if(hv.composing){hv.composing.range.clear();hv.composing.range=i.markText(hv.composing.start,i.getCursor("to"),{className:"CodeMirror-composing"})}});return true};Z.prototype.ensurePolled=function gn(){if(this.pollingFast&&this.poll()){this.pollingFast=false}};Z.prototype.onKeyPress=function cW(){if(eh&&l>=9){this.hasSelection=null}this.fastPoll()};Z.prototype.onContextMenu=function aE(ht){var hy=this,hz=hy.cm,hv=hz.display,hp=hy.textarea;var hx=cL(hz,ht),i=hv.scroller.scrollTop;if(!hx||eB){return}var hs=hz.options.resetSelectionOnContextMenu;if(hs&&hz.doc.sel.contains(hx)==-1){du(hz,b9)(hz.doc,fD(hx),ab)}var hu=hp.style.cssText,hC=hy.wrapper.style.cssText;hy.wrapper.style.cssText="position: absolute";var hB=hy.wrapper.getBoundingClientRect();hp.style.cssText="position: absolute; width: 30px; height: 30px;\n      top: "+(ht.clientY-hB.top-5)+"px; left: "+(ht.clientX-hB.left-5)+"px;\n      z-index: 1000; background: "+(eh?"rgba(255, 255, 255, .05)":"transparent")+";\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);";var hA;if(dt){hA=window.scrollY}hv.input.focus();if(dt){window.scrollTo(null,hA)}hv.input.reset();if(!hz.somethingSelected()){hp.value=hy.prevInput=" "}hy.contextMenuPending=true;hv.selForContextMenu=hz.doc.sel;clearTimeout(hv.detectingSelectAll);function hr(){if(hp.selectionStart!=null){var hD=hz.somethingSelected();var hE="\u200b"+(hD?hp.value:"");hp.value="\u21da";hp.value=hE;hy.prevInput=hD?"":"\u200b";hp.selectionStart=1;hp.selectionEnd=hE.length;hv.selForContextMenu=hz.doc.sel}}function hw(){hy.contextMenuPending=false;hy.wrapper.style.cssText=hC;hp.style.cssText=hu;if(eh&&l<9){hv.scrollbars.setScrollTop(hv.scroller.scrollTop=i)}if(hp.selectionStart!=null){if(!eh||(eh&&l<9)){hr()}var hD=0,hE=function(){if(hv.selForContextMenu==hz.doc.sel&&hp.selectionStart==0&&hp.selectionEnd>0&&hy.prevInput=="\u200b"){du(hz,aq)(hz)}else{if(hD++<10){hv.detectingSelectAll=setTimeout(hE,500)}else{hv.input.reset()}}};hv.detectingSelectAll=setTimeout(hE,200)}}if(eh&&l>=9){hr()}if(hd){e4(ht);var hq=function(){eP(window,"mouseup",hq);setTimeout(hw,20)};cd(window,"mouseup",hq)}else{setTimeout(hw,50)}};Z.prototype.readOnlyChanged=function d3(i){if(!i){this.reset()}};Z.prototype.setUneditable=function bz(){};Z.prototype.needsContentAttribute=false;function gC(hv,hw){hw=hw?aU(hw):{};hw.value=hv.value;if(!hw.tabindex&&hv.tabIndex){hw.tabindex=hv.tabIndex}if(!hw.placeholder&&hv.placeholder){hw.placeholder=hv.placeholder}if(hw.autofocus==null){var i=el();hw.autofocus=i==hv||hv.getAttribute("autofocus")!=null&&i==document.body}function hs(){hv.value=hu.getValue()}var ht;if(hv.form){cd(hv.form,"submit",hs);if(!hw.leaveSubmitMethodAlone){var hp=hv.form;ht=hp.submit;try{var hr=hp.submit=function(){hs();hp.submit=ht;hp.submit();hp.submit=hr}}catch(hq){}}}hw.finishInit=function(hx){hx.save=hs;hx.getTextArea=function(){return hv};hx.toTextArea=function(){hx.toTextArea=isNaN;hs();hv.parentNode.removeChild(hx.getWrapperElement());hv.style.display="";if(hv.form){eP(hv.form,"submit",hs);if(typeof hv.form.submit=="function"){hv.form.submit=ht}}}};hv.style.display="none";var hu=fT(function(hx){return hv.parentNode.insertBefore(hx,hv.nextSibling)},hw);return hu}function gI(i){i.off=eP;i.on=cd;i.wheelEventPixels=aG;i.Doc=aA;i.splitLines=gR;i.countColumn=b6;i.findColumn=e3;i.isWordChar=gy;i.Pass=ct;i.signal=aL;i.Line=g8;i.changeEnd=dq;i.scrollbarModel=bw;i.Pos=Y;i.cmpPos=cA;i.modes=dW;i.mimeModes=aZ;i.resolveMode=hf;i.getMode=gu;i.modeExtensions=dT;i.extendMode=fm;i.copyState=ck;i.startState=ch;i.innerMode=hb;i.commands=fl;i.keyMap=f1;i.keyName=gh;i.isModifierKey=fi;i.lookupKey=j;i.normalizeKeyMap=c8;i.StringStream=fG;i.SharedTextMarker=y;i.TextMarker=R;i.LineWidget=d8;i.e_preventDefault=c7;i.e_stopPropagation=dU;i.e_stop=e4;i.addClass=gv;i.contains=he;i.rmClass=h;i.keyNames=f7}fq(fT);em(fT);var d="iter insert remove copy getEditor constructor".split(" ");for(var bZ in aA.prototype){if(aA.prototype.hasOwnProperty(bZ)&&dN(d,bZ)<0){fT.prototype[bZ]=(function(i){return function(){return i.apply(this.doc,arguments)}})(aA.prototype[bZ])}}bO(aA);fT.inputStyles={textarea:Z,contenteditable:d0};fT.defineMode=function(i){if(!fT.defaults.mode&&i!="null"){fT.defaults.mode=i}e8.apply(this,arguments)};fT.defineMIME=bx;fT.defineMode("null",function(){return({token:function(i){return i.skipToEnd()}})});fT.defineMIME("text/plain","null");fT.defineExtension=function(i,hp){fT.prototype[i]=hp};fT.defineDocExtension=function(i,hp){aA.prototype[i]=hp};fT.fromTextArea=gC;gI(fT);fT.version="5.22.0";return fT})));